{"version":3,"sources":["themes/index.ts","theme.ts","sml.js","sml-fold.js","components/Icon.tsx","components/MenuBar.tsx","components/Pane.tsx","components/SplitterLayout.tsx","components/MiniWindow.tsx","qrcodegen.ts","components/QRCode.tsx","components/ShareModal.tsx","components/ContractModal.tsx","components/CodeMirrorWrapper.tsx","api.ts","components/Playground.tsx","components/Editor.tsx","components/FileListItem.tsx","components/FileListButton.tsx","components/FileListFolder.tsx","components/Files.tsx","wishes/index.ts","components/WishNotificationModal.tsx","components/Wishes.tsx","components/Landing.tsx","components/ThemeCard.tsx","components/Settings.tsx","components/Version.tsx","components/FileIntermediate.tsx","components/RootPage.tsx","registerServiceWorker.ts","index.tsx","config.tsx","storage.ts"],"names":["THEMES","THEME_YACHIYO","THEME_KYOKO","THEME_MADOKA","THEME_SAYAKA","THEME_HOMURA","THEME_MAMI","THEME_SANA","THEME_NAGISA","getTheme","name","darkTheme","window","matchMedia","matches","undefined","getColor","theme","color","tm","generateButton","fg","bg","bd","bda","textbg","renderTheme","foreground","background","navbar_fg","navbar_bg","navbar_hover","border","navbar_focus_bg","navbar_focus_fg","link","link_hover","btn_dng_fg","btn_dng_bg","btn_dng_border","alert_fg","alert_bg","alert_border","minihead_fg","minihead_bg","editor_fg","editor_bg","selection_bg","cm_comment","cm_atom","cm_number","cm_prop","cm_keyword","cm_string","cm_builtin","cm_variable","cm_variable_alt","cm_def","cm_bracket","cm_tag","cm_link","cm_error","btn_suc_fg","btn_suc_bg","btn_suc_border","btn_pri_fg","btn_pri_bg","btn_pri_border","btn_hover","CodeMirror","config","parserConfig","initialState","Interpreter","settings","getInterpreterSettings","nextTokenFromString","s","pos","nextToken","length","charAt","IncompleteError","offset","allowCommentToken","startState","remainder","parenLevel","letLevel","funLevel","token","stream","state","eatSpace","posInRem","eol","next","res","peek","i","backup","backUp","e","current","remText","cur","lookAhead","typeName","text","getDynamicValue","getDynamicType","indent","textAfter","ft","dd","getText","indentUnit","blockCommentStart","blockCommentEnd","lineComment","fold","electricInput","RegExp","extraWords","require","getLineIndent","cm","lineNo","getLine","search","countColumn","getOption","registerHelper","start","myIndent","line","lastLineInFold","end","lastLine","startsWith","from","Pos","to","Icon","this","props","icon","className","style","fontSize","size","viewBox","width","verticalAlign","stroke","strokeWidth","fill","d","display","cx","cy","r","React","defaultProps","Navbar","MenuBar","forcedDisplay","handleBrowserMouseMove","bind","wshlink","getInterfaceSettings","dt","autoSelectTheme","white","black","wishingHidden","Nav","Link","eventKey","as","collapseOnSelect","fixed","Brand","float","height","padding","lineHeight","Toggle","aria-controls","Collapse","id","addEventListener","passive","removeEventListener","evt","isFullscreen","pageY","setState","node","target","foundNavbar","nodeName","toLowerCase","parentNode","document","getElementsByTagName","classList","contains","Pane","unit","percentage","classes","primary","vertical","children","clearSelection","getSelection","sel","empty","removeAllRanges","SplitterLayout","container","splitter","secondaryPaneSize","resizing","handleResize","handleMouseMove","handleMouseUp","handleTouchMove","handleSplitterMouseDown","secondaryInitialSize","splitterRect","containerRect","getBoundingClientRect","getSecondaryPaneSize","left","top","prevProps","prevState","onSecondaryPaneSizeChange","onUpdate","onDragStart","onDragEnd","clientPosition","offsetMouse","totalSize","splitterSize","primaryPaneSize","primaryIndex","primaryMinSize","Math","max","secondaryMinSize","min","clientX","clientY","changedTouches","containerClasses","customClassName","toArray","slice","push","wrappedChildren","ref","c","role","onMouseDown","onTouchStart","splitterChildren","MiniWindow","mainInstance","updateAnchor","collapseStatus","clientWidth","footerAdd","classAdd","footer","title","header","content","Mode","modeBits","numBitsCharCount","ver","floor","NUMERIC","ALPHANUMERIC","BYTE","KANJI","ECI","QrSegment","mode","numChars","bitData","Error","data","bb","appendBits","digits","NUMERIC_REGEX","test","n","parseInt","substr","ALPHANUMERIC_REGEX","temp","ALPHANUMERIC_CHARSET","indexOf","makeNumeric","makeAlphanumeric","makeBytes","toUtf8ByteArray","assignVal","segs","version","result","seg","ccbits","numCharCountBits","Infinity","str","encodeURI","charCodeAt","Ecc","ordinal","formatBits","LOW","MEDIUM","QUARTILE","HIGH","QrCode","errorCorrectionLevel","dataCodewords","mask","modules","isFunction","MIN_VERSION","MAX_VERSION","row","drawFunctionPatterns","allCodewords","addEccAndInterleave","drawCodewords","minPenalty","applyMask","drawFormatBits","penalty","getPenaltyScore","ecl","makeSegments","encodeSegments","dataUsedBits","minVersion","maxVersion","boostEcl","lDataCapacityBits","getNumDataCodewords","usedBits","getTotalBits","newEcl","getData","b","dataCapacityBits","padByte","forEach","numAlign","getNumRawDataModules","ECC_CODEWORDS_PER_BLOCK","NUM_ERROR_CORRECTION_BLOCKS","degree","root","j","reedSolomonMultiply","divisor","map","_","factor","shift","coef","x","y","z","currentRunLength","runHistory","pop","unshift","scale","canvas","ctx","getContext","fillStyle","getModule","fillRect","setFunctionModule","drawFinderPattern","alignPatPos","getAlignmentPatternPositions","drawAlignmentPattern","drawVersion","rem","bits","getBit","a","dy","dx","dist","abs","xx","yy","isBlack","numBlocks","blockEccLen","rawCodewords","numShortBlocks","shortBlockLen","blocks","rsDiv","reedSolomonComputeDivisor","k","dat","ecc","reedSolomonComputeRemainder","concat","block","right","vert","invert","runColor","runX","padRun","PENALTY_N1","finderPenaltyAddHistory","finderPenaltyCountPatterns","PENALTY_N3","finderPenaltyTerminateAndCount","runY","PENALTY_N2","total","ceil","PENALTY_N4","step","splice","core","currentRunColor","val","len","QRCode","renderCode","qr","encodeText","hw","viewbox","parts","join","Modal","ShareModal","closeShareModal","formContract","error","enocontract","show","onHide","Header","closeButton","Title","Body","Footer","type","onClick","value","readOnly","copyShareLink","formContractCallback","closeCallback","querySelector","select","execCommand","ContractModal","createContract","href","createCallback","CodeMirrorSubset","getRange","lineCount","getValue","markText","IncrementalInterpretationHelper","outputCallback","initialCode","afterCode","markers","disabled","worker","codemirror","workerTimeout","timeout","wasTerminated","partialOutput","interpreterSettings","initialExtraCode","afterExtraCode","Worker","process","onmessage","onWorkerMessage","num","terminate","message","postMessage","getCode","marker","clear","console","log","startTimeout","clearTimeout","added","removed","trim","split","filter","parity","part","response","execute","endsWith","setTimeout","restartWorker","out","timeoutStr","clearAllMarkers","key","hasOwnProperty","CodeMirrorWrapper","editor","codeMirrorInstance","evalHelper","JSON","stringify","beforeCode","localStorage","getItem","handleChangeEvent","isFocused","focus","focused","onFocusChange","editorClassName","flex","code","defaultValue","autoComplete","options","refresh","setValue","onChange","autoIndent","lineNumbers","smartIndent","tabSize","matchBrackets","lineWrapping","inputStyle","foldGutter","minFoldSize","gutters","specialChars","specialCharPlaceholder","ch","tag","createElement","appendChild","createTextNode","elt","toString","toUpperCase","extraKeys","Enter","replaceSelection","Tab","somethingSelected","indentSelection","commands","insertSoftTab","fromTextArea","on","focusChanged","handleChangeAt","sticky","off","change","API","wish","LAST_SHARE","Date","getTime","Promise","reject","fetch","headers","method","body","then","ok","status","hash","json","codes","replace","EMULATE","OUTPUT_MARKUP_SPECIALS","Playground","reset","output","sizeAnchor","shareLink","interfaceSettings","clearCodeWindow","handleLeftResize","handleRightResize","handleCodeChange","handleSplitterUpdate","handleBrowserResize","handleOutputChange","handleShare","handleShareWrapper","modalCloseCallback","modalFormContractCallback","modalCreateContractCallback","handleBrowserKeyup","extraCSS","errorColor","successColor1","successColor2","cleanedOutput","lines","markingColor","lineItems","parseLine","showUsedTimeWhenAbove","excTime","margin","borderRadius","getHighlightForColor","modal","shareElements","resetBtn","spacer","SHARING_ENABLED","Button","onReset","inputHeadBar","fileControls","innerWidth","screen","innerHeight","isVertical","useMobile","userContributesEnergy","setItem","fullscreen","getBodyClassList","add","remove","onResize","newval","newCode","onCodeChange","newOutput","complete","forceAllow","WebserverAPI","shareCode","location","host","Database","getInstance","db","saveShare","catch","render","executionTime","items","ed","substring","replaceAll","indexList","index","ii","after","before","addClass","outputHighlight","overflow","fileInCache","Editor","shareReadMode","fileName","shareHash","savedFeedback","savedFeedbackTimer","requiredVersion","handleFileNameChange","handleRedirectToEdit","handleSave","handleFormSubmit","versionRegex","match","dfn","decodeURI","isNaN","tabId","setTabId","getFile","oldState","extractVersion","history","example","getCodeExample","loadSharedCode","params","shareName","lfic","getLastCachedFile","pfileName","getTabId","topBar","fileForm","errorBar","Alert","variant","backgroundColor","maxWidth","Form","inline","onSubmit","placeholder","preventDefault","feedback","timer","saveFile","restartFeedbackClear","setLastCachedFile","FileListItem","style4","style2","borderTop","borderRight","bottomBorder","borderBottom","whiteSpace","textAlign","fontFamily","cursor","borderLeft","textOverflow","printName","tooltip","Tooltip","space","glicon","iconName","OverlayTrigger","overlay","FileListButton","style3","btnType","FileListFolder","folderState","isOpened","style5","description","folderName","keyHint","openCloseButtonText","headerButtons","colSpan","Fade","in","unmountOnExit","FileSaver","Files","files","shares","examples","examplesStatus","folder","miniMode","refreshFiles","Container","renderShares","renderExamples","collator","Intl","Collator","numeric","sensitivity","deepCopy","sort","f1","f2","compare","displayName","renderFileList","nwidth","sharesView","SAMPLE_FILES_ENABLED","examplesView","Table","hover","prefix","filesView","currentFolder","currentFolderName","currentName","newFolder","renderFolder","renderFile","renderedFiles","newPrefix","FileType","SERVER","deleteBtn","deleteHandlerForAll","SHARE","toggleFolder","file","deleteHandlerFor","forgetBtn","linkBtn","linkHandlerFor","info","origin","LOCAL","openHandlerFor","downloadHandlerFor","getFiles","showHiddenFiles","f","getCodeExamplesList","list","parse","stopPropagation","blob","Blob","saveAs","isShare","deleteFile","DEFAULT_WISHES","WishNotificationModal","needsReload","closeWishNoticicationModal","notification","isNewWish","ise","wishName","Wishes","wishes","localWishes","externalWishes","externalWishesStatus","wishSeries","wishPart","wishPartSolved","wishPartNotification","wishNotification","notificationCloseCallback","markCurrentTaskSolved","checkWishComplete","onWishCodeChange","handleResetWish","refreshExternalWishes","getWish","wishType","loadSharedWish","WishType","saveWish","q1","q2","renderWishList","renderExternalWishes","renderWishPartCompleted","renderWishProgress","renderCurrentWish","reload","getWishStatus","headerText","nxtbtn","nxtbody","qnbtn","partsCompleted","wishSeriesId","wishId","wasSolved","setWishStatus","teststart","includes","curPart","parseDescriptionString","minHeight","initCode","userDefaultCode","getFileName","endDelim","descr","curpart","found","inner","SAMPLE_WISHES_ENABLED","renderExternalWishList","shortName","wishInfo","desc","unlocked","prerequisites","pq","isWishCompleted","externalWishList","downloaded","getWishDownloaded","downloadBtn","downloadExternalWish","externalWish","getPublicWish","refreshStoredWishes","setWishDownloaded","q","renderWishSeries","renderWish","err","getWishes","getPublicWishList","Landing","handleRedirectToWishes","sharingH","sharing","wishB","marginBottom","marginLeft","ThemeCard","themeName","borderColor","bgColor","fgInvColor","lightButton","activeLight","changeTheme","mixedButton","darkButton","activeDark","Card","paddingTop","paddingLeft","marginTop","marginRight","position","combine","paddingBottom","paddingRight","icon_bg","icon_fg","success","success_alt","Settings","inter","front","timeoutChangeHandler","timeDisplayChangeHandler","resetColorsToDefault","themeChangeHandler","renderSettings","advancedMode","saveState","advanced","checked","allowVector","changeHandler","allowSuccessorML","allowUnicode","allowUnicodeTypeVariables","showTypeVariablesAsUnicode","realEquality","strictMode","disableElaboration","disableEvaluation","renderThemes","globalLastCache","timeDisplayFlipHandler","themeCards","themeList","maxLength","CardDeck","colorChangeHandler","scope","property","propName","currentTheme","themeIsDark","FileIntermediate","pathname","RootPage","path","component","basename","exact","isLocalhost","Boolean","hostname","registerValidSW","swUrl","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","ReactDOM","getElementById","URL","get","ready","unregister","checkValidServiceWorker","registerServiceWorker","WISHING_ENABLED","WISHING_HIDDEN","DEFAULT_THEME","share","Object","prototype","call","date","toISOString","wishname","completedParts","fillObjectWithString","obj","ret","allowUnicodeInStrings","allowLongFunctionNames","allowStructuresAnywhere","allowSignaturesAnywhere","allowFunctorsAnywhere","maxTabCount","hideBeforeCodeResult","lcf","tabid","getNewTabId","newId","database","dbRequest","resolve","init","onsuccess","event","onerror","cursorReq","transaction","objectStore","openCursor","continue","allowHidden","readShares","hidden","cursorReqS","cursorS","isHidden","request","put","local","fileOrigin","delete","deleteDBObject","indexedDB","open","onupgradeneeded","createObjectStore","keyPath","instance","getReady"],"mappings":"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","file":"static/js/main.6c18e9ca.chunk.js","sourcesContent":["import { ThemeCollection } from '../theme';\n\nimport THEME_YACHIYO from './yachiyo.theme.json';\nimport THEME_KYOKO from './kyoko.theme.json';\nimport THEME_MADOKA from './madoka.theme.json';\nimport THEME_SAYAKA from './sayaka.theme.json';\nimport THEME_HOMURA from './homura.theme.json';\nimport THEME_MAMI from './mami.theme.json';\nimport THEME_SANA from './sana.theme.json';\nimport THEME_NAGISA from './nagisa.theme.json';\n\nexport let THEMES: ThemeCollection = {\n    'yachiyo':  THEME_YACHIYO,\n    'やちよ':   THEME_YACHIYO,\n    'kyoko':    THEME_KYOKO,\n    '杏子':     THEME_KYOKO,\n    'madoka':   THEME_MADOKA,\n    'まどか':   THEME_MADOKA,\n    'sayaka':   THEME_SAYAKA,\n    'さやか':   THEME_SAYAKA,\n    'homura':   THEME_HOMURA,\n    'ほむら':   THEME_HOMURA,\n    'mami':     THEME_MAMI,\n    'マミ':     THEME_MAMI,\n    'sana':     THEME_SANA,\n    'さな':     THEME_SANA,\n    'nagisa':   THEME_NAGISA,\n    'なぎさ':   THEME_NAGISA,\n};\n","// import { bootstrapUtils } from 'react-bootstrap/lib/utils';\n// import { Button } from 'react-bootstrap';\n\nimport { THEMES } from './themes';\n\nexport type Theme = {\n    'error': string;\n    'success': string;\n    'success_alt': string;\n\n    'background': string;\n    'foreground': string;\n    'border': string;\n    'navbar_hover': string;\n    'navbar_bg': string;\n    'navbar_fg': string;\n    'navbar_focus_fg': string;\n    'navbar_focus_bg': string;\n    'link': string;\n    'link_hover': string;\n    'minihead_fg': string;\n    'minihead_bg': string;\n    'editor_fg': string;\n    'editor_bg': string;\n    'selection_bg': string;\n\n    'alert_fg': string;\n    'alert_bg': string;\n    'alert_border': string;\n    'btn_pri_fg': string;\n    'btn_pri_bg': string;\n    'btn_pri_border': string;\n    'btn_dng_fg': string;\n    'btn_dng_bg': string;\n    'btn_dng_border': string;\n    'btn_suc_fg': string;\n    'btn_suc_bg': string;\n    'btn_suc_border': string;\n    'btn_hover': string;\n\n    'cm_builtin': string;\n    'cm_comment': string;\n    'cm_atom': string;\n    'cm_number': string;\n    'cm_prop': string;\n    'cm_keyword': string;\n    'cm_string': string;\n    'cm_variable': string;\n    'cm_variable_alt': string;\n    'cm_def': string;\n    'cm_bracket': string;\n    'cm_tag': string;\n    'cm_link': string;\n    'cm_error': string;\n\n    'qr_bg': string;\n    'qr_fg': string;\n\n    'icon_bg': string;\n    'icon_fg': string;\n};\nexport type ThemeCollection = { [name: string]: Theme };\n\nexport function getTheme (name: string, darkTheme: string | undefined): Theme {\n    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches\n       && darkTheme !== undefined) {\n        // detected dark mode\n        return THEMES[darkTheme];\n    }\n    return THEMES[name];\n}\n\nexport function getColor (theme: string, darkTheme: string | undefined, color: string): string {\n    let tm = getTheme(theme, darkTheme);\n\n    if (tm === undefined) {\n        return '';\n    }\n\n    return tm[color];\n}\n\nfunction generateButton (name: string, fg: string, bg: string, bd: string, bda: string,\n                         textbg: string): string {\n    // bootstrapUtils.addStyle(Button, name);\n\n    return `\n    .btn-${name} {\n        color: ${fg};\n        background-color: ${bg};\n        border-color: ${bd};\n        font-family: monospace;\n    }\n    .btn-${name}:hover,\n    .btn-${name}:focus,\n    .btn-${name}:active,\n    .btn-${name}.active {\n        color: ${fg};\n        background-color: ${bg};\n        background-color: ${bg}aa;\n        border-color: ${bda};\n    }\n    .btn-${name}.disabled,\n    .btn-${name}.disabled:hover,\n    .btn-${name}.disabled:focus,\n    .btn-${name}.disabled:active,\n    .btn-${name}.disabled.active,\n    .btn-${name}[disabled]:hover,\n    .btn-${name}[disabled]:focus,\n    .btn-${name}[disabled]:active,\n    .btn-${name}[disabled].active,\n    fieldset[disabled] .btn-${name},\n    fieldset[disabled] .btn-${name}:hover,\n    fieldset[disabled] .btn-${name}:focus,\n    fieldset[disabled] .btn-${name}:active,\n    fieldset[disabled] .btn-${name}.active {\n        color: ${bg};\n        background-color: unset;\n        border-color: ${bd};\n    }\n\n    .btn-${name} .glyphicon{\n        color: ${textbg};\n        color: ${textbg}dd;\n        text-shadow: -1px 0 ${bd}, 0 1px ${bd},\n        1px 0 ${bd}, 0 -1px ${bd};\n        text-shadow: -1px 0 ${bd}dd, 0 1px ${bd}dd,\n        1px 0 ${bd}dd, 0 -1px ${bd}dd;\n    }\n    `;\n}\n\nexport function renderTheme (theme: Theme): string {\n    if (theme === undefined) {\n        return `\n        `;\n    }\n\n    return `\n    .flexy { color: ${theme.foreground}; background-color: ${theme.background}; }\n    .window-content { color: ${theme.foreground}; background-color: ${theme.background}; }\n    .navbar {\n        color: ${theme.navbar_fg};\n        background-color: ${theme.navbar_bg};\n        border-color: ${theme.navbar_bg};\n    }\n    .nav-brand {\n        color: ${theme.navbar_fg};\n    }\n    .nav-link2:hover,\n    .nav-link2:focus,\n    .nav-brand:hover,\n    .nav-brand:focus,\n    .navbar-nav > .open > a,\n    .navbar-nav > .open > a:hover,\n    .navbar-nav > .open > a:focus,\n    .navbar-link:hover,\n    .navbar .btn-link:hover,\n    .navbar .btn-link:focus\n    {\n        color: ${theme.navbar_hover};\n        background-color: transparent;\n    }\n\n    .nav-link2:hover .glyphicon,\n    .nav-link2:focus .glyphicon,\n    .nav-brand:hover .glyphicon,\n    .nav-brand:focus .glyphicon,\n    .navbar-nav > .open > a .glyphicon,\n    .navbar-nav > .open > a:hover .glyphicon,\n    .navbar-nav > .open > a:focus .glyphicon,\n    .navbar-link:hover .glyphicon,\n    .navbar .btn-link:hover .glyphicon,\n    .navbar .btn-link:focus .glyphicon {\n        text-shadow: -1px 0 ${theme.navbar_hover}, 0 1px ${theme.navbar_hover},\n        1px 0 ${theme.navbar_hover}, 0 -1px ${theme.navbar_hover};\n    }\n\n    .navbar-toggler, hr,\n    .navbar-collapse, .navbar .navbar-form {\n        border-color: ${theme.border};\n    }\n\n    .navbar-toggler-icon {\n        background-color: ${theme.navbar_focus_bg};\n    }\n\n    .navbar-toggler-icon:hover,\n    .navbar-toggler-icon:focus {\n        background-color: ${theme.navbar_bg};\n    }\n\n    .nav-link2.active, .nav-link2.active:focus,\n    .nav-link2.active:hover {\n        color: ${theme.navbar_focus_fg};\n        background-color: ${theme.navbar_focus_bg};\n    }\n    .navbar-toggler:focus .glyphicon,\n    .navbar-toggler:hover .glyphicon,\n    .nav-link2.active .glyphicon,\n    .nav-link2.active:focus .glyphicon,\n    .nav-link2.active:hover .glyphicon {\n        color: ${theme.navbar_focus_bg};\n        text-shadow: -1px 0 ${theme.navbar_focus_fg}, 0 1px ${theme.navbar_focus_fg},\n        1px 0 ${theme.navbar_focus_fg}, 0 -1px ${theme.navbar_focus_fg};\n    }\n\n    .nav-link2 {\n        color: ${theme.navbar_fg};\n        background-color: ${theme.navbar_bg};\n    }\n    .navbar-toggler .glyphicon,\n    .nav-link2 .glyphicon {\n        color: ${theme.navbar_bg};\n        text-shadow: -1px 0 ${theme.navbar_fg}, 0 1px ${theme.navbar_fg},\n        1px 0 ${theme.navbar_fg}, 0 -1px ${theme.navbar_fg};\n    }\n\n    .navbar-toggler:focus, .navbar-toggler:hover {\n        color: ${theme.navbar_focus_fg};\n        background-color: ${theme.navbar_focus_bg};\n    }\n\n    .tooltip-inner {\n        border-color: ${theme.border};\n        color: ${theme.foreground};\n        background-color: ${theme.background};\n    }\n\n    .glyphicon {\n        color: ${theme.background};\n        text-shadow: -1px 0 ${theme.foreground}, 0 1px ${theme.foreground},\n        1px 0 ${theme.foreground}, 0 -1px ${theme.foreground};\n    }\n\n    .footer { color: ${theme.foreground}; background-color: ${theme.background}; }\n    a { color: ${theme.link}; }\n    a .glyphicon{\n        text-shadow: -1px 0 ${theme.link}, 0 1px ${theme.link},\n        1px 0 ${theme.link}, 0 -1px ${theme.link};\n    }\n\n    a:focus, a:hover { color: ${theme.link_hover}; text-decoration: none; }\n    a:focus .glyphicon, a:hover .glyphicon {\n        text-shadow: -1px 0 ${theme.link_hover}, 0 1px ${theme.link_hover},\n        1px 0 ${theme.link_hover}, 0 -1px ${theme.link_hover};\n    }\n\n    .alert-danger {\n        color: ${theme.btn_dng_fg};\n        background-color: ${theme.btn_dng_bg};\n        border-color: ${theme.btn_dng_border};\n    }\n\n    .card,\n    .alert-info {\n        color: ${theme.alert_fg};\n        background-color: ${theme.alert_bg};\n        border-color: ${theme.alert_border};\n    }\n\n    .alert-info .glyphicon {\n        color: ${theme.alert_bg};\n        text-shadow: -1px 0 ${theme.alert_fg}, 0 1px ${theme.alert_fg},\n        1px 0 ${theme.alert_fg}, 0 -1px ${theme.alert_fg};\n    }\n\n    .alert-info a .glyphicon {\n        text-shadow: -1px 0 ${theme.link}, 0 1px ${theme.link},\n        1px 0 ${theme.link}, 0 -1px ${theme.link};\n    }\n    .alert-info a:focus .glyphicon, .alert-info a:hover .glyphicon {\n        text-shadow: -1px 0 ${theme.link_hover}, 0 1px ${theme.link_hover},\n        1px 0 ${theme.link_hover}, 0 -1px ${theme.link_hover};\n    }\n\n    .window-header {\n        color: ${theme.minihead_fg};\n        background-color: ${theme.minihead_bg};\n    }\n    .mini-window { border-color: ${theme.border}; }\n\n    .CodeMirror-lines, .CodeMirror-scroll, body {\n        color: ${theme.foreground}; background-color: ${theme.background}; }\n    .splitter-layout>.layout-splitter { background-color: ${theme.background}; }\n    .CodeMirror-sizer, .CodeMirror-gutter,\n    .CodeMirror-gutters, .CodeMirror-linenumber {\n        color: ${theme.editor_fg};\n        border-color: ${theme.editor_fg};\n        background-color: ${theme.editor_bg};\n    }\n    .CodeMirror-cursor {\n        border-color: ${theme.border};\n    }\n    .CodeMirror-selected {\n        background-color: ${theme.selection_bg} !important;\n        background-color: ${theme.selection_bg}77 !important;\n    }\n    span.CodeMirror-matchingbracket {\n        color: ${theme.link_hover} !important;\n    }\n    .cm-s-default span.cm-comment { color: ${theme.cm_comment}; }\n    .cm-s-default span.cm-atom { color: ${theme.cm_atom}; }\n    .cm-s-default span.cm-number { color: ${theme.cm_number}; }\n\n    .cm-s-default span.cm-property, .cm-s-default span.cm-attribute { color: ${theme.cm_prop}; }\n    .cm-s-default span.cm-keyword { color: ${theme.cm_keyword}; font-weight: bold }\n    .cm-s-default span.cm-string { color: ${theme.cm_string}; }\n    .cm-s-default span.cm-quote { color: ${theme.cm_string}; }\n\n    .cm-s-default span.cm-builtin { color: ${theme.cm_builtin}; }\n    .cm-s-default span.cm-variable { color: ${theme.cm_variable}; }\n    .cm-s-default span.cm-variable-2 { color: ${theme.cm_variable_alt}; }\n    .cm-s-default span.cm-def { color: ${theme.cm_def}; }\n    .cm-s-default span.cm-bracket { color: ${theme.cm_bracket}; }\n    .cm-s-default span.cm-tag { color: ${theme.cm_tag}; }\n    .cm-s-default span.cm-link { color: ${theme.cm_link}; }\n    .cm-s-default span.cm-error { color: ${theme.cm_error}; }\n\n    .cm-label {\n        color: ${theme.btn_dng_fg};\n        background-color: ${theme.btn_dng_bg};\n        border-color: ${theme.btn_dng_border};\n    }\n\n    .form-control, input {\n        color: ${theme.foreground};\n        background-color: ${theme.background};\n        border-color: ${theme.border};\n    }\n    .form-control:focus {\n        border-color: ${theme.link};\n    }\n    input[type=checkbox] {\n        color: ${theme.foreground};\n        background-color: ${theme.background};\n        border-color: ${theme.border};\n    }\n    input[type=checkbox]:checked:after {\n        color: ${theme.btn_suc_fg};\n        background-color: ${theme.btn_suc_bg};\n        border-color: ${theme.btn_suc_border};\n    }\n    pre {\n        color: ${theme.foreground};\n    }\n\n    table, td, tr {\n        border-color: ${theme.border};\n    }\n\n    .table-hover>tbody>tr:hover {\n        color: ${theme.btn_suc_fg};\n        background-color: ${theme.btn_suc_bg};\n        background-color: ${theme.btn_suc_bg}99;\n    }\n\n    td:hover, tr:hover {\n        border-color: ${theme.link_hover};\n    }\n\n    .modal-content {\n        color: ${theme.foreground};\n        background-color: ${theme.background};\n        border-color: ${theme.border};\n    }\n\n    .splitter-layout.layout-changing > .layout-splitter,\n    .splitter-layout > .layout-splitter {\n        background-color: ${theme.background};\n    }\n\n    code {\n        color: ${theme.alert_fg};\n    }\n\n    .splitter-layout .layout-splitter:hover {\n        background-color: ${theme.border};\n    }\n\n    ${generateButton('def-alt', theme.foreground, theme.background,\n                     theme.border, theme.link_hover, theme.background)}\n    ${generateButton('def-inv', theme.navbar_focus_fg, theme.navbar_focus_bg,\n                     theme.border, theme.link_hover, theme.background)}\n    ${generateButton('pri-alt', theme.btn_pri_fg, theme.btn_pri_bg,\n                     theme.btn_pri_border, theme.btn_hover, theme.background)}\n    ${generateButton('suc-alt', theme.btn_suc_fg, theme.btn_suc_bg,\n                     theme.btn_suc_border, theme.btn_hover, theme.background)}\n    ${generateButton('dng-alt', theme.btn_dng_fg, theme.btn_dng_bg,\n                     theme.btn_dng_border, theme.btn_hover, theme.background)}\n\n    .selectable::selection, br::selection, strong::selection,  h2::selection, h3::selection,\n    h4::selection, a::selection, p::selection, pre::selection, .footer::selection, b::selection,\n    i::selection, input::selection, .CodeMirror-line::selection, td::selection, label::selection,\n    em::selection, .CodeMirror-line > span::selection, .CodeMirror-line > span > span::selection,\n    .modal-content::selection, .modal-body::selection, .modal-title::selection {\n        color: ${theme.foreground};\n        background-color: ${theme.selection_bg} !important;\n        background-color: ${theme.selection_bg}77 !important;\n    }\n\n    ::-webkit-scrollbar {\n        height: 10px;\n        width: 10px;\n    }\n\n    ::-webkit-scrollbar-thumb {\n        border: 1px solid ${theme.border};\n        cursor: pointer;\n        border-right: 0px;\n    }\n    `;\n}\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\nimport { getInterpreterSettings } from './storage';\nimport * as Interpreter from '@sosml/interpreter';\nimport * as CodeMirror from 'codemirror';\n\nCodeMirror.defineMode('sml', function(config, parserConfig) {\n    var initialState = Interpreter.getFirstState([], {});\n    var settings = getInterpreterSettings();\n    settings.allowCommentToken = true;\n\n    function nextTokenFromString(s) {\n        var pos = 0;\n        return Interpreter.Lexer.nextToken({\n            'next': () => {\n                if (pos < s.length) {\n                    ++pos;\n                    return s.charAt(pos - 1);\n                }\n                throw new Interpreter.Errors.IncompleteError('. . .');\n            },\n            'eos': () => {\n                return pos >= s.length;\n            },\n            'peek': offset => {\n                if (offset === undefined) {\n                    offset = 0;\n                }\n                if (pos + offset < s.length) {\n                    return s.charAt(pos + offset);\n                }\n                return undefined;\n            }\n        }, settings);\n    }\n\n    var electricRegex = '^\\\\s*(\\\\||in|end)$';\n\n    return {\n        startState: function() {\n            return {\n                remainder: '',\n                parenLevel: 0,\n                letLevel: 0,\n                funLevel: 0\n            };\n        },\n        token: function(stream, state) {\n            if (stream.eatSpace()) {\n                return 'space';\n            }\n            var token = undefined;\n            try {\n                var posInRem = 0;\n                token = Interpreter.Lexer.nextToken({\n                    'next': () => {\n                        if (posInRem < state.remainder.length) {\n                            ++posInRem;\n                            return state.remainder.charAt(posInRem - 1);\n                        }\n                        if (stream.eol()) {\n                            throw new Interpreter.Errors.IncompleteError('. . .');\n                        }\n                        return stream.next();\n                    },\n                    'eos': () => stream.eol(),\n                    'peek': offset => {\n                        if (offset === undefined) {\n                            offset = 0;\n                        }\n                        if (posInRem + offset < state.remainder.length) {\n                            return state.remainder.charAt(posInRem + offset);\n                        }\n                        offset -= state.remainder.length;\n                        var res = stream.peek();\n                        for (var i = 0; i < offset; ++i) {\n                            if (stream.peek() === null) {\n                                stream.backup(i);\n                                return undefined;\n                            }\n                            stream.next();\n                            res = stream.peek();\n                        }\n                        if (offset > 0) {\n                            stream.backUp(offset);\n                        }\n                        return res;\n                    }\n                }, settings);\n                state.remainder = '';\n            } catch (e) {\n                if (e.name === 'Input Incomplete') {\n                    state.remainder += stream.current() + '';\n\n                    var remText = '';\n                    for (var i = 1; i < 10; ++i) {\n                        // For performance reasons, we look only up to 10 lines into\n                        // the future. This means that for long comments or multi-line\n                        // strings, only the last ~10 lines will be highlighted\n                        let cur = stream.lookAhead(i);\n                        if (cur === undefined) {\n                            break;\n                        }\n                        remText += ' ' + cur;\n                    }\n                    try {\n                        token = nextTokenFromString(state.remainder + remText);\n                    } catch (e) {\n                        return 'error';\n                    }\n                } else {\n                    // Some other error\n                    return 'error';\n                }\n            }\n            if (token === undefined) {\n                return null;\n            }\n\n            switch (token.typeName()) {\n                case 'CommentToken': return 'comment';\n                case 'KeywordToken': {\n                    if (token.text === 'fun' || token.text === 'case') {\n                        state.funLevel = 1;\n                    }\n                    if (token.text === '(') {\n                        state.parenLevel++;\n                    }\n                    if (token.text === ')') {\n                        state.parenLevel--;\n                    }\n                    if (token.text === 'let' || token.text === 'local'\n                        || token.text === 'struct' || token.text === 'sig') {\n                        state.letLevel++;\n                    }\n                    if (token.text === 'end') {\n                        state.letLevel--;\n                    }\n                    if (token.text === ';') {\n                        if (state.parenLevel === 0 && state.letLevel === 0) {\n                            // top-level ;\n                            state.funLevel = 0;\n                            return null;\n                        }\n                    }\n                    return 'keyword';\n                }\n                case 'IntegerConstantToken': return 'number';\n                case 'NumericToken': return 'number';\n                case 'RealConstantToken': return 'number';\n                case 'WordConstantToken': return 'number';\n                case 'ConstantToken': return 'number';\n                case 'CharacterConstantToken': return 'quote';\n                case 'StringConstantToken': return 'quote';\n                case 'IdentifierToken': return 'variable';\n                case 'AlphanumericIdentifierToken': {\n                    if (initialState.getDynamicValue(token.text) !== undefined\n                        || initialState.getDynamicType(token.text) !== undefined) {\n                        // some default value\n                        return 'builtin';\n                    }\n                    return 'variable';\n                }\n                case 'LongIdentifierToken': return 'variable';\n                case 'TypeVariableToken': return 'atom';\n                case 'EqualityTypeVariableToken': return 'atom';\n                case 'StarToken': return 'operator';\n                case 'EqualsToken': return 'operator';\n                default: return null;\n            }\n        },\n        indent: function(state, textAfter) {\n            var ft = nextTokenFromString(textAfter);\n            var dd = 0;\n            if (ft !== undefined) {\n                if (ft.typeName() === 'KeywordToken' &&\n                    (ft.getText() === 'in' || ft.getText() === 'end')) {\n                    if (state.letLevel > 0) {\n                        dd = 1;\n                    } else {\n                        return CodeMirror.Pass;\n                    }\n                }\n                if (ft.typeName() === 'KeywordToken' && ft.getText() === '|') {\n                    if (state.funLevel > 0) {\n                        dd = -1;\n                    } else {\n                        return CodeMirror.Pass;\n                    }\n                }\n            }\n            return (state.letLevel - dd) * config.indentUnit;\n        },\n\n        // electricInput: new RegExp(electricRegex),\n        blockCommentStart: '(*',\n        blockCommentEnd: '*)',\n        lineComment: null,\n        fold: \"sml\",\n        electricInput: new RegExp(electricRegex)\n    };\n});\n\nCodeMirror.defineMIME('text/sml', {\n    name: 'sml',\n    extraWords: { }\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n// taken from codemirror/addon/fold/indent-fold.js and adapted\n\nvar CodeMirror = require('codemirror');\n\nfunction getLineIndent(cm, lineNo) {\n    var text = cm.getLine(lineNo);\n    var spaceTo = text.search(/\\S/);\n\n    if (spaceTo === -1) {\n        return -1;\n    }\n    return CodeMirror.countColumn(text, null, cm.getOption(\"tabSize\"))\n}\n\nCodeMirror.registerHelper(\"fold\", \"sml\", function(cm, start) {\n    var myIndent = getLineIndent(cm, start.line);\n    if (myIndent < 0) {\n        return;\n    }\n    var lastLineInFold = null;\n\n    // Go through lines until we find a line that definitely doesn't belong in\n    // the block we're folding, or to the end.\n    for (var i = start.line + 1, end = cm.lastLine(); i <= end; ++i) {\n        var indent = getLineIndent(cm, i);\n\n        if (indent === -1) {\n            continue;\n        }\n\n        if (indent > myIndent || (cm.getLine(i).startsWith('|') && indent === myIndent)) {\n            // Lines with a greater indent are considered part of the block.\n            lastLineInFold = i;\n        } else {\n            // If this line has non-space, non-comment content, and is\n            // indented less or equal to the start line, it is the start of\n            // another block.\n            break;\n        }\n    }\n\n    if (lastLineInFold) {\n        return {\n            from: CodeMirror.Pos(start.line, cm.getLine(start.line).length),\n            to: CodeMirror.Pos(lastLineInFold, cm.getLine(lastLineInFold).length)\n        };\n    }\n});\n","import * as React from 'react';\n\ninterface Props {\n    icon: string,\n    size: string,\n    fill: string,\n    stroke: string\n}\n\nclass Icon extends React.Component<Props, any> {\n    public static defaultProps = {\n        fill: '#000',\n        stroke: '#fff'\n    };\n\n    render() {\n        if (this.props.icon === 'sunmoon') {\n            // google icon brightness-2 (mod) + sun\n            return (\n                <span className='icon icon-moon' style={{fontSize: this.props.size}}>\n                    <svg viewBox=\"0 0 36 24\" width={this.props.size}\n                        style={{verticalAlign: 'middle'}}>\n                          <path stroke={this.props.stroke} strokeWidth=\"2\" fill={this.props.fill}\n                                d=\"M6.76 4.84\n                                   l-1.8-1.79-1.41 1.41 1.79 1.79 1.42-1.41z\n                                   M4 10.5H1v2h3v-2z\n                                   m9-9.95h-2V3.5h2V.55z\n                                   m7.45 3.91l-1.41-1.41-1.79 1.79 1.41 1.41 1.79-1.79z\n                                   m-3.21 13.7l1.79 1.8 1.41-1.41-1.8-1.79-1.4 1.4z\n                                   M20 10.5v2h3v-2h-3z\n                                   m-8-5c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6-2.69-6-6-6z\n                                   m-1 16.95h2V19.5h-2v2.95z\n                                   m-7.45-3.91l1.41 1.41 1.79-1.8-1.41-1.41-1.79 1.8z\"\n                          />\n                          <path stroke={this.props.stroke} strokeWidth=\"2\" fill={this.props.fill}\n                                d=\"M25 2\n                                  c-1.05 0 -2.05 .16 -3 .46\n                                  3.06 1.27 5.5 5.06 5.5 9.54\n                                  0 3.48 -1.94 8.27 -5.5 9.54\n                                  .95 .3 1.95 .46 3 .46\n                                  5.52 0 10 -4.48 10 -10\n                                  S30.52 2 25 2z\"\n                          />\n                    </svg>\n                </span>\n            );\n        }\n        if (this.props.icon === 'moon') {\n            // google icon brightness-2, modified\n            return (\n                <span className='icon icon-moon' style={{fontSize: this.props.size}}>\n                    <svg viewBox=\"0 0 24 24\" width={this.props.size}\n                        style={{verticalAlign: 'middle'}}>\n                        <path stroke={this.props.stroke} strokeWidth=\"1.5\"\n                        fill={this.props.fill}\n                        d=\"M9 2\n                        c-1.05 0 -2.05 .16 -3 .46\n                        3.06 1.27 5.5 5.06 5.5 9.54\n                        0 3.48 -1.94 8.27 -5.5 9.54\n                        .95 .3 1.95 .46 3 .46\n                        5.52 0 10 -4.48 10 -10\n                        S14.52 2 9 2z\"\n                        />\n                    </svg>\n                </span>\n            );\n        }\n        if (this.props.icon === 'sun') {\n            // google icon sunny\n            return (\n                <span className='icon icon-sun' style={{fontSize: this.props.size}}>\n                    <svg viewBox=\"0 0 24 24\" width={this.props.size}\n                        style={{verticalAlign: 'middle'}}>\n                        <path stroke={this.props.stroke} strokeWidth=\"1.5\"\n                        fill={this.props.fill}\n                        d=\"M6.76 4.84\n                        l-1.8-1.79-1.41 1.41 1.79 1.79 1.42-1.41z\n                        M4 10.5H1v2h3v-2z\n                        m9-9.95h-2V3.5h2V.55z\n                        m7.45 3.91l-1.41-1.41-1.79 1.79 1.41 1.41 1.79-1.79z\n                        m-3.21 13.7l1.79 1.8 1.41-1.41-1.8-1.79-1.4 1.4z\n                        M20 10.5v2h3v-2h-3z\n                        m-8-5c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6-2.69-6-6-6z\n                        m-1 16.95h2V19.5h-2v2.95z\n                        m-7.45-3.91l1.41 1.41 1.79-1.8-1.41-1.41-1.79 1.8z\"\n                        />\n                    </svg>\n                </span>\n            )\n        }\n        if (this.props.icon === 'sosml') {\n            return (\n                <span className='icon icon-sosml' style={{verticalAlign: 'middle',\n                    display: 'inline-block'}}>\n                    <svg viewBox=\"0 0 52 52\" width={this.props.size}>\n                        <circle cx={26} cy={26} r={24} stroke={this.props.stroke} strokeWidth={1}\n                            fill={this.props.fill} />\n                         <circle cx={26} cy={26} r={10} stroke={this.props.stroke} strokeWidth={1}\n                            fill={this.props.stroke} />\n                        <circle cx={17} cy={15} r={7} stroke={this.props.stroke} strokeWidth={1}\n                            fill=\"#fff\" />\n                    </svg>\n                </span>\n            );\n        }\n        return '';\n    }\n}\n\nexport default Icon;\n","import * as React from 'react';\nimport { Nav } from 'react-bootstrap';\nimport { NavLink } from 'react-router-dom';\nimport { getInterfaceSettings, wishingHidden } from '../storage';\nimport { getColor } from '../theme';\nimport './MenuBar.css';\nimport Icon from './Icon';\nconst Navbar = require('react-bootstrap').Navbar;\n\ninterface State {\n    forcedDisplay: boolean;\n}\n\nclass MenuBar extends React.Component<any, State> {\n    constructor(props: any) {\n        super(props);\n\n        this.state = {\n            forcedDisplay: false\n        };\n\n        this.handleBrowserMouseMove = this.handleBrowserMouseMove.bind(this);\n    }\n\n    render() {\n        let settings = getInterfaceSettings();\n        let dt: string | undefined = settings.autoSelectTheme ? settings.darkTheme : undefined;\n        let white = getColor(settings.theme, dt, 'icon_fg');\n        let black = getColor(settings.theme, dt, 'icon_bg');\n\n        let wshlink: any;\n        if (!wishingHidden()) {\n            wshlink = (\n                <Nav>\n                    <Nav.Link eventKey=\"2\" as=\"div\">\n                    <NavLink to=\"/wishes\" className=\"nav-link2\">\n                        <span className=\"glyphicon glyphicon-exclamation-sign\" /> Wishes\n                    </NavLink>\n                    </Nav.Link>\n                </Nav>\n            );\n        }\n\n        return (\n            <Navbar collapseOnSelect fixed=\"top\"\n                className={(this.state.forcedDisplay) ? 'forcedDisplay' : ''}>\n                <div className=\"navbar-header\">\n                    <Navbar.Brand style={{float: 'left', height: '50px', padding: '9px',\n                        fontSize: '18px', lineHeight: '20px'}}>\n                        <Nav.Link eventKey=\"0\" as=\"div\">\n                        <NavLink to=\"/\" className=\"nav-brand\">\n                            <Icon icon=\"sosml\" stroke={black} fill={white} size=\"28px\" /><span\n                            style={{verticalAlign: \"middle\"}}> SOSML\n                            </span>\n                        </NavLink>\n                        </Nav.Link>\n                    </Navbar.Brand>\n                    <Navbar.Toggle aria-controls=\"basic-navbar-nav\">\n                        <span className=\"glyphicon glyphicon-menu-hamburger\" /><b> Menu</b>\n                    </Navbar.Toggle>\n                </div>\n                <Navbar.Collapse id=\"basic-navbar-nav\">\n                    <Nav>\n                        <Nav.Link eventKey=\"1\" as=\"div\">\n                            <NavLink to=\"/editor\" className=\"nav-link2\">\n                            <span className=\"glyphicon glyphicon-pencil\" /> Editor\n                            </NavLink>\n                        </Nav.Link>\n                    </Nav>\n                    <Nav>\n                        <Nav.Link eventKey=\"2\" as=\"div\">\n                        <NavLink to=\"/files\" className=\"nav-link2\">\n                            <span className=\"glyphicon glyphicon-duplicate\" /> Files\n                        </NavLink>\n                        </Nav.Link>\n                    </Nav>\n                    {wshlink}\n                    <div className=\"navbar-right\">\n                        <Nav.Link eventKey=\"3\" as=\"div\">\n                        <NavLink to=\"/settings\" className=\"nav-link2\">\n                            <span className=\"glyphicon glyphicon-cog\" /> Settings\n                        </NavLink>\n                        </Nav.Link>\n                    </div>\n                </Navbar.Collapse>\n            </Navbar>\n        );\n    }\n\n    // Hover control\n    componentDidMount() {\n        window.addEventListener('mousemove', this.handleBrowserMouseMove, {passive: true});\n    }\n\n    componentWillUnmount() {\n        window.removeEventListener('mousemove', this.handleBrowserMouseMove);\n    }\n\n    handleBrowserMouseMove(evt: MouseEvent) {\n        if (this.isFullscreen()) {\n            if (evt.pageY < 10 && !this.state.forcedDisplay) {\n                this.setState({\n                    forcedDisplay: true\n                });\n            } else if (this.state.forcedDisplay) {\n                let node: Node = evt.target as Node;\n                let foundNavbar = false;\n                while (true) {\n                    if (node.nodeName.toLowerCase() === 'nav') {\n                        foundNavbar = true;\n                        break;\n                    }\n                    if (!node.parentNode) {\n                        break;\n                    }\n                    node = node.parentNode;\n                }\n\n                if (!foundNavbar) {\n                    this.setState({\n                        forcedDisplay: false\n                    });\n                }\n            }\n        } else if (this.state.forcedDisplay) {\n            this.setState({\n                forcedDisplay: false\n            });\n        }\n    }\n\n    private isFullscreen() {\n        let body = document.getElementsByTagName('body')[0];\n        return body.classList.contains('fullscreen');\n    }\n}\n\nexport default MenuBar;\n","/*\nCopyright (c) 2016 Yang Liu <hi@zesik.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport * as React from 'react';\n\ninterface Props {\n    vertical: boolean;\n    primary: boolean;\n    size: number;\n    percentage: boolean;\n    children: any;\n}\n\nclass Pane extends React.Component<Props, any> {\n    public static defaultProps = {\n        vertical: false,\n        primary: false,\n        size: 0,\n        percentage: false,\n        children: []\n    };\n\n    render() {\n        const size = this.props.size || 0;\n        const unit = this.props.percentage ? '%' : 'px';\n        let classes = 'layout-pane';\n        const style: any = {};\n        if (!this.props.primary) {\n            if (this.props.vertical) {\n                style.height = `${size}${unit}`;\n            } else {\n                style.width = `${size}${unit}`;\n            }\n        } else {\n            classes += ' layout-pane-primary';\n        }\n        return (\n            <div className={classes} style={style}>{this.props.children}</div>\n        );\n    }\n}\n\nexport default Pane;\n","/*\nCopyright (c) 2016 Yang Liu <hi@zesik.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nimport * as React from 'react';\n\nimport Pane from './Pane';\n\nfunction clearSelection() {\n    // I don't care about IE 9/10/11.\n    if (window.getSelection !== null) {\n        let sel = window.getSelection();\n        if (sel !== null && sel.empty) {\n            sel.empty();\n        } else if (sel !== null && sel.removeAllRanges) {\n            sel.removeAllRanges();\n        }\n    } /* else if (document.selection) {\n         document.selection.empty();\n         } */\n}\n\nconst DEFAULT_SPLITTER_SIZE = 4;\n\ninterface Props {\n    customClassName: string;\n    vertical: boolean;\n    percentage: boolean;\n    primaryIndex: number;\n    primaryMinSize: number;\n    secondaryInitialSize: number;\n    secondaryMinSize: number;\n    onUpdate: any;\n    onDragStart: any;\n    onDragEnd: any;\n    onSecondaryPaneSizeChange: any;\n    children: any[];\n    splitterChildren: any[];\n};\n\ninterface State {\n    secondaryPaneSize: number;\n    resizing: boolean;\n}\n\nclass SplitterLayout extends React.Component<Props, State> {\n    public static defaultProps = {\n        customClassName: '',\n        vertical: false,\n        percentage: false,\n        primaryIndex: 0,\n        primaryMinSize: 0,\n        secondaryInitialSize: undefined,\n        secondaryMinSize: 0,\n        onUpdate: null,\n        onDragStart: null,\n        onDragEnd: null,\n        onSecondaryPaneSizeChange: null,\n        children: [],\n        splitterChildren: []\n    };\n\n    container: any;\n    splitter: any;\n\n    constructor(props: Props) {\n        super(props);\n\n        this.state = {\n            secondaryPaneSize: 0,\n            resizing: false\n        };\n\n        this.handleResize = this.handleResize.bind(this);\n        this.handleMouseMove = this.handleMouseMove.bind(this);\n        this.handleMouseUp = this.handleMouseUp.bind(this);\n        this.handleTouchMove = this.handleTouchMove.bind(this);\n        this.handleSplitterMouseDown = this.handleSplitterMouseDown.bind(this);\n    }\n\n    componentDidMount() {\n        window.addEventListener('resize', this.handleResize);\n        document.addEventListener('mouseup', this.handleMouseUp);\n        document.addEventListener('mousemove', this.handleMouseMove);\n        document.addEventListener('touchend', this.handleMouseUp);\n        document.addEventListener('touchmove', this.handleTouchMove);\n\n        let secondaryPaneSize;\n        if (typeof this.props.secondaryInitialSize !== 'undefined') {\n            secondaryPaneSize = this.props.secondaryInitialSize;\n        } else {\n            const containerRect = this.container.getBoundingClientRect();\n            let splitterRect;\n            if (this.splitter) {\n                splitterRect = this.splitter.getBoundingClientRect();\n            } else {\n                // Simulate a splitter\n                splitterRect = { width: DEFAULT_SPLITTER_SIZE, height: DEFAULT_SPLITTER_SIZE };\n            }\n            secondaryPaneSize = this.getSecondaryPaneSize(containerRect, splitterRect, {\n                left: containerRect.left + ((containerRect.width - splitterRect.width) / 2),\n                top: containerRect.top + ((containerRect.height - splitterRect.height) / 2)\n            }, false);\n        }\n        this.setState({ secondaryPaneSize });\n    }\n\n    componentDidUpdate(prevProps: Props, prevState: State) {\n        if (prevState.secondaryPaneSize !== this.state.secondaryPaneSize && this.props.onSecondaryPaneSizeChange) {\n            this.props.onSecondaryPaneSizeChange(this.state.secondaryPaneSize);\n        }\n        if (this.props.onUpdate && this.state.secondaryPaneSize !== prevState.secondaryPaneSize) {\n            this.props.onUpdate(this.state.secondaryPaneSize);\n        }\n        if (prevState.resizing !== this.state.resizing) {\n            if (this.state.resizing) {\n                if (this.props.onDragStart) {\n                    this.props.onDragStart();\n                }\n            } else if (this.props.onDragEnd) {\n                this.props.onDragEnd();\n            }\n        }\n    }\n\n    componentWillUnmount() {\n        window.removeEventListener('resize', this.handleResize);\n        document.removeEventListener('mouseup', this.handleMouseUp);\n        document.removeEventListener('mousemove', this.handleMouseMove);\n        document.removeEventListener('touchend', this.handleMouseUp);\n        document.removeEventListener('touchmove', this.handleTouchMove);\n    }\n\n    getSecondaryPaneSize(containerRect: any, splitterRect: any, clientPosition: any, offsetMouse: any) {\n        let totalSize;\n        let splitterSize;\n        let offset;\n        if (this.props.vertical) {\n            totalSize = containerRect.height;\n            splitterSize = splitterRect.height;\n            offset = clientPosition.top - containerRect.top;\n        } else {\n            totalSize = containerRect.width;\n            splitterSize = splitterRect.width;\n            offset = clientPosition.left - containerRect.left;\n        }\n        if (offsetMouse) {\n            offset -= splitterSize / 2;\n        }\n        if (offset < 0) {\n            offset = 0;\n        } else if (offset > totalSize - splitterSize) {\n            offset = totalSize - splitterSize;\n        }\n\n        let secondaryPaneSize;\n        if (this.props.primaryIndex === 1) {\n            secondaryPaneSize = offset;\n        } else {\n            secondaryPaneSize = totalSize - splitterSize - offset;\n        }\n        let primaryPaneSize = totalSize - splitterSize - secondaryPaneSize;\n        if (this.props.percentage) {\n            secondaryPaneSize = (secondaryPaneSize * 100) / totalSize;\n            primaryPaneSize = (primaryPaneSize * 100) / totalSize;\n            splitterSize = (splitterSize * 100) / totalSize;\n            totalSize = 100;\n        }\n\n        if (primaryPaneSize < this.props.primaryMinSize) {\n            secondaryPaneSize = Math.max(secondaryPaneSize - (this.props.primaryMinSize - primaryPaneSize), 0);\n        } else if (secondaryPaneSize < this.props.secondaryMinSize) {\n            secondaryPaneSize = Math.min(totalSize - splitterSize - this.props.primaryMinSize, this.props.secondaryMinSize);\n        }\n\n        return secondaryPaneSize;\n    }\n\n    handleResize() {\n        if (this.splitter && !this.props.percentage) {\n            const containerRect = this.container.getBoundingClientRect();\n            const splitterRect = this.splitter.getBoundingClientRect();\n            const secondaryPaneSize = this.getSecondaryPaneSize(containerRect, splitterRect, {\n                left: splitterRect.left,\n                top: splitterRect.top\n            }, false);\n            this.setState({ secondaryPaneSize });\n        }\n    }\n\n    handleMouseMove(e: any) {\n        if (this.state.resizing) {\n            const containerRect = this.container.getBoundingClientRect();\n            const splitterRect = this.splitter.getBoundingClientRect();\n            const secondaryPaneSize = this.getSecondaryPaneSize(containerRect, splitterRect, {\n                left: e.clientX,\n                top: e.clientY\n            }, true);\n            clearSelection();\n            this.setState({ secondaryPaneSize });\n        }\n    }\n\n    handleTouchMove(e: any) {\n        this.handleMouseMove(e.changedTouches[0]);\n    }\n\n    handleSplitterMouseDown() {\n        clearSelection();\n        this.setState({ resizing: true });\n    }\n\n    handleMouseUp() {\n        this.setState(prevState => (prevState.resizing ? { resizing: false } : null));\n    }\n\n    render() {\n        let containerClasses = 'splitter-layout';\n        if (this.props.customClassName) {\n            containerClasses += ` ${this.props.customClassName}`;\n        }\n        if (this.props.vertical) {\n            containerClasses += ' splitter-layout-vertical';\n        }\n        if (this.state.resizing) {\n            containerClasses += ' layout-changing';\n        }\n\n        const children = React.Children.toArray(this.props.children).slice(0, 2);\n        if (children.length === 0) {\n            children.push(<div />);\n        }\n        const wrappedChildren = [];\n        let primaryIndex = (this.props.primaryIndex !== 0 && this.props.primaryIndex !== 1) ? 0 : this.props.primaryIndex;\n        if (this.props.vertical) {\n            primaryIndex = 1 - primaryIndex;\n        }\n        for (let i = 0; i < children.length; ++i) {\n            let primary = true;\n            let size = undefined;\n            if (children.length > 1 && i !== primaryIndex) {\n                primary = false;\n                size = this.state.secondaryPaneSize;\n            }\n            wrappedChildren.push(\n                <Pane vertical={this.props.vertical} percentage={this.props.percentage} primary={primary} size={size}>\n                {children[i]}\n                </Pane>\n            );\n        }\n\n        return (\n            <div className={containerClasses} ref={(c) => { this.container = c; }}>\n            {wrappedChildren[0]}\n            {wrappedChildren.length > 1 &&\n                (\n                    <div\n                    role=\"separator\"\n                    className=\"layout-splitter\"\n                    ref={(c) => { this.splitter = c; }}\n                    onMouseDown={this.handleSplitterMouseDown}\n                    onTouchStart={this.handleSplitterMouseDown}\n                    >\n                    {this.props.splitterChildren}\n                    </div>\n            )\n            }\n            {wrappedChildren.length > 1 && wrappedChildren[1]}\n            </div>\n        );\n    }\n}\n\nexport default SplitterLayout;\n","import * as React from 'react';\nimport './MiniWindow.css';\n\nexport interface Props {\n    title: string;\n    footer?: any;\n    header?: any;\n    content: any;\n    className?: string;\n    updateAnchor?: any;\n}\n\ninterface State {\n    collapseStatus: boolean;\n}\n\nclass MiniWindow extends React.Component<Props, State> {\n    mainInstance: HTMLElement;\n\n    constructor(props: Props) {\n        super(props);\n        this.state = {\n            'collapseStatus' : false,\n        };\n\n    }\n\n    componentDidUpdate (prevProps: any, prevState: any) {\n        if (prevProps.updateAnchor !== this.props.updateAnchor && this.mainInstance) {\n            let width = this.mainInstance.clientWidth;\n            let collapseStatus = false;\n            if (width < 100) {\n                collapseStatus = true;\n            }\n            this.setState({collapseStatus});\n        }\n    }\n\n    render() {\n        let footerAdd = '';\n        let classAdd = '';\n        if (this.state.collapseStatus) {\n            classAdd = 'mini-collapsed ';\n        }\n        if (this.props.className) {\n            classAdd += this.props.className;\n        }\n        if (!this.props.footer) {\n            footerAdd = 'no-content';\n        }\n        return (\n            <div className={`mini-window ${classAdd}`} ref={(ref: HTMLElement | null) => {\n                    if (ref != null) { this.mainInstance = ref; }\n                }}>\n                <div className=\"window-header noselect\">\n                    <div className=\"window-title\">{this.props.title}</div> {this.props.header}\n                </div>\n                <div className=\"window-content\">\n                    {this.props.content}\n                </div>\n                <div className={`window-footer ${footerAdd}`}>\n                    {this.props.footer}\n                </div>\n            </div>);\n    }\n}\n\nexport default MiniWindow;\n","/*\n * QR Code generator library (TypeScript)\n *\n * Copyright (c) Project Nayuki. (MIT License)\n * https://www.nayuki.io/page/qr-code-generator-library\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\n * this software and associated documentation files (the \"Software\"), to deal in\n * the Software without restriction, including without limitation the rights to\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\n * the Software, and to permit persons to whom the Software is furnished to do so,\n * subject to the following conditions:\n * - The above copyright notice and this permission notice shall be included in\n *   all copies or substantial portions of the Software.\n * - The Software is provided \"as is\", without warranty of any kind, express or\n *   implied, including but not limited to the warranties of merchantability,\n *   fitness for a particular purpose and noninfringement. In no event shall the\n *   authors or copyright holders be liable for any claim, damages or other\n *   liability, whether in an action of contract, tort or otherwise, arising from,\n *   out of or in connection with the Software or the use or other dealings in the\n *   Software.\n */\n\ntype bit  = number;\ntype byte = number;\ntype int  = number;\n\n/*\n * Describes how a segment's data bits are interpreted. Immutable.\n */\nexport class Mode {\n    public static readonly NUMERIC      = new Mode(0x1, [10, 12, 14]);\n    public static readonly ALPHANUMERIC = new Mode(0x2, [ 9, 11, 13]);\n    public static readonly BYTE         = new Mode(0x4, [ 8, 16, 16]);\n    public static readonly KANJI        = new Mode(0x8, [ 8, 10, 12]);\n    public static readonly ECI          = new Mode(0x7, [ 0,  0,  0]);\n\n    // (Package-private) Returns the bit width of the character count field for a segment in\n    // this mode in a QR Code at the given version number. The result is in the range [0, 16].\n    public numCharCountBits(ver: int): int {\n        return this.numBitsCharCount[Math.floor((ver + 7) / 17)];\n    }\n\n    private constructor(\n        // The mode indicator bits, which is a uint4 value (range 0 to 15).\n        public readonly modeBits: int,\n        // Number of character count bits for three different version ranges.\n        private readonly numBitsCharCount: [int, int, int]) { }\n}\n\n/*\n * A segment of character/binary/control data in a QR Code symbol.\n * Instances of this class are immutable.\n * The mid-level way to create a segment is to take the payload data\n * and call a static factory function such as QrSegment.makeNumeric().\n * The low-level way to create a segment is to custom-make the bit buffer\n * and call the QrSegment() constructor with appropriate values.\n * This segment class imposes no length restrictions, but QR Codes have restrictions.\n * Even in the most favorable conditions, a QR Code can only hold 7089 characters of data.\n * Any segment longer than this is meaningless for the purpose of generating QR Codes.\n */\nexport class QrSegment {\n    // Describes precisely all strings that are encodable in numeric mode. To test\n    // whether a string s is encodable: let ok: boolean = NUMERIC_REGEX.test(s);\n    // A string is encodable iff each character is in the range 0 to 9.\n    public static readonly NUMERIC_REGEX: RegExp = /^[0-9]*$/;\n\n    // Describes precisely all strings that are encodable in alphanumeric mode. To test\n    // whether a string s is encodable: let ok: boolean = ALPHANUMERIC_REGEX.test(s);\n    // A string is encodable iff each character is in the following set: 0 to 9, A to Z\n    // (uppercase only), space, dollar, percent, asterisk, plus, hyphen, period, slash, colon.\n    // eslint-disable-next-line\n    public static readonly ALPHANUMERIC_REGEX: RegExp = /^[A-Z0-9 $%*+.\\/:-]*$/;\n\n    // The set of all legal characters in alphanumeric mode,\n    // where each character value maps to the index in the string.\n    public static readonly ALPHANUMERIC_CHARSET: string =\n        '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:';\n\n    // Returns a segment representing the given binary data encoded in\n    // byte mode. All input byte arrays are acceptable. Any text string\n    // can be converted to UTF-8 bytes and encoded as a byte mode segment.\n    public static makeBytes(data: Array<byte>): QrSegment {\n        let bb: Array<bit> = [];\n        for (const b of data) {\n            appendBits(b, 8, bb);\n        }\n        return new QrSegment(Mode.BYTE, data.length, bb);\n    }\n\n    // Returns a segment representing the given string of decimal digits encoded in numeric mode.\n    public static makeNumeric(digits: string): QrSegment {\n        if (!this.NUMERIC_REGEX.test(digits)) {\n            throw new Error('String contains non-numeric characters');\n        }\n        let bb: Array<bit> = [];\n        for (let i = 0; i < digits.length; ) {  // Consume up to 3 digits per iteration\n            const n: int = Math.min(digits.length - i, 3);\n            appendBits(parseInt(digits.substr(i, n), 10), n * 3 + 1, bb);\n            i += n;\n        }\n        return new QrSegment(Mode.NUMERIC, digits.length, bb);\n    }\n\n    // Returns a segment representing the given text string encoded in alphanumeric mode.\n    // The characters allowed are: 0 to 9, A to Z (uppercase only), space,\n    // dollar, percent, asterisk, plus, hyphen, period, slash, colon.\n    public static makeAlphanumeric(text: string): QrSegment {\n        if (!this.ALPHANUMERIC_REGEX.test(text)) {\n            throw new Error('String contains unencodable characters in alphanumeric mode');\n        }\n        let bb: Array<bit> = [];\n        let i: int;\n        for (i = 0; i + 2 <= text.length; i += 2) {  // Process groups of 2\n            let temp: int = QrSegment.ALPHANUMERIC_CHARSET.indexOf(text.charAt(i)) * 45;\n            temp += QrSegment.ALPHANUMERIC_CHARSET.indexOf(text.charAt(i + 1));\n            appendBits(temp, 11, bb);\n        }\n        if (i < text.length) { // 1 character remaining\n            appendBits(QrSegment.ALPHANUMERIC_CHARSET.indexOf(text.charAt(i)), 6, bb);\n        }\n        return new QrSegment(Mode.ALPHANUMERIC, text.length, bb);\n    }\n\n    // Returns a new mutable list of zero or more segments to represent the given Unicode text string.\n    // The result may use various segment modes and switch modes to optimize the length of the bit stream.\n    public static makeSegments(text: string): Array<QrSegment> {\n        // Select the most efficient segment encoding automatically\n        if (text === '') {\n            return [];\n        } else if (this.NUMERIC_REGEX.test(text)) {\n            return [QrSegment.makeNumeric(text)];\n        } else if (this.ALPHANUMERIC_REGEX.test(text)) {\n            return [QrSegment.makeAlphanumeric(text)];\n        } else {\n            return [QrSegment.makeBytes(QrSegment.toUtf8ByteArray(text))];\n        }\n    }\n\n    // Returns a segment representing an Extended Channel Interpretation\n    // (ECI) designator with the given assignment value.\n    public static makeEci(assignVal: int): QrSegment {\n        let bb: Array<bit> = [];\n        if (assignVal < 0) {\n            throw new Error('ECI assignment value out of range');\n        } else if (assignVal < (1 << 7)) {\n            appendBits(assignVal, 8, bb);\n        } else if (assignVal < (1 << 14)) {\n            appendBits(2, 2, bb);\n            appendBits(assignVal, 14, bb);\n        } else if (assignVal < 1000000) {\n            appendBits(6, 3, bb);\n            appendBits(assignVal, 21, bb);\n        } else {\n            throw new Error('ECI assignment value out of range');\n        }\n        return new QrSegment(Mode.ECI, 0, bb);\n    }\n\n    // (Package-private) Calculates and returns the number of bits needed to encode the given segments at\n    // the given version. The result is infinity if a segment has too many characters to fit its length field.\n    public static getTotalBits(segs: Array<QrSegment>, version: int): number {\n        let result: number = 0;\n        for (const seg of segs) {\n            const ccbits: int = seg.mode.numCharCountBits(version);\n            if (seg.numChars >= (1 << ccbits)) {\n                return Infinity;  // The segment's length doesn't fit the field's bit width\n            }\n            result += 4 + ccbits + seg.bitData.length;\n        }\n        return result;\n    }\n\n    // Returns a new array of bytes representing the given string encoded in UTF-8.\n    private static toUtf8ByteArray(str: string): Array<byte> {\n        str = encodeURI(str);\n        let result: Array<byte> = [];\n        for (let i = 0; i < str.length; i++) {\n            if (str.charAt(i) !== '%') {\n                result.push(str.charCodeAt(i));\n            } else {\n                result.push(parseInt(str.substr(i + 1, 2), 16));\n                i += 2;\n            }\n        }\n        return result;\n    }\n\n    // Creates a new QR Code segment with the given attributes and data.\n    // The character count (numChars) must agree with the mode and the bit buffer length,\n    // but the constraint isn't checked. The given bit buffer is cloned and stored.\n    public constructor(\n        // The mode indicator of this segment.\n        public readonly mode: Mode,\n\n        // The length of this segment's unencoded data. Measured in characters for\n        // numeric/alphanumeric/kanji mode, bytes for byte mode, and 0 for ECI mode.\n        // Always zero or positive. Not the same as the data's bit length.\n        public readonly numChars: int,\n\n        // The data bits of this segment. Accessed through getData().\n        private readonly bitData: Array<bit>) {\n\n        if (numChars < 0) {\n            throw new Error('Invalid argument');\n        }\n        this.bitData = bitData.slice();  // Make defensive copy\n    }\n\n    /*-- Methods --*/\n\n    // Returns a new copy of the data bits of this segment.\n    public getData(): Array<bit> {\n        return this.bitData.slice();  // Make defensive copy\n    }\n}\n\n/*\n * The error correction level in a QR Code symbol. Immutable.\n */\nexport class Ecc {\n    /*-- Constants --*/\n    public static readonly LOW      = new Ecc(0, 1);  // The QR Code can tolerate about  7% erroneous codewords\n    public static readonly MEDIUM   = new Ecc(1, 0);  // The QR Code can tolerate about 15% erroneous codewords\n    public static readonly QUARTILE = new Ecc(2, 3);  // The QR Code can tolerate about 25% erroneous codewords\n    public static readonly HIGH     = new Ecc(3, 2);  // The QR Code can tolerate about 30% erroneous codewords\n\n    /*-- Constructor and fields --*/\n\n    private constructor(\n        // In the range 0 to 3 (unsigned 2-bit integer).\n        public readonly ordinal: int,\n        // (Package-private) In the range 0 to 3 (unsigned 2-bit integer).\n        public readonly formatBits: int) {}\n}\n\n/*\n * A QR Code symbol, which is a type of two-dimension barcode.\n * Invented by Denso Wave and described in the ISO/IEC 18004 standard.\n * Instances of this class represent an immutable square grid of black and white cells.\n * The class provides static factory functions to create a QR Code from text or binary data.\n * The class covers the QR Code Model 2 specification, supporting all versions (sizes)\n * from 1 to 40, all 4 error correction levels, and 4 character encoding modes.\n *\n * Ways to create a QR Code object:\n * - High level: Take the payload data and call QrCode.encodeText() or QrCode.encodeBinary().\n * - Mid level: Custom-make the list of segments and call QrCode.encodeSegments().\n * - Low level: Custom-make the array of data codeword bytes (including\n *   segment headers and final padding, excluding error correction codewords),\n *   supply the appropriate version number, and call the QrCode() constructor.\n * (Note that all ways require supplying the desired error correction level.)\n */\nexport class QrCode {\n    // The minimum version number supported in the QR Code Model 2 standard.\n    public static readonly MIN_VERSION: int =  1;\n    // The maximum version number supported in the QR Code Model 2 standard.\n    public static readonly MAX_VERSION: int = 40;\n\n    // For use in getPenaltyScore(), when evaluating which mask is best.\n    private static readonly PENALTY_N1: int =  3;\n    private static readonly PENALTY_N2: int =  3;\n    private static readonly PENALTY_N3: int = 40;\n    private static readonly PENALTY_N4: int = 10;\n\n    private static readonly ECC_CODEWORDS_PER_BLOCK: Array<Array<int>> = [\n        // Version: (note that index 0 is for padding, and is set to an illegal value)\n        [-1,  7, 10, 15, 20, 26, 18, 20, 24, 30, 18, 20, 24, 26, 30, 22, 24, 28, 30, 28, 28,\n            28, 28, 30, 30, 26, 28, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30],  // Low\n        [-1, 10, 16, 26, 18, 24, 16, 18, 22, 22, 26, 30, 22, 22, 24, 24, 28, 28, 26, 26, 26,\n            26, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28],  // Medium\n        [-1, 13, 22, 18, 26, 18, 24, 18, 22, 20, 24, 28, 26, 24, 20, 30, 24, 28, 28, 26, 30,\n            28, 30, 30, 30, 30, 28, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30],  // Quartile\n        [-1, 17, 28, 22, 16, 22, 28, 26, 26, 24, 28, 24, 28, 22, 24, 24, 30, 28, 28, 26, 28,\n            30, 24, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30],  // High\n    ];\n\n    private static readonly NUM_ERROR_CORRECTION_BLOCKS: Array<Array<int>> = [\n        // Version: (note that index 0 is for padding, and is set to an illegal value)\n        [-1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 4,  4,  4,  4,  4,  6,  6,  6,  6,  7,  8,  8,  9,  9,\n            10, 12, 12, 12, 13, 14, 15, 16, 17, 18, 19, 19, 20, 21, 22, 24, 25],  // Low\n        [-1, 1, 1, 1, 2, 2, 4, 4, 4, 5, 5,  5,  8,  9,  9, 10, 10, 11, 13, 14, 16, 17, 17, 18,\n            20, 21, 23, 25, 26, 28, 29, 31, 33, 35, 37, 38, 40, 43, 45, 47, 49],  // Medium\n        [-1, 1, 1, 2, 2, 4, 4, 6, 6, 8, 8,  8, 10, 12, 16, 12, 17, 16, 18, 21, 20, 23, 23, 25,\n            27, 29, 34, 34, 35, 38, 40, 43, 45, 48, 51, 53, 56, 59, 62, 65, 68],  // Quartile\n        [-1, 1, 1, 2, 4, 4, 4, 5, 6, 8, 8, 11, 11, 16, 16, 18, 16, 19, 21, 25, 25, 25, 34, 30,\n            32, 35, 37, 40, 42, 45, 48, 51, 54, 57, 60, 63, 66, 70, 74, 77, 81],  // High\n    ];\n\n    // The width and height of this QR Code, measured in modules, between\n    // 21 and 177 (inclusive). This is equal to version * 4 + 17.\n    public readonly size: int;\n\n    // The modules of this QR Code (false = white, true = black).\n    // Immutable after constructor finishes. Accessed through getModule().\n    private readonly modules: Array<Array<boolean>> = [];\n\n    // Indicates function modules that are not subjected to masking. Discarded when constructor finishes.\n    private readonly isFunction: Array<Array<boolean>> = [];\n\n    // Returns a QR Code representing the given Unicode text string at the given error correction level.\n    // As a conservative upper bound, this function is guaranteed to succeed for strings that have 738 or fewer\n    // Unicode code points (not UTF-16 code units) if the low error correction level is used. The smallest possible\n    // QR Code version is automatically chosen for the output. The ECC level of the result may be higher than the\n    // ecl argument if it can be done without increasing the version.\n    public static encodeText(text: string, ecl: Ecc): QrCode {\n        const segs: Array<QrSegment> = QrSegment.makeSegments(text);\n        return QrCode.encodeSegments(segs, ecl);\n    }\n\n    // Returns a QR Code representing the given segments with the given encoding parameters.\n    // The smallest possible QR Code version within the given range is automatically\n    // chosen for the output. Iff boostEcl is true, then the ECC level of the result\n    // may be higher than the ecl argument if it can be done without increasing the\n    // version. The mask number is either between 0 to 7 (inclusive) to force that\n    // mask, or -1 to automatically choose an appropriate mask (which may be slow).\n    // This function allows the user to create a custom sequence of segments that switches\n    // between modes (such as alphanumeric and byte) to encode text in less space.\n    // This is a mid-level API; the high-level API is encodeText() and encodeBinary().\n    public static encodeSegments(segs: Array<QrSegment>, ecl: Ecc,\n                                 minVersion: int = 1, maxVersion: int = 40,\n                                 mask: int = -1, boostEcl: boolean = true): QrCode {\n\n        if (!(QrCode.MIN_VERSION <= minVersion && minVersion <= maxVersion\n              && maxVersion <= QrCode.MAX_VERSION) || mask < -1 || mask > 7) {\n            throw new Error('Invalid value');\n        }\n\n        // Find the minimal version number to use\n        let version: int;\n        let dataUsedBits: int;\n        for (version = minVersion; ; version++) {\n            // Number of data bits available\n            const lDataCapacityBits: int = QrCode.getNumDataCodewords(version, ecl) * 8;\n            const usedBits: number = QrSegment.getTotalBits(segs, version);\n            if (usedBits <= lDataCapacityBits) {\n                dataUsedBits = usedBits;\n                break;  // This version number is found to be suitable\n            }\n            if (version >= maxVersion) { // All versions in the range could not fit the given data\n                throw new Error('Data too long');\n            }\n        }\n\n        // Increase the error correction level while the data still fits in the current version number\n        for (const newEcl of [Ecc.MEDIUM, Ecc.QUARTILE, Ecc.HIGH]) {  // From low to high\n            if (boostEcl && dataUsedBits <= QrCode.getNumDataCodewords(version, newEcl) * 8) {\n                ecl = newEcl;\n            }\n        }\n\n        // Concatenate all segments to create the data bit string\n        let bb: Array<bit> = [];\n        for (const seg of segs) {\n            appendBits(seg.mode.modeBits, 4, bb);\n            appendBits(seg.numChars, seg.mode.numCharCountBits(version), bb);\n            for (const b of seg.getData()) {\n                bb.push(b);\n            }\n        }\n        if (bb.length !== dataUsedBits) {\n            throw new Error('Assertion error');\n        }\n\n        // Add terminator and pad up to a byte if applicable\n        const dataCapacityBits: int = QrCode.getNumDataCodewords(version, ecl) * 8;\n        if (bb.length > dataCapacityBits) {\n            throw new Error('Assertion error');\n        }\n        appendBits(0, Math.min(4, dataCapacityBits - bb.length), bb);\n        appendBits(0, (8 - bb.length % 8) % 8, bb);\n        if (bb.length % 8 !== 0) {\n            throw new Error('Assertion error');\n        }\n\n        // Pad with alternating bytes until data capacity is reached\n        for (let padByte = 0xEC; bb.length < dataCapacityBits; padByte ^= 0xEC ^ 0x11) {\n            appendBits(padByte, 8, bb);\n        }\n\n        // Pack bits into bytes in big endian\n        let dataCodewords: Array<byte> = [];\n        while (dataCodewords.length * 8 < bb.length) {\n            dataCodewords.push(0);\n        }\n        bb.forEach((b: bit, i: int) =>\n            dataCodewords[i >>> 3] |= b << (7 - (i & 7)));\n\n        // Create the QR Code object\n        return new QrCode(version, ecl, dataCodewords, mask);\n    }\n\n    // Returns the number of data bits that can be stored in a QR Code of the given version number, after\n    // all function modules are excluded. This includes remainder bits, so it might not be a multiple of 8.\n    // The result is in the range [208, 29648]. This could be implemented as a 40-entry lookup table.\n    private static getNumRawDataModules(ver: int): int {\n        if (ver < QrCode.MIN_VERSION || ver > QrCode.MAX_VERSION) {\n            throw new Error('Version number out of range');\n        }\n        let result: int = (16 * ver + 128) * ver + 64;\n        if (ver >= 2) {\n            const numAlign: int = Math.floor(ver / 7) + 2;\n            result -= (25 * numAlign - 10) * numAlign - 55;\n            if (ver >= 7) {\n                result -= 36;\n            }\n        }\n        if (!(208 <= result && result <= 29648)) {\n            throw new Error('Assertion error');\n        }\n        return result;\n    }\n\n    // Returns the number of 8-bit data (i.e. not error correction) codewords contained in any\n    // QR Code of the given version number and error correction level, with remainder bits discarded.\n    // This stateless pure function could be implemented as a (40*4)-cell lookup table.\n    private static getNumDataCodewords(ver: int, ecl: Ecc): int {\n        return Math.floor(QrCode.getNumRawDataModules(ver) / 8) -\n            QrCode.ECC_CODEWORDS_PER_BLOCK[ecl.ordinal][ver] *\n            QrCode.NUM_ERROR_CORRECTION_BLOCKS[ecl.ordinal][ver];\n    }\n\n    // Returns a Reed-Solomon ECC generator polynomial for the given degree. This could be\n    // implemented as a lookup table over all possible parameter values, instead of as an algorithm.\n    private static reedSolomonComputeDivisor(degree: int): Array<byte> {\n        if (degree < 1 || degree > 255) {\n            throw new Error('Degree out of range');\n        }\n        // Polynomial coefficients are stored from highest to lowest power, excluding the\n        // leading term which is always 1.\n        // For example the polynomial x^3 + 255x^2 + 8x + 93 is stored as the uint8 array [255, 8, 93].\n        let result: Array<byte> = [];\n        for (let i = 0; i < degree - 1; i++) {\n            result.push(0);\n        }\n        result.push(1);  // Start off with the monomial x^0\n\n        // Compute the product polynomial (x - r^0) * (x - r^1) * (x - r^2) * ... * (x - r^{degree-1}),\n        // and drop the highest monomial term which is always 1x^degree.\n        // Note that r = 0x02, which is a generator element of this field GF(2^8/0x11D).\n        let root = 1;\n        for (let i = 0; i < degree; i++) {\n            // Multiply the current product by (x - r^i)\n            for (let j = 0; j < result.length; j++) {\n                result[j] = QrCode.reedSolomonMultiply(result[j], root);\n                if (j + 1 < result.length) {\n                    result[j] ^= result[j + 1];\n                }\n            }\n            root = QrCode.reedSolomonMultiply(root, 0x02);\n        }\n        return result;\n    }\n\n    // Returns the Reed-Solomon error correction codeword for the given data and divisor polynomials.\n    private static reedSolomonComputeRemainder(data: Array<byte>,\n                                               divisor: Array<byte>): Array<byte> {\n        let result: Array<byte> = divisor.map(_ => 0);\n        for (const b of data) {  // Polynomial division\n            const factor: byte = b ^ (result.shift() as byte);\n            result.push(0);\n            divisor.forEach((coef, i) =>\n                result[i] ^= QrCode.reedSolomonMultiply(coef, factor));\n        }\n        return result;\n    }\n\n    // Returns the product of the two given field elements modulo GF(2^8/0x11D). The arguments and result\n    // are unsigned 8-bit integers. This could be implemented as a lookup table of\n    // 256*256 entries of uint8.\n    private static reedSolomonMultiply(x: byte, y: byte): byte {\n        if (x >>> 8 !== 0 || y >>> 8 !== 0) {\n            throw new Error('Byte out of range');\n        }\n        // Russian peasant multiplication\n        let z: int = 0;\n        for (let i = 7; i >= 0; i--) {\n            z = (z << 1) ^ ((z >>> 7) * 0x11D);\n            z ^= ((y >>> i) & 1) * x;\n        }\n        if (z >>> 8 !== 0) {\n            throw new Error('Assertion error');\n        }\n        return z as byte;\n    }\n\n    // Pushes the given value to the front and drops the last value.\n    // A helper function for getPenaltyScore().\n    private static finderPenaltyAddHistory(currentRunLength: int, runHistory: Array<int>): void {\n        runHistory.pop();\n        runHistory.unshift(currentRunLength);\n    }\n\n    // Creates a new QR Code with the given version number,\n    // error correction level, data codeword bytes, and mask number.\n    // This is a low-level API that most users should not use directly.\n    // A mid-level API is the encodeSegments() function.\n    public constructor(\n        // The version number of this QR Code, which is between 1 and 40 (inclusive).\n        // This determines the size of this barcode.\n        public readonly version: int,\n\n        // The error correction level used in this QR Code.\n        public readonly errorCorrectionLevel: Ecc,\n\n        dataCodewords: Array<byte>,\n\n        // The index of the mask pattern used in this QR Code, which is between 0 and 7 (inclusive).\n        // Even if a QR Code is created with automatic masking requested (mask = -1),\n        // the resulting object still has a mask value between 0 and 7.\n        public readonly mask: int) {\n\n        // Check scalar arguments\n        if (version < QrCode.MIN_VERSION || version > QrCode.MAX_VERSION) {\n            throw new Error('Version value out of range');\n        }\n        if (mask < -1 || mask > 7) {\n            throw new Error('Mask value out of range');\n        }\n        this.size = version * 4 + 17;\n\n        // Initialize both grids to be size*size arrays of Boolean false\n        let row: Array<boolean> = [];\n        for (let i = 0; i < this.size; i++) {\n            row.push(false);\n        }\n        for (let i = 0; i < this.size; i++) {\n            this.modules.push(row.slice());  // Initially all white\n            this.isFunction.push(row.slice());\n        }\n\n        // Compute ECC, draw modules\n        this.drawFunctionPatterns();\n        const allCodewords: Array<byte> = this.addEccAndInterleave(dataCodewords);\n        this.drawCodewords(allCodewords);\n\n        // Do masking\n        if (mask === -1) {  // Automatically choose best mask\n            let minPenalty: int = 1000000000;\n            for (let i = 0; i < 8; i++) {\n                this.applyMask(i);\n                this.drawFormatBits(i);\n                const penalty: int = this.getPenaltyScore();\n                if (penalty < minPenalty) {\n                    mask = i;\n                    minPenalty = penalty;\n                }\n                this.applyMask(i);  // Undoes the mask due to XOR\n            }\n        }\n        if (mask < 0 || mask > 7) {\n            throw new Error('Assertion error');\n        }\n        this.mask = mask;\n        this.applyMask(mask);  // Apply the final choice of mask\n        this.drawFormatBits(mask);  // Overwrite old format bits\n\n        this.isFunction = [];\n    }\n\n    // Returns the color of the module (pixel) at the given coordinates, which is false\n    // for white or true for black. The top left corner has the coordinates (x=0, y=0).\n    // If the given coordinates are out of bounds, then false (white) is returned.\n    public getModule(x: int, y: int): boolean {\n        return 0 <= x && x < this.size && 0 <= y && y < this.size && this.modules[y][x];\n    }\n\n    // Draws this QR Code, with the given module scale and border modules, onto the given HTML\n    // canvas element. The canvas's width and height is resized to (this.size + border * 2) * scale.\n    // The drawn image is be purely black and white, and fully opaque.\n    // The scale must be a positive integer and the border must be a non-negative integer.\n    public drawCanvas(scale: int, border: int, canvas: HTMLCanvasElement,\n                      white: string = '#FFFFFF', black: string = '#000000'): void {\n        if (scale <= 0 || border < 0) {\n            throw new Error('Value out of range');\n        }\n        const width: int = (this.size + border * 2) * scale;\n        canvas.width = width;\n        canvas.height = width;\n        let ctx = canvas.getContext('2d') as CanvasRenderingContext2D;\n        for (let y = -border; y < this.size + border; y++) {\n            for (let x = -border; x < this.size + border; x++) {\n                ctx.fillStyle = this.getModule(x, y) ? black : white;\n                ctx.fillRect((x + border) * scale, (y + border) * scale, scale, scale);\n            }\n        }\n    }\n\n    // Reads this object's version field, and draws and marks all function modules.\n    private drawFunctionPatterns(): void {\n        // Draw horizontal and vertical timing patterns\n        for (let i = 0; i < this.size; i++) {\n            this.setFunctionModule(6, i, i % 2 === 0);\n            this.setFunctionModule(i, 6, i % 2 === 0);\n        }\n\n        // Draw 3 finder patterns (all corners except bottom right; overwrites some timing modules)\n        this.drawFinderPattern(3, 3);\n        this.drawFinderPattern(this.size - 4, 3);\n        this.drawFinderPattern(3, this.size - 4);\n\n        // Draw numerous alignment patterns\n        const alignPatPos: Array<int> = this.getAlignmentPatternPositions();\n        const numAlign: int = alignPatPos.length;\n        for (let i = 0; i < numAlign; i++) {\n            for (let j = 0; j < numAlign; j++) {\n                // Don't draw on the three finder corners\n                if (!((i === 0 && j === 0) || (i === 0 && j === numAlign - 1)\n                    || (i === numAlign - 1 && j === 0))) {\n                    this.drawAlignmentPattern(alignPatPos[i], alignPatPos[j]);\n                }\n            }\n        }\n\n        // Draw configuration data\n        this.drawFormatBits(0);  // Dummy mask value; overwritten later in the constructor\n        this.drawVersion();\n    }\n\n    // Draws two copies of the format bits (with its own error correction code)\n    // based on the given mask and this object's error correction level field.\n    private drawFormatBits(mask: int): void {\n        // Calculate error correction code and pack bits\n        const data: int = (this.errorCorrectionLevel.formatBits << 3) | mask;  // errCorrLvl is uint2, mask is uint3\n        let rem: int = data;\n        for (let i = 0; i < 10; i++) {\n            rem = (rem << 1) ^ ((rem >>> 9) * 0x537);\n        }\n        const bits = ((data << 10) | rem) ^ 0x5412;  // uint15\n        if (bits >>> 15 !== 0) {\n            throw new Error('Assertion error');\n        }\n\n        // Draw first copy\n        for (let i = 0; i <= 5; i++) {\n            this.setFunctionModule(8, i, getBit(bits, i));\n        }\n        this.setFunctionModule(8, 7, getBit(bits, 6));\n        this.setFunctionModule(8, 8, getBit(bits, 7));\n        this.setFunctionModule(7, 8, getBit(bits, 8));\n        for (let i = 9; i < 15; i++) {\n            this.setFunctionModule(14 - i, 8, getBit(bits, i));\n        }\n\n        // Draw second copy\n        for (let i = 0; i < 8; i++) {\n            this.setFunctionModule(this.size - 1 - i, 8, getBit(bits, i));\n        }\n        for (let i = 8; i < 15; i++) {\n            this.setFunctionModule(8, this.size - 15 + i, getBit(bits, i));\n        }\n        this.setFunctionModule(8, this.size - 8, true);  // Always black\n    }\n\n    // Draws two copies of the version bits (with its own error correction code),\n    // based on this object's version field, iff 7 <= version <= 40.\n    private drawVersion(): void {\n        if (this.version < 7) {\n            return;\n        }\n\n        // Calculate error correction code and pack bits\n        let rem: int = this.version;  // version is uint6, in the range [7, 40]\n        for (let i = 0; i < 12; i++) {\n            rem = (rem << 1) ^ ((rem >>> 11) * 0x1F25);\n        }\n        const bits: int = (this.version << 12) | rem;  // uint18\n        if (bits >>> 18 !== 0) {\n            throw new Error('Assertion error');\n        }\n\n        // Draw two copies\n        for (let i = 0; i < 18; i++) {\n            const color: boolean = getBit(bits, i);\n            const a: int = this.size - 11 + i % 3;\n            const b: int = Math.floor(i / 3);\n            this.setFunctionModule(a, b, color);\n            this.setFunctionModule(b, a, color);\n        }\n    }\n\n    // Draws a 9*9 finder pattern including the border separator,\n    // with the center module at (x, y). Modules can be out of bounds.\n    private drawFinderPattern(x: int, y: int): void {\n        for (let dy = -4; dy <= 4; dy++) {\n            for (let dx = -4; dx <= 4; dx++) {\n                const dist: int = Math.max(Math.abs(dx), Math.abs(dy));  // Chebyshev/infinity norm\n                const xx: int = x + dx;\n                const yy: int = y + dy;\n                if (0 <= xx && xx < this.size && 0 <= yy && yy < this.size) {\n                    this.setFunctionModule(xx, yy, dist !== 2 && dist !== 4);\n                }\n            }\n        }\n    }\n\n    // Draws a 5*5 alignment pattern, with the center module\n    // at (x, y). All modules must be in bounds.\n    private drawAlignmentPattern(x: int, y: int): void {\n        for (let dy = -2; dy <= 2; dy++) {\n            for (let dx = -2; dx <= 2; dx++) {\n                this.setFunctionModule(x + dx, y + dy, Math.max(Math.abs(dx), Math.abs(dy)) !== 1);\n            }\n        }\n    }\n\n    // Sets the color of a module and marks it as a function module.\n    // Only used by the constructor. Coordinates must be in bounds.\n    private setFunctionModule(x: int, y: int, isBlack: boolean): void {\n        this.modules[y][x] = isBlack;\n        this.isFunction[y][x] = true;\n    }\n\n    // Returns a new byte string representing the given data with the appropriate error correction\n    // codewords appended to it, based on this object's version and error correction level.\n    private addEccAndInterleave(data: Array<byte>): Array<byte> {\n        const ver: int = this.version;\n        const ecl: Ecc = this.errorCorrectionLevel;\n        if (data.length !== QrCode.getNumDataCodewords(ver, ecl)) {\n            throw new Error('Invalid argument');\n        }\n\n        // Calculate parameter numbers\n        const numBlocks: int = QrCode.NUM_ERROR_CORRECTION_BLOCKS[ecl.ordinal][ver];\n        const blockEccLen: int = QrCode.ECC_CODEWORDS_PER_BLOCK[ecl.ordinal][ver];\n        const rawCodewords: int = Math.floor(QrCode.getNumRawDataModules(ver) / 8);\n        const numShortBlocks: int = numBlocks - rawCodewords % numBlocks;\n        const shortBlockLen: int = Math.floor(rawCodewords / numBlocks);\n\n        // Split data into blocks and append ECC to each block\n        let blocks: Array<Array<byte>> = [];\n        const rsDiv: Array<byte> = QrCode.reedSolomonComputeDivisor(blockEccLen);\n        for (let i = 0, k = 0; i < numBlocks; i++) {\n            let dat: Array<byte> = data.slice(k, k + shortBlockLen - blockEccLen + (i < numShortBlocks ? 0 : 1));\n            k += dat.length;\n            const ecc: Array<byte> = QrCode.reedSolomonComputeRemainder(dat, rsDiv);\n            if (i < numShortBlocks) {\n                dat.push(0);\n            }\n            blocks.push(dat.concat(ecc));\n        }\n\n        // Interleave (not concatenate) the bytes from every block into a single sequence\n        let result: Array<byte> = [];\n        for (let i = 0; i < blocks[0].length; i++) {\n            blocks.forEach((block, j) => {\n                // Skip the padding byte in short blocks\n                if (i !== shortBlockLen - blockEccLen || j >= numShortBlocks) {\n                    result.push(block[i]);\n                }\n            });\n        }\n        if (result.length !== rawCodewords) {\n            throw new Error('Assertion error');\n        }\n        return result;\n    }\n\n    // Draws the given sequence of 8-bit codewords (data and error correction) onto the entire\n    // data area of this QR Code. Function modules need to be marked off before this is called.\n    private drawCodewords(data: Array<byte>): void {\n        if (data.length !== Math.floor(QrCode.getNumRawDataModules(this.version) / 8)) {\n            throw new Error('Invalid argument');\n        }\n        let i: int = 0;  // Bit index into the data\n        // Do the funny zigzag scan\n        for (let right = this.size - 1; right >= 1; right -= 2) {  // Index of right column in each column pair\n            if (right === 6) {\n                right = 5;\n            }\n            for (let vert = 0; vert < this.size; vert++) {  // Vertical counter\n                for (let j = 0; j < 2; j++) {\n                    const x: int = right - j;  // Actual x coordinate\n                    const upward: boolean = ((right + 1) & 2) === 0;\n                    const y: int = upward ? this.size - 1 - vert : vert;  // Actual y coordinate\n                    if (!this.isFunction[y][x] && i < data.length * 8) {\n                        this.modules[y][x] = getBit(data[i >>> 3], 7 - (i & 7));\n                        i++;\n                    }\n                    // If this QR Code has any remainder bits (0 to 7), they were assigned as\n                    // 0/false/white by the constructor and are left unchanged by this method\n                }\n            }\n        }\n        if (i !== data.length * 8) {\n            throw new Error('Assertion error');\n        }\n    }\n\n    // XORs the codeword modules in this QR Code with the given mask pattern.\n    // The function modules must be marked and the codeword bits must be drawn\n    // before masking. Due to the arithmetic of XOR, calling applyMask() with\n    // the same mask value a second time will undo the mask. A final well-formed\n    // QR Code needs exactly one (not zero, two, etc.) mask applied.\n    private applyMask(mask: int): void {\n        if (mask < 0 || mask > 7) {\n            throw new Error('Mask value out of range');\n        }\n        for (let y = 0; y < this.size; y++) {\n            for (let x = 0; x < this.size; x++) {\n                let invert: boolean;\n                switch (mask) {\n                    case 0:  invert = (x + y) % 2 === 0;                                  break;\n                    case 1:  invert = y % 2 === 0;                                        break;\n                    case 2:  invert = x % 3 === 0;                                        break;\n                    case 3:  invert = (x + y) % 3 === 0;                                  break;\n                    case 4:  invert = (Math.floor(x / 3) + Math.floor(y / 2)) % 2 === 0;  break;\n                    case 5:  invert = x * y % 2 + x * y % 3 === 0;                        break;\n                    case 6:  invert = (x * y % 2 + x * y % 3) % 2 === 0;                  break;\n                    case 7:  invert = ((x + y) % 2 + x * y % 3) % 2 === 0;                break;\n                    default:  throw new Error('Assertion error');\n                }\n                if (!this.isFunction[y][x] && invert) {\n                    this.modules[y][x] = !this.modules[y][x];\n                }\n            }\n        }\n    }\n\n    // Calculates and returns the penalty score based on state of this QR Code's current modules.\n    // This is used by the automatic mask choice algorithm to find the mask pattern that yields the lowest score.\n    private getPenaltyScore(): int {\n        let result: int = 0;\n\n        // Adjacent modules in row having same color, and finder-like patterns\n        for (let y = 0; y < this.size; y++) {\n            let runColor = false;\n            let runX = 0;\n            let runHistory = [0, 0, 0, 0, 0, 0, 0];\n            let padRun = this.size;\n            for (let x = 0; x < this.size; x++) {\n                if (this.modules[y][x] === runColor) {\n                    runX++;\n                    if (runX === 5) {\n                        result += QrCode.PENALTY_N1;\n                    } else if (runX > 5) {\n                        result++;\n                    }\n                } else {\n                    QrCode.finderPenaltyAddHistory(runX + padRun, runHistory);\n                    padRun = 0;\n                    if (!runColor) {\n                        result += this.finderPenaltyCountPatterns(runHistory) * QrCode.PENALTY_N3;\n                    }\n                    runColor = this.modules[y][x];\n                    runX = 1;\n                }\n            }\n            result += this.finderPenaltyTerminateAndCount(runColor, runX + padRun, runHistory) * QrCode.PENALTY_N3;\n        }\n        // Adjacent modules in column having same color, and finder-like patterns\n        for (let x = 0; x < this.size; x++) {\n            let runColor = false;\n            let runY = 0;\n            let runHistory = [0, 0, 0, 0, 0, 0, 0];\n            let padRun = this.size;\n            for (let y = 0; y < this.size; y++) {\n                if (this.modules[y][x] === runColor) {\n                    runY++;\n                    if (runY === 5) {\n                        result += QrCode.PENALTY_N1;\n                    } else if (runY > 5) {\n                        result++;\n                    }\n                } else {\n                    QrCode.finderPenaltyAddHistory(runY + padRun, runHistory);\n                    padRun = 0;\n                    if (!runColor) {\n                        result += this.finderPenaltyCountPatterns(runHistory) * QrCode.PENALTY_N3;\n                    }\n                    runColor = this.modules[y][x];\n                    runY = 1;\n                }\n            }\n            result += this.finderPenaltyTerminateAndCount(runColor, runY + padRun, runHistory) * QrCode.PENALTY_N3;\n        }\n\n        // 2*2 blocks of modules having same color\n        for (let y = 0; y < this.size - 1; y++) {\n            for (let x = 0; x < this.size - 1; x++) {\n                const color: boolean = this.modules[y][x];\n                if (color === this.modules[y][x + 1] && color === this.modules[y + 1][x] &&\n                    color === this.modules[y + 1][x + 1]) {\n                    result += QrCode.PENALTY_N2;\n                }\n            }\n        }\n\n        // Balance of black and white modules\n        let black: int = 0;\n        for (const row of this.modules) {\n            for (const color of row) {\n                if (color) {\n                    black++;\n                }\n            }\n        }\n        const total: int = this.size * this.size;  // Note that size is odd, so black/total !== 1/2\n        // Compute the smallest integer k >= 0 such that (45-5k)% <= black/total <= (55+5k)%\n        const k: int = Math.ceil(Math.abs(black * 20 - total * 10) / total) - 1;\n        result += k * QrCode.PENALTY_N4;\n        return result;\n    }\n\n    // Returns an ascending list of positions of alignment patterns for this version number.\n    // Each position is in the range [0,177), and are used on both the x and y axes.\n    // This could be implemented as lookup table of 40 variable-length lists of integers.\n    private getAlignmentPatternPositions(): Array<int> {\n        if (this.version === 1) {\n            return [];\n        } else {\n            const numAlign: int = Math.floor(this.version / 7) + 2;\n            const step: int = (this.version === 32) ? 26 :\n                Math.ceil((this.size - 13) / (numAlign * 2 - 2)) * 2;\n            let result: Array<int> = [6];\n            for (let pos = this.size - 7; result.length < numAlign; pos -= step) {\n                result.splice(1, 0, pos);\n            }\n            return result;\n        }\n    }\n\n    // Can only be called immediately after a white run is added, and\n    // returns either 0, 1, or 2. A helper function for getPenaltyScore().\n    private finderPenaltyCountPatterns(runHistory: Array<int>): int {\n        const n: int = runHistory[1];\n        if (n > this.size * 3) {\n            throw new Error('Assertion error');\n        }\n        const core: boolean = n > 0 && runHistory[2] === n && runHistory[3] === n * 3\n            && runHistory[4] === n && runHistory[5] === n;\n        return (core && runHistory[0] >= n * 4 && runHistory[6] >= n ? 1 : 0)\n             + (core && runHistory[6] >= n * 4 && runHistory[0] >= n ? 1 : 0);\n    }\n\n    // Must be called at the end of a line (row or column) of modules.\n    // A helper function for getPenaltyScore().\n    private finderPenaltyTerminateAndCount(currentRunColor: boolean, currentRunLength: int,\n                                           runHistory: Array<int>): int {\n        if (currentRunColor) {  // Terminate black run\n            QrCode.finderPenaltyAddHistory(currentRunLength, runHistory);\n            currentRunLength = 0;\n        }\n        currentRunLength += this.size;  // Add white border to final run\n        QrCode.finderPenaltyAddHistory(currentRunLength, runHistory);\n        return this.finderPenaltyCountPatterns(runHistory);\n    }\n}\n\n// Appends the given number of low-order bits of the given value\n// to the given buffer. Requires 0 <= len <= 31 and 0 <= val < 2^len.\nfunction appendBits(val: int, len: int, bb: Array<bit>): void {\n    if (len < 0 || len > 31 || val >>> len !== 0) {\n        throw new Error('Value out of range');\n    }\n    for (let i = len - 1; i >= 0; i--) { // Append bit by bit\n        bb.push((val >>> i) & 1);\n    }\n}\n\n// Returns true iff the i'th bit of x is set to 1.\nfunction getBit(x: int, i: int): boolean {\n    return ((x >>> i) & 1) !== 0;\n}\n","import * as React from 'react';\n\nimport { QrCode, Ecc } from '../qrcodegen';\nimport { getColor } from '../theme';\nimport { getInterfaceSettings } from '../storage';\n\ninterface Props {\n    link: string;\n}\n\nclass QRCode extends React.Component<Props, any> {\n    render() {\n        if (this.props.link) {\n            return (\n                <div className=\"qr\">\n                {this.renderCode(this.props.link)}\n                </div>\n            );\n        }\n        return (\n            <div />\n        );\n    }\n\n    private renderCode(text: string): any {\n        let qr = QrCode.encodeText(text, Ecc.HIGH);\n        let border = 1;\n        let width = 2 * border + qr.size;\n        let hw = width / 2;\n        let settings = getInterfaceSettings();\n        let dt: string | undefined = settings.autoSelectTheme ? settings.darkTheme : undefined;\n        let white = getColor(settings.theme, dt, 'qr_bg');\n        let black = getColor(settings.theme, dt, 'qr_fg');\n        let viewbox = `0 0 ${width} ${width}`;\n\n        let parts: string[] = [];\n        for (let y = 0; y < qr.size; y++) {\n            for (let x = 0; x < qr.size; x++) {\n                if (qr.getModule(x, y)) {\n                    parts.push(`M${x + border},${y + border}h1v1h-1z`);\n                }\n            }\n        }\n        return (\n            <svg viewBox={viewbox}>\n                <rect width=\"100%\" height=\"100%\" fill={white}/>\n                <path d={parts.join(' ')} fill={black}/>\n                <circle cx={hw} cy={hw} r={width / 6} stroke={white} strokeWidth={width / 51} fill={white} />\n                <circle cx={hw} cy={hw} r={width / 6 - width / 51} stroke={black} strokeWidth={width / 51} fill={white} />\n                <circle cx={hw} cy={hw} r={width / 17} stroke={black} strokeWidth={width / 51} fill={black} />\n                <circle cx={hw - width / 20} cy={hw - width / 20 - width / 51}\n                r={width / 25} stroke={black} strokeWidth={width / 51} fill={white} />\n            </svg>\n        );\n    }\n}\n\nexport default QRCode;\n","import * as React from 'react';\n\nimport QRCode from './QRCode';\nconst Modal = require('react-bootstrap').Modal;\n\ninterface Props {\n    error: boolean;\n    link: string;\n    closeCallback: () => void;\n    formContractCallback: () => void;\n    enocontract: boolean;\n}\n\nclass ShareModal extends React.Component<Props, any> {\n    constructor(props: Props) {\n        super(props);\n\n        this.closeShareModal = this.closeShareModal.bind(this);\n        this.formContract = this.formContract.bind(this);\n    }\n\n    render() {\n        if (!this.props.error) {\n            let style: any = {};\n            style.margin = '10px 0 0 0';\n            return (\n                <Modal show={true} onHide={this.closeShareModal}>\n                    <Modal.Header closeButton={false}>\n                        <Modal.Title>Share Link Creation Successful</Modal.Title>\n                    </Modal.Header>\n                    <Modal.Body>\n                        <QRCode link={this.props.link}/>\n                        <div className=\"input-group\">\n                            <input type=\"text\" className=\"form-control js-copytextarea\"\n                                value={this.props.link} readOnly={true}/>\n                            <span className=\"input-group-btn\">\n                                <button className=\"btn btn-def-alt\" onClick={this.copyShareLink} type=\"button\">\n                                    <span className=\"glyphicon glyphicon-copy\" />\n                                </button>\n                            </span>\n                        </div>\n                        <p className=\"text-justify\" style={style}>\n                            Use the above link to share your code.<br/>\n                            <b>Attention:</b> The link refers to a read-only version of your code.\n                            To share a modified version of your code, please create a new share link.\n                        </p>\n                    </Modal.Body>\n                    <Modal.Footer>\n                        <button className=\"btn btn-def-alt\" type=\"button\"\n                        onClick={this.closeShareModal}>Close</button>\n                    </Modal.Footer>\n                </Modal>\n            );\n        } else if (this.props.enocontract) {\n            return (\n                <Modal show={true} onHide={this.closeShareModal}>\n                    <Modal.Header closeButton={false}>\n                        <Modal.Title>Share Link Creation Failed</Modal.Title>\n                    </Modal.Header>\n                    <Modal.Body>\n                        Creating a share link for your code failed.<br/>\n                        But I think only other <em>Magical Users</em> have the right to\n                        criticize that.\n                    </Modal.Body>\n                    <Modal.Footer>\n                        <button className=\"btn btn-suc-alt\" type=\"button\"\n                        onClick={this.formContract}>Become a <em>Magical\n                        User</em></button>\n                        <button className=\"btn btn-def-alt\" type=\"button\"\n                        onClick={this.closeShareModal}>Close</button>\n                    </Modal.Footer>\n                </Modal>\n            );\n        } else {\n            return (\n                <Modal show={true} onHide={this.closeShareModal}>\n                    <Modal.Header closeButton={false}>\n                        <Modal.Title>Share Link Creation Failed</Modal.Title>\n                    </Modal.Header>\n                    <Modal.Body>\n                        Creating a share link for your code failed.<br/>\n                        Please try again later.\n                    </Modal.Body>\n                    <Modal.Footer>\n                        <button className=\"btn btn-def-alt\" type=\"button\"\n                        onClick={this.closeShareModal}>Close</button>\n                    </Modal.Footer>\n                </Modal>\n            );\n        }\n    }\n\n    formContract() {\n        this.props.formContractCallback();\n    }\n\n    closeShareModal() {\n        this.props.closeCallback();\n    }\n\n    copyShareLink() {\n        let copyTextarea = document.querySelector('.js-copytextarea') as HTMLTextAreaElement;\n        copyTextarea.select();\n        document.execCommand('copy');\n    }\n}\n\nexport default ShareModal;\n","import * as React from 'react';\n\nconst Modal = require('react-bootstrap').Modal;\n\ninterface Props {\n    closeCallback: () => void;\n    createCallback: () => void;\n}\n\nclass ContractModal extends React.Component<Props, any> {\n    constructor(props: Props) {\n        super(props);\n\n        this.closeShareModal = this.closeShareModal.bind(this);\n        this.createContract = this.createContract.bind(this);\n    }\n\n    render() {\n        return (\n            <Modal show={true} onHide={this.closeShareModal}>\n            <Modal.Header closeButton={false}>\n            <Modal.Title>Form an <em>Agreement</em> with me and become a <em>\n            Magical User</em></Modal.Title>\n            </Modal.Header>\n                <Modal.Body>\n                    If you want others to have an easy way to access your code,\n                    you may form an <em>Agreement</em> with me and become a <em>Magical User</em>.\n                    <br/><br/>\n                    Once you are a <em>Magical User</em> you may upload your code to the servers\n                    of Saarland University.\n                    By uploading a file to the servers of Saarland University, you grant Saarland\n                    University and the <a href=\"https://github.com/SOSML\"> SOSML Developers </a>\n                    a non-exclusive, worldwide, royalty-free, sub-licensable, and transferable\n                    license to use, publish, and create derivative works of your uploaded file.\n                    <br/>\n                    Further, the availability of your uploaded files is not guaranteed.\n                </Modal.Body>\n            <Modal.Footer>\n            <button className=\"btn btn-suc-alt\" onClick={this.createContract} type=\"button\">\n            I accept. Turn me into a <em>Magical User</em></button>\n            <button className=\"btn btn-def-alt\" onClick={this.closeShareModal} type=\"button\">\n            I will decide later.</button>\n            </Modal.Footer>\n            </Modal>\n        );\n    }\n\n    createContract() {\n        this.props.createCallback();\n    }\n\n    closeShareModal() {\n        this.props.closeCallback();\n    }\n}\n\nexport default ContractModal;\n","import * as React from 'react';\nimport './CodeMirrorWrapper.css';\nimport { getInterfaceSettings, InterpreterSettings } from '../storage';\n\nlet CodeMirror: any = require('codemirror');\n\nrequire('codemirror/lib/codemirror.css');\nrequire('../sml.js');\n\n/* imports for code folding */\nrequire('codemirror/addon/fold/foldgutter.js');\nrequire('codemirror/addon/fold/foldcode.js');\nrequire('../sml-fold.js');\nrequire('codemirror/addon/fold/foldgutter.css');\n\nrequire('codemirror/addon/edit/matchbrackets.js');\n\nclass CodeMirrorSubset {\n    cm: any;\n\n    constructor(cm: any) {\n        this.cm = cm;\n    }\n\n    getCode(pos: any): string {\n        return this.cm.getRange(pos, { 'line': this.cm.lineCount() + 1, 'ch': 0 }, '\\n');\n    }\n\n    getValue(): string {\n        return this.cm.getValue();\n    }\n\n    markText(from: any, to: any, style: string) {\n        return this.cm.markText(from, to, {\n            className: style\n        });\n    }\n}\n\nclass IncrementalInterpretationHelper {\n    markers: any;\n    outputCallback: (code: string, complete: boolean) => any;\n    disabled: boolean;\n    worker: Worker;\n    codemirror: CodeMirrorSubset;\n    workerTimeout: any;\n    timeout: number;\n    wasTerminated: boolean;\n    partialOutput: string;\n    interpreterSettings: string | null;\n    initialExtraCode: string | undefined; // Code to be executed before any user code\n    afterExtraCode: string | undefined; // Code to be executed after any user code\n\n    constructor(outputCallback: (code: string, complete: boolean) => any,\n        settings: string | null,\n        initialCode: string | undefined = undefined,\n        afterCode: string | undefined = undefined) {\n        this.interpreterSettings = settings;\n        this.disabled = false;\n        this.outputCallback = outputCallback;\n        this.initialExtraCode = initialCode;\n        this.afterExtraCode = afterCode;\n        this.markers = {};\n\n        this.worker = new Worker(process.env.PUBLIC_URL + '/webworker.js');\n        this.worker.onmessage = this.onWorkerMessage.bind(this);\n        this.workerTimeout = null;\n        this.wasTerminated = true;\n        this.partialOutput = '';\n        this.timeout = 5000;\n    }\n\n    setTimeout(num: number) {\n        this.timeout = num;\n    }\n\n    restartWorker() {\n        this.worker.terminate();\n        this.worker = new Worker(process.env.PUBLIC_URL + '/webworker.js');\n        this.worker.onmessage = this.onWorkerMessage.bind(this);\n    }\n\n    onWorkerMessage(e: any) {\n        let message = e.data;\n        if (message.type === 'getcode') {\n            this.worker.postMessage({\n                type: 'code',\n                data: this.codemirror.getCode(message.data)\n            });\n        } else if (message.type === 'markText') {\n            let data = message.data;\n            let marker = this.codemirror.markText(data.from, data.to, data.style);\n            this.markers[data.id] = marker;\n        } else if (message.type === 'clearMarker') {\n            let id = message.data.id;\n            if (this.markers[id]) {\n                this.markers[id].clear();\n                delete this.markers[id];\n            }\n        } else if (message.type === 'partial') {\n            // this.partialOutput += message.data;\n            // this.partialOutput = \"\\\\1> Hello\";\n            console.log(\"Partial output\", this.partialOutput);\n            this.outputCallback(this.partialOutput, false);\n            this.startTimeout();\n        } else if (message.type === 'ping' || message.type === 'finished') {\n            // The worker is letting us know that he is not dead or finished\n            this.outputCallback(this.partialOutput, true);\n            this.partialOutput = '';\n            if (this.workerTimeout !== null) {\n                clearTimeout(this.workerTimeout);\n                this.workerTimeout = null;\n            }\n        }\n    }\n\n    clear() {\n        this.worker.postMessage({\n            type: 'clear',\n            data: ''\n        });\n    }\n\n    disable() {\n        this.disabled = true;\n        this.clear();\n    }\n\n    enable() {\n        this.disabled = false;\n    }\n\n    handleChangeAt(pos: any, added: string[], removed: string[], codemirror: CodeMirrorSubset) {\n        if (this.disabled) {\n            return;\n        }\n        this.codemirror = codemirror;\n\n\n        let code = codemirror.getValue().trim();\n        const endTag = \";;\";\n        const parts = code.split(endTag).filter((x: string) => x !== '');\n        this.partialOutput = '';\n        let parity = true;\n        for (const part of parts) {\n            let response = \"\";\n            try {\n                // @ts-ignore\n                // response = evaluator.execute(part + endTag);\n                response = execute(part + endTag);\n            } catch (e) {\n                // TODO: try to catch errors from the evaluator\n                // console.log(\"caught error\", e);\n                response = \"\" + e;\n            }\n            if (!response.endsWith(\"\\n\"))\n                response += \"\\n\";\n            this.partialOutput += \"\\\\\" + (parity ? \"1\" : \"2\") + \"> \" + response;\n            this.outputCallback(this.partialOutput, false);\n            parity = !parity;\n        }\n        this.outputCallback(this.partialOutput, true);\n        this.partialOutput = '';\n        if (this.workerTimeout !== null) {\n            clearTimeout(this.workerTimeout);\n            this.workerTimeout = null;\n        }\n        return;\n\n        if (this.wasTerminated) { // Re-evaluate everything\n            added = codemirror.getValue().split('\\n');\n            removed = [];\n            pos = { line: 0, ch: 0 };\n            this.wasTerminated = false;\n            this.worker.postMessage({\n                type: 'settings',\n                data: this.interpreterSettings\n            });\n            if (this.initialExtraCode !== undefined) {\n                if (!getInterfaceSettings().hideBeforeCodeResult) {\n                    this.worker.postMessage({\n                        type: 'initial',\n                        data: this.initialExtraCode\n                    });\n                } else {\n                    this.worker.postMessage({\n                        type: 'initialSilent',\n                        data: this.initialExtraCode\n                    });\n                }\n            }\n            this.worker.postMessage({\n                type: 'afterCode',\n                data: this.afterExtraCode\n            });\n        }\n        this.worker.postMessage({\n            type: 'interpret',\n            data: {\n                'pos': pos,\n                'added': added,\n                'removed': removed,\n            }\n        });\n        this.startTimeout();\n    }\n\n    private startTimeout() {\n        if (this.workerTimeout !== null) {\n            clearTimeout(this.workerTimeout);\n        }\n        this.workerTimeout = setTimeout(() => {\n            this.restartWorker();\n            let out = '';\n            let timeoutStr = 'Execution terminated due to time limit violation';\n            if (this.partialOutput.trim() === '') {\n                out = timeoutStr;\n            } else if (this.partialOutput.endsWith('\\n')) {\n                out = this.partialOutput + timeoutStr;\n            } else {\n                out = this.partialOutput + '\\n' + timeoutStr;\n            }\n            this.outputCallback(out, false);\n            this.workerTimeout = null;\n            this.clearAllMarkers();\n            this.wasTerminated = true;\n            this.partialOutput = '';\n        }, this.timeout + 400);\n    }\n\n    private clearAllMarkers() {\n        for (let key in this.markers) {\n            if (this.markers.hasOwnProperty(key)) {\n                this.markers[key].clear();\n            }\n        }\n        this.markers = {};\n    }\n}\n\nexport interface Props {\n    flex?: boolean;\n    onChange?: (x: string) => void;\n    onFocusChange?: (x: boolean) => void;\n    code: string;\n    readOnly: boolean;\n    outputCallback: (code: string, complete: boolean) => any;\n    timeout: number;\n\n    interpreterSettings?: InterpreterSettings;\n    beforeCode?: string;\n    afterCode?: string;\n}\n\ninterface State {\n    isFocused: boolean;\n}\n\nfunction elt(tag: any, content: any, className: any): any {\n    let e = document.createElement(tag);\n    if (className) {\n        e.className = className;\n    }\n    if (typeof content === 'string') {\n        e.appendChild(document.createTextNode(content));\n    } else if (content) {\n        for (let i = 0; i < content.length; ++i) {\n            e.appendChild(content[i]);\n        }\n    }\n    return e;\n}\n\nclass CodeMirrorWrapper extends React.Component<Props, State> {\n    editor: any;\n    codeMirrorInstance: any;\n    evalHelper: IncrementalInterpretationHelper;\n\n    constructor(props: Props) {\n        super(props);\n\n        if (this.props.interpreterSettings !== undefined) {\n            this.evalHelper = new IncrementalInterpretationHelper(this.props.outputCallback,\n                JSON.stringify(this.props.interpreterSettings),\n                this.props.beforeCode,\n                this.props.afterCode);\n        } else {\n            this.evalHelper = new IncrementalInterpretationHelper(this.props.outputCallback,\n                localStorage.getItem('interpreterSettings'),\n                this.props.beforeCode,\n                this.props.afterCode);\n        }\n\n        this.handleChangeEvent = this.handleChangeEvent.bind(this);\n\n        this.state = {\n            isFocused: false\n        }\n    }\n\n    focus() {\n        if (this.codeMirrorInstance) {\n            this.codeMirrorInstance.focus();\n        }\n    }\n\n    focusChanged(focused: boolean) {\n        this.setState({\n            isFocused: focused,\n        });\n        this.props.onFocusChange && this.props.onFocusChange(focused);\n    }\n\n    render() {\n        this.evalHelper.setTimeout(this.props.timeout);\n        let editorClassName = 'ReactCodeMirror';\n        if (this.props.flex) {\n            editorClassName += ' flexy flexcomponent';\n        }\n        if (this.state.isFocused) {\n            editorClassName += ' ReactCodeMirror--focused';\n        }\n\n        let value = '';\n        if (this.props.code) {\n            value = this.props.code;\n        }\n        return (\n            <div className={editorClassName}>\n                <textarea\n                    ref={(editor: any) => { this.editor = editor; }}\n                    defaultValue={value}\n                    autoComplete=\"off\"\n                />\n            </div>\n        );\n    }\n\n    componentDidUpdate(prevProps: Props, prevState: any) {\n        if (prevProps.readOnly !== this.props.readOnly) {\n            this.codeMirrorInstance.options.readOnly = this.props.readOnly;\n            this.codeMirrorInstance.refresh();\n        }\n        if (prevProps.code !== this.props.code) {\n            if (this.editor) {\n                this.codeMirrorInstance.setValue(this.props.code);\n                if (this.props.onChange) {\n                    this.props.onChange(this.props.code);\n                }\n            }\n        }\n    }\n\n    componentDidMount() {\n        let autoIndent = getInterfaceSettings().autoIndent;\n\n        const options = {\n            lineNumbers: true,\n            mode: 'text/sml',\n            indentUnit: 2,\n            smartIndent: autoIndent,\n            tabSize: 2,\n            matchBrackets: true,\n            lineWrapping: true,\n            inputStyle: 'contenteditable',\n            readOnly: this.props.readOnly ? true : false,\n            foldGutter: {\n                minFoldSize: 2\n            },\n            gutters: [\n                'CodeMirror-linenumbers', 'CodeMirror-foldgutter'\n            ],\n            specialChars: new RegExp('[\\u0000-\\u001f\\u007f-\\u009f\\u00a0\\u00ad'\n                + '\\u061c\\u1680\\u2000-\\u200f\\u2028\\u2029\\u202f'\n                + '\\u205f\\u3000\\ufeff\\ufff9-\\ufffc]'),\n            specialCharPlaceholder: ((ch: any) => {\n                let token = elt('span', ch.charCodeAt(0).toString(16).toUpperCase(),\n                    'cm-label');\n                return token;\n            }),\n            extraKeys: {\n                Enter: ((cm: any) => {\n                    if (!autoIndent) {\n                        cm.replaceSelection('\\n');\n                    } else {\n                        cm.execCommand('newlineAndIndent');\n                    }\n                }),\n                Tab: ((cm: any) => {\n                    if (cm.somethingSelected()) {\n                        return cm.indentSelection('add');\n                    } else {\n                        return CodeMirror.commands.insertSoftTab(cm);;\n                    }\n                }),\n                'Shift-Tab': 'indentLess',\n                'Alt-Tab': 'indentAuto'\n            }\n        };\n\n        this.codeMirrorInstance = CodeMirror.fromTextArea(this.editor, options);\n        this.codeMirrorInstance.on('change', this.handleChangeEvent);\n        this.codeMirrorInstance.on('focus', this.focusChanged.bind(this, true));\n        this.codeMirrorInstance.on('blur', this.focusChanged.bind(this, false));\n\n        this.evalHelper.clear();\n        this.evalHelper.handleChangeAt({ line: 0, ch: 0, sticky: null }, [''], [''],\n            new CodeMirrorSubset(this.codeMirrorInstance));\n    }\n\n    componentWillUnmount() {\n        this.codeMirrorInstance.off('change', this.handleChangeEvent);\n        this.codeMirrorInstance.off('focus', this.focusChanged.bind(this, true));\n        this.codeMirrorInstance.off('blur', this.focusChanged.bind(this, false));\n    }\n\n    /*\n    This is the codemirror change handler\n    */\n    handleChangeEvent(codemirror: any, change: any) {\n        this.evalHelper.handleChangeAt(change.from, change.text, change.removed, new CodeMirrorSubset(codemirror));\n\n        if (this.props.onChange) {\n            this.props.onChange(codemirror.getValue());\n        }\n    }\n}\n\nexport default CodeMirrorWrapper;\n","/*\n\nDefines API used to communicate with the backend server.\n\n*/\n\nimport { WishSeries } from './wishes';\n\nconst LAST_SHARE_TIMEOUT = 15000;\n\nexport class API {\n    static EMULATE: boolean = false;\n    static LAST_SHARE: Date | undefined;\n\n    static shareWish(wish: WishSeries): Promise<string> {\n        if (API.LAST_SHARE !== undefined) {\n            if (new Date().getTime() - API.LAST_SHARE.getTime() <= LAST_SHARE_TIMEOUT) {\n                return Promise.reject('Please wait a little until you try to share again.');\n            }\n        }\n        API.LAST_SHARE = new Date();\n        return fetch('/api/wishare/',\n            {\n                headers: {\n                  'Accept': 'text/plain',\n                  'Content-Type': 'application/json'\n                },\n                method: 'PUT',\n                body: JSON.stringify(wish)\n            }\n        ).then(function(response: any) {\n            if (!response.ok) {\n                return Promise.reject(response.status);\n            } else {\n                return response.text();\n            }\n        });\n    }\n\n    static loadSharedWish(hash: string): Promise<WishSeries> {\n        return fetch('/api/wishare/' + hash,\n            {\n                headers: {\n                  'Accept': 'text/plain',\n                  'Content-Type': 'application/json'\n                },\n                method: 'GET'\n            }\n        ).then(function(response: any) {\n            if (!response.ok) {\n                return Promise.reject(response.status);\n            } else {\n                return response.json();\n            }\n        });\n    }\n\n    static shareCode(code: string): Promise<string> {\n        if (API.LAST_SHARE !== undefined) {\n            if (new Date().getTime() - API.LAST_SHARE.getTime() <= LAST_SHARE_TIMEOUT) {\n                return Promise.reject('Please wait a little until you try to share again.');\n            }\n        }\n        API.LAST_SHARE = new Date();\n        return fetch('/api/share/',\n            {\n                headers: {\n                  'Accept': 'text/plain',\n                  'Content-Type': 'application/json'\n                },\n                method: 'PUT',\n                body: JSON.stringify({'code': code})\n            }\n        ).then(function(response: any) {\n            if (!response.ok) {\n                return Promise.reject(response.status);\n            } else {\n                return response.text();\n            }\n        });\n    }\n\n    static loadSharedCode(hash: string): Promise<string> {\n        return fetch('/api/share/' + hash,\n            {\n                headers: {\n                  'Accept': 'text/plain',\n                  'Content-Type': 'application/json'\n                },\n                method: 'GET'\n            }\n        ).then(function(response: any) {\n            if (!response.ok) {\n                return Promise.reject(response.status);\n            } else {\n                return response.text();\n            }\n        });\n    }\n\n    static getPublicWishList(): Promise<string[]> {\n        return fetch('/api/wishlist/',\n            {\n                headers: {\n                  'Accept': 'text/json',\n                  'Content-Type': 'application/json'\n                },\n                method: 'GET'\n            }\n        ).then(function(response: any) {\n            if (!response.ok) {\n                return Promise.reject(response.status);\n            } else {\n                return response.json();\n            }\n        }).then(function(data: any) {\n            return data.codes.map((name: any) => {\n                return name.replace('.wish.json', '');\n            });\n        });\n    }\n\n    static getPublicWish(name: string): Promise<WishSeries> {\n        return fetch('/api/wish/' + name.replace(/\\//g, '%2F'),\n            {\n                headers: {\n                  'Accept': 'text/plain',\n                  'Content-Type': 'application/json'\n                },\n                method: 'GET'\n            }\n        ).then(function(response: any) {\n            if (!response.ok) {\n                return Promise.reject(response.status);\n            }\n            return response.json();\n        });\n    }\n\n    static getCodeExamplesList(): Promise<string[]> {\n        return fetch('/api/list/',\n            {\n                headers: {\n                  'Accept': 'text/json',\n                  'Content-Type': 'application/json'\n                },\n                method: 'GET'\n            }\n        ).then(function(response: any) {\n            if (!response.ok) {\n                return Promise.reject(response.status);\n            } else {\n                return response.json();\n            }\n        }).then(function(data: any) {\n            return data.codes.map((name: any) => {\n                return name.replace('.sml', '');\n            });\n        });\n    }\n\n    static getCodeExample(name: string): Promise<string> {\n        return fetch('/api/code/' + name.replace(/\\//g, '%2F'),\n            {\n                headers: {\n                  'Accept': 'text/plain',\n                  'Content-Type': 'application/json'\n                },\n                method: 'GET'\n            }\n        ).then(function(response: any) {\n            if (!response.ok) {\n                return Promise.reject(response.status);\n            } else {\n                return response.text();\n            }\n        });\n    }\n}\n","import * as React from 'react';\n\nimport SplitterLayout from './SplitterLayout';\nimport MiniWindow from './MiniWindow';\nimport ShareModal from './ShareModal';\nimport ContractModal from './ContractModal';\nimport CodeMirrorWrapper from './CodeMirrorWrapper';\nimport { Button } from 'react-bootstrap';\nimport './Playground.css';\nimport { API as WebserverAPI } from '../api';\nimport { getColor } from '../theme';\nimport { Database, InterfaceSettings, getInterfaceSettings,\n         InterpreterSettings, getInterpreterSettings } from '../storage';\nimport { SHARING_ENABLED } from '../config';\n\ninterface State {\n    output: string;\n    code: string;\n    sizeAnchor: any;\n    shareLink: string;\n\n    reset: boolean;\n    formContract: boolean;\n    interfaceSettings: InterfaceSettings;\n}\n\ninterface Props {\n    readOnly: boolean;\n    onCodeChange?: (x: string) => void;\n    outputCallback?: (code: string, complete: boolean) => void;\n    onResize?: () => void;\n    initialCode: string;\n    fileControls?: any;\n    onReset?: () => void;\n\n    interpreterSettings?: InterpreterSettings; // special interpreter settings\n    beforeCode?: string; // invisible code that is executed before any user code\n    afterCode?: string; // invisible code that is appended to any user code\n}\n\nconst SHARE_LINK_ERROR = ':ERROR';\nconst SHARE_LINK_ERROR_NO_CONTRACT = ':ERROR_CONTRACT';\nconst OUTPUT_MARKUP_SPECIALS = ['\\\\*', '\\\\_'];\n\nclass Playground extends React.Component<Props, State> {\n    constructor(props: Props) {\n        super(props);\n\n        this.state = {\n            reset: false, output: '', code: '', sizeAnchor: 0,\n            shareLink: '', formContract: false,\n            interfaceSettings: getInterfaceSettings()\n        };\n\n        this.clearCodeWindow = this.clearCodeWindow.bind(this);\n        this.handleLeftResize = this.handleLeftResize.bind(this);\n        this.handleRightResize = this.handleRightResize.bind(this);\n        this.handleCodeChange = this.handleCodeChange.bind(this);\n        this.handleSplitterUpdate = this.handleSplitterUpdate.bind(this);\n        this.handleBrowserResize = this.handleBrowserResize.bind(this);\n        this.handleOutputChange = this.handleOutputChange.bind(this);\n        this.handleShare = this.handleShare.bind(this);\n        this.handleShareWrapper = this.handleShareWrapper.bind(this);\n        this.modalCloseCallback = this.modalCloseCallback.bind(this);\n        this.modalFormContractCallback = this.modalFormContractCallback.bind(this);\n        this.modalCreateContractCallback = this.modalCreateContractCallback.bind(this);\n        this.handleBrowserKeyup = this.handleBrowserKeyup.bind(this);\n    }\n\n    render() {\n        let extraCSS = '';\n        let settings = getInterfaceSettings();\n\n        let interpreterSettings: InterpreterSettings =\n            this.props.interpreterSettings === undefined ? getInterpreterSettings()\n            : this.props.interpreterSettings;\n\n        let dt: string | undefined = settings.autoSelectTheme ? settings.darkTheme : undefined;\n        if (dt === undefined) {\n            extraCSS += '.eval-fail { background-color: '\n            + this.state.interfaceSettings.errorColor + ' !important; }';\n            extraCSS += '.eval-success { background-color: '\n            + this.state.interfaceSettings.successColor1 + ' !important; }';\n            extraCSS += '.eval-success-odd { background-color: '\n            + this.state.interfaceSettings.successColor2 + ' !important; }';\n        } else {\n            extraCSS += '.eval-fail { background-color: '\n            + getColor(settings.theme, dt, 'error') + ' !important; }';\n            extraCSS += '.eval-success { background-color: '\n            + getColor(settings.theme, dt, 'success') + ' !important; }';\n            extraCSS += '.eval-success-odd { background-color: '\n            + getColor(settings.theme, dt, 'success_alt') + ' !important; }';\n        }\n\n\n        let cleanedOutput = this.state.output;\n        if (cleanedOutput.endsWith('\\n')) {\n            cleanedOutput = cleanedOutput.substr(0, cleanedOutput.length - 1);\n        }\n        let lines: string[] = cleanedOutput.split('\\n');\n        var key = 0;\n        var markingColor = 0;\n        let lineItems: JSX.Element[] = [];\n        lines.map((line) => {\n            let data: [JSX.Element, number, number] = this.parseLine(line, key++, markingColor);\n            if (markingColor !== data[1] && data[2] > interpreterSettings.showUsedTimeWhenAbove\n               && interpreterSettings.showUsedTimeWhenAbove > -1) {\n                let excTime = (\n                    <pre style={{padding: 0, display: 'inline', margin: 0, borderRadius: 0,\n                        fontSize: '70%', float: 'right', border: '0'}}\n                    className={this.getHighlightForColor(data[1])} key={key + '@time'}>\n                    {' ' + data[2] + 'ms'}\n                    </pre>\n                );\n                lineItems.push(excTime);\n            }\n            markingColor = data[1];\n            lineItems.push(data[0]);\n            return 0;\n        });\n        let code: string = this.props.initialCode;\n\n        if (this.state.reset) {\n            code = '';\n            // This is a hacky solution to reset the editor, needs to be done properly\n            this.setState({reset: false});\n        }\n\n        let modal: JSX.Element | undefined;\n        if (this.state.shareLink !== '') {\n            if (this.state.formContract) {\n                modal = (\n                    <ContractModal closeCallback={this.modalCloseCallback}\n                        createCallback={this.modalCreateContractCallback}/>\n                );\n            } else {\n                modal = (\n                    <ShareModal error={this.state.shareLink === SHARE_LINK_ERROR\n                        || this.state.shareLink === SHARE_LINK_ERROR_NO_CONTRACT}\n                        link={this.state.shareLink} closeCallback={this.modalCloseCallback}\n                        enocontract={this.state.shareLink === SHARE_LINK_ERROR_NO_CONTRACT}\n                        formContractCallback={this.modalFormContractCallback}/>\n                );\n            }\n        }\n        let spacer: JSX.Element | undefined = (\n                <div className=\"miniSpacer\" />\n            );\n        let shareElements: JSX.Element | undefined;\n        if (!this.props.readOnly && SHARING_ENABLED) {\n            shareElements = (\n                <Button size=\"sm\" className=\"btn btn-pri-alt\" onClick={this.handleShareWrapper}>\n                <div className=\"glyphicon glyphicon-link\" /> Share\n                </Button>\n            );\n        }\n        let resetBtn: JSX.Element | undefined;\n        if (this.props.onReset !== undefined) {\n            resetBtn = (\n                         <Button size=\"sm\" className=\"button btn-dng-alt\"\n                         onClick={this.clearCodeWindow}>\n                            <span className=\"glyphicon glyphicon-repeat\" /> Reset\n                         </Button>\n                        );\n        }\n\n\n        let style: any = {};\n        style.marginRight = '-3px';\n        style.marginTop = '-.5px';\n        let inputHeadBar: JSX.Element = (\n            <div className=\"inlineBlock\" style={style}>\n                {resetBtn}\n                {this.props.onReset !== undefined\n                    && this.props.fileControls !== undefined ? spacer : ''}\n                {this.props.fileControls}\n                {spacer}\n                {shareElements}\n            </div>\n        );\n\n\n        let width = (window.innerWidth > 0) ? window.innerWidth : window.screen.width;\n        let height = (window.innerHeight > 0) ? window.innerHeight : window.screen.height;\n\n        let codemirror = (\n            <div className=\"flexcomponent flexy\">\n                <MiniWindow content={(\n                    <CodeMirrorWrapper flex={true}\n                    onChange={this.handleCodeChange} code={code}\n                    readOnly={this.props.readOnly} outputCallback={this.handleOutputChange}\n                    interpreterSettings={this.props.interpreterSettings}\n                    beforeCode={this.props.beforeCode}\n                    afterCode={this.props.afterCode}\n                    timeout={this.state.interfaceSettings.timeout} />\n                )} header={(\n                    <div className=\"headerButtons\">\n                        {inputHeadBar}\n                    </div>\n                )} title=\"SML\" className=\"flexy\" updateAnchor={this.state.sizeAnchor} />\n            </div>\n        );\n        let output = (\n            <div className=\"flexcomponent flexy\">\n                <MiniWindow content={\n                    <div>\n                        {lineItems}\n                    </div>\n                } title=\"Output\" className=\"flexy\" updateAnchor={this.state.sizeAnchor}/>\n            </div>\n        );\n\n        let isVertical = width < height && getInterfaceSettings().useMobile;\n        return (\n            <div className=\"playground\">\n                <style>{extraCSS}</style>\n                <SplitterLayout vertical={isVertical}\n                    onUpdate={this.handleSplitterUpdate} primaryIndex={0}\n                    percentage={true}>\n                    {codemirror}\n                    {output}\n                </SplitterLayout>\n                {modal}\n            </div>\n        );\n    }\n\n    modalCloseCallback() {\n        this.setState({\n            shareLink: '',\n            formContract: false\n        });\n    }\n\n    modalFormContractCallback() {\n        this.setState({\n            formContract: true\n        });\n    }\n\n    modalCreateContractCallback() {\n        this.setState({\n            formContract: false,\n            shareLink: ''\n        });\n\n        if (this.state.interfaceSettings.userContributesEnergy !== undefined) {\n            // eslint-disable-next-line\n            this.state.interfaceSettings.userContributesEnergy = true;\n            localStorage.setItem('interfaceSettings',\n                                 JSON.stringify(this.state.interfaceSettings));\n        }\n        this.handleShare(true);\n    }\n\n    componentDidMount() {\n        window.addEventListener('resize', this.handleBrowserResize, {passive: true});\n        window.addEventListener('keyup', this.handleBrowserKeyup, {passive: true});\n\n        let settings: InterfaceSettings = getInterfaceSettings();\n        this.setState({'interfaceSettings': settings});\n\n        if (settings.fullscreen) {\n            this.getBodyClassList().add('fullscreen');\n        }\n    }\n\n    componentWillUnmount() {\n        window.removeEventListener('resize', this.handleBrowserResize);\n        window.removeEventListener('keyup', this.handleBrowserKeyup);\n        this.getBodyClassList().remove('fullscreen');\n    }\n\n    handleSplitterUpdate(sizeAnchor: any) {\n        this.setState({sizeAnchor});\n    }\n\n    handleLeftResize() {\n        // Block is empty!\n    }\n\n    handleRightResize() {\n        // Block is empty?\n    }\n\n    handleBrowserResize() {\n        if (this.state.sizeAnchor === -2) {\n            this.setState({sizeAnchor: -1});\n        } else {\n            this.setState({sizeAnchor: -2});\n        }\n        if (this.props.onResize) {\n            this.props.onResize();\n        }\n    }\n\n    handleBrowserKeyup(evt: KeyboardEvent) {\n        let newval: boolean = false;\n        if (evt.key === 'Escape') {\n            this.getBodyClassList().remove('fullscreen');\n            newval = false;\n        } else if (evt.key === 'F11') {\n            // Toggle the fullscreen mode\n            if (this.getBodyClassList().contains('fullscreen')) {\n                this.getBodyClassList().remove('fullscreen');\n                newval = false;\n            } else {\n                this.getBodyClassList().add('fullscreen');\n                newval = true;\n            }\n        }\n\n        if (this.state.interfaceSettings.fullscreen !== undefined) {\n            // eslint-disable-next-line\n            this.state.interfaceSettings.fullscreen = newval;\n            localStorage.setItem('interfaceSettings',\n                                 JSON.stringify(this.state.interfaceSettings));\n        }\n    }\n\n    handleCodeChange(newCode: string) {\n        this.setState(prevState => {\n            return {code: newCode};\n        });\n        if (this.props.onCodeChange) {\n            this.props.onCodeChange(newCode);\n        }\n    }\n\n    handleOutputChange(newOutput: string, complete: boolean) {\n        if (!complete) {\n            this.setState(prevState => {\n                let ret: any = {output: newOutput};\n                return ret;\n            });\n        }\n        if (this.props.outputCallback !== undefined) {\n            this.props.outputCallback(newOutput, complete);\n        }\n    }\n\n    handleShareWrapper() {\n        this.handleShare(false);\n    }\n\n    handleShare(forceAllow: boolean = false) {\n        if (this.state.interfaceSettings.userContributesEnergy || forceAllow) {\n            // We have the user's soul, so we can get \"energy\"\n            WebserverAPI.shareCode(this.state.code).then((hash) => {\n                this.setState(prevState => {\n                    return {shareLink: window.location.host + '/share/' + hash};\n                });\n\n                // Store the share file locally\n                Database.getInstance().then((db: Database) => {\n                    return db.saveShare(hash, this.state.code, true);\n                });\n            }).catch(() => {\n                this.setState({shareLink: SHARE_LINK_ERROR});\n            });\n        } else {\n            this.setState({shareLink: SHARE_LINK_ERROR_NO_CONTRACT});\n        }\n    }\n\n    private clearCodeWindow() {\n        this.setState({reset: true});\n        this.render();\n        if (this.props.onReset !== undefined) {\n            this.props.onReset();\n        }\n    }\n\n    private getBodyClassList() {\n        let body = document.getElementsByTagName('body')[0];\n        return body.classList;\n    }\n\n    private getHighlightForColor(markingColor: number): string {\n        switch (markingColor) {\n            case 1:\n                return 'eval-success';\n            case 2:\n                return 'eval-success-odd';\n            case 3:\n                return 'eval-fail';\n            default:\n                break;\n        }\n        return '';\n    }\n\n    // parses \\1, \\2, \\3 marks and formatting; returns [parsed line, new color, execution\n    // time]\n    private parseLine(line: string, key: number,\n                      markingColor: number): [JSX.Element, number, number] {\n        let start = 0;\n        let executionTime = -1;\n        let items: any[] = [];\n\n        if (line.startsWith('@')) { // time marks have the form @time@<rest of the line>\n            line = line.substring(1);\n            let ed = line.indexOf('@');\n            if (ed >= 0 && ed < line.length) {\n                executionTime = +line.substr(0, ed);\n                line = line.substr(ed + 1);\n            } else {\n                line = '@' + line;\n            }\n        }\n        if (line.startsWith('\\\\1')) {\n            line = line.substring(2);\n            markingColor = 1;\n        } else if (line.startsWith('\\\\2')) {\n            line = line.substring(2);\n            markingColor = 2;\n        } else if (line.startsWith('\\\\3')) {\n            line = line.substring(2);\n            markingColor = 3;\n        }\n\n        // Make sure spaces in strings are non-breakable\n        line = line.replaceAll(' ', ' '); // second space is nbsp\n\n        while (true) {\n            // eslint-disable-next-line\n            let indexList = OUTPUT_MARKUP_SPECIALS.map((x: string) => {\n                return line.indexOf(x, start);\n            });\n            let index = indexList[0];\n            let ii = 0;\n            for (let i = 0; i < indexList.length; i++) {\n                if (indexList[i] !== -1 && (indexList[i] < index || index === -1)) {\n                    index = indexList[i];\n                    ii = i;\n                }\n            }\n            if (index !== -1) {\n                let current = OUTPUT_MARKUP_SPECIALS[ii];\n                let before = line.substring(start, index);\n                if (before.length > 0) {\n                    items.push(before.replace(/\\\\\\\\/g, '\\\\'));\n                }\n                let next = line.indexOf(current, index + 2);\n                if (next === -1) {\n                    next = line.length - 1;\n                }\n                let content = line.substring(index + 2, next)\n                    .replace(/\\\\\\\\/g, '\\\\');\n                if (current === '\\\\*') {\n                    items.push(<b key={start}>{content}</b>);\n                } else {\n                    items.push(<i key={start}>{content}</i>);\n                }\n                start = next + 2;\n            } else {\n                let after = line.substring(start);\n                if (after.length > 0) {\n                    items.push(after.replace(/\\\\\\\\/g, '\\\\'));\n                }\n                break;\n            }\n        }\n        let addClass = 'pre-reset ';\n        if (this.state.interfaceSettings.outputHighlight) {\n            addClass += this.getHighlightForColor(markingColor);\n        }\n        if (items.length === 0) {\n            return [(\n                <pre className={addClass} key={line + (key++)}>\n                    <div className=\"miniSpacer\" />\n                </pre>\n            ), markingColor, executionTime];\n        } else {\n            return [(\n                <pre className={addClass} key={line + (key++)} style={{overflow: 'visible'}}>\n                    {items}\n                </pre>\n            ), markingColor, executionTime];\n        }\n    }\n}\n\nexport default Playground;\n","import * as React from 'react';\n\nimport Playground from './Playground';\nimport { Form , Alert, Button } from 'react-bootstrap';\nimport { API } from '../api';\nimport { getColor } from '../theme';\nimport { getInterfaceSettings, Database, getTabId, setTabId,\n         getLastCachedFile, setLastCachedFile } from '../storage';\nimport './Editor.css';\nimport { PIPELINE_ID } from './Version';\n\nconst FEEDBACK_NONE = 0;\nconst FEEDBACK_SUCCESS = 1;\nconst FEEDBACK_FAIL = 2;\n\nlet fileInCache: string | undefined = undefined;\n\ninterface State {\n    shareReadMode: boolean;\n    shareHash: string;\n    code: string;\n    initialCode: string;\n    fileName: string;\n    savedFeedback: number;\n    savedFeedbackTimer: any;\n    error: string;\n    width: number;\n    requiredVersion: number;\n}\n\nclass Editor extends React.Component<any, State> {\n    constructor(props: any) {\n        super(props);\n\n        let width = (window.innerWidth > 0) ? window.innerWidth : window.screen.width;\n        let height = (window.innerHeight > 0) ? window.innerHeight : window.screen.height;\n        this.state = {\n            shareReadMode: false,\n            code: '',\n            fileName: '',\n            initialCode: '',\n            shareHash: '',\n            savedFeedback: FEEDBACK_NONE,\n            savedFeedbackTimer: null,\n            error: '',\n            width: (height > width ? width : width / 2),\n            requiredVersion: -1,\n        };\n\n        this.onResize = this.onResize.bind(this);\n        this.handleCodeChange = this.handleCodeChange.bind(this);\n        this.handleFileNameChange = this.handleFileNameChange.bind(this);\n        this.handleRedirectToEdit = this.handleRedirectToEdit.bind(this);\n        this.handleSave = this.handleSave.bind(this);\n        this.handleFormSubmit = this.handleFormSubmit.bind(this);\n    }\n\n    extractVersion(code: string): number {\n        let versionRegex = /^\\(\\*.*SOSML>=(\\d{1,8}).*\\*\\)/i;\n        if (code.search(versionRegex) !== -1) {\n            let res = code.match(versionRegex);\n            if (res !== null && res['1'] !== null) {\n                return +(res['1']);\n            }\n        }\n        return -1;\n    }\n\n    componentDidMount() {\n        if (this.props.location && this.props.location.search) {\n            let parts = this.props.location.search.split(/[?|&]/);\n            let dfn = decodeURI(this.props.location.search.substr(2 + parts[1].length));\n\n            if (parts.length < 2 || isNaN(+parts[1])) {\n                // Not a valid GRFSD, don't do anything\n                return;\n            }\n\n            let tabId = +parts[1];\n            setTabId(tabId);\n            let fileName = tabId + '/' + dfn;\n\n            Database.getInstance().then((db: Database) => {\n                return db.getFile(fileName, true);\n            }).then((content: string) => {\n                this.setState((oldState) => {\n                    return {initialCode: content, fileName: dfn,\n                        requiredVersion: this.extractVersion(content)};\n                });\n            });\n            return;\n        }\n\n        if (this.props.history && this.props.history.location.state) {\n            let state: any = this.props.history.location.state;\n\n            if (state.fileName) {\n                let promise: Promise<String>;\n                if (state.example) {\n                    promise = API.getCodeExample(state.fileName);\n                } else {\n                    promise = Database.getInstance().then((db: Database) => {\n                        return db.getFile(state.fileName);\n                    });\n                }\n                promise.then((content: string) => {\n                    this.setState((oldState) => {\n                        return {initialCode: content, fileName: state.fileName,\n                                shareReadMode: state.shareReadMode,\n                                shareHash: state.shareReadMode ? state.fileName : undefined,\n                                requiredVersion: this.extractVersion(content)};\n                    });\n                });\n                return;\n            } else if (state.shareHash) {\n                Database.getInstance().then((db: Database) => {\n                    return db.getFile(state.shareHash, false, true);\n                }).then((content: string) => {\n                    this.setState((oldState) => {\n                        return {initialCode: content, fileName: state.shareHash,\n                            shareReadMode: false, requiredVersion: this.extractVersion(content)};\n                    });\n                }).catch((error: any) => {\n                    API.loadSharedCode(state.shareHash).then((content: string) => {\n                        this.setState((oldState) => {\n                            return {initialCode: content,\n                                requiredVersion: this.extractVersion(content)};\n                        });\n\n                        // Cache the shared file as it does not yet exist\n                        Database.getInstance().then((db: Database) => {\n                            return db.saveShare(state.shareHash, content, false);\n                        });\n                    }).catch((error: any) => {\n                        this.setState({'error': error});\n                    });\n                });\n                return;\n            }\n        }\n        if (this.props.match && this.props.match.params && this.props.match.params.hash) {\n            // got redirected from a /share/:hash link\n\n            let shareName = this.props.match.params.hash;\n            Database.getInstance().then((db: Database) => {\n                return db.getFile(shareName, false, true);\n            }).then((content: string) => {\n                this.setState((oldState) => {\n                    return {initialCode: content, shareReadMode: true, shareHash: shareName,\n                        requiredVersion: this.extractVersion(content)};\n                });\n            }).catch((error: any) => {\n                API.loadSharedCode(shareName).then((content: string) => {\n                    this.setState((oldState) => {\n                        return {initialCode: content, shareReadMode: true, shareHash: shareName,\n                            requiredVersion: this.extractVersion(content)};\n                    });\n\n                    // Cache the shared file as it does not yet exist\n                    Database.getInstance().then((db: Database) => {\n                        return db.saveShare(shareName, content, false);\n                    });\n                }).catch((error: any) => {\n                    this.setState({'error': error});\n                });\n            });\n            return;\n        }\n\n        let lfic = getLastCachedFile();\n        if (fileInCache !== undefined || lfic !== undefined) {\n            let fileName: string = '';\n            let pfileName: string = '';\n            if (fileInCache !== undefined) {\n                fileName = fileInCache;\n                pfileName = getTabId() + '/' + fileInCache;\n            } else if (lfic !== undefined) {\n                fileName = lfic.substr(lfic.indexOf('/') + 1);\n                pfileName = lfic;\n            }\n\n            Database.getInstance().then((db: Database) => {\n                return db.getFile(pfileName, true);\n            }).then((content: string) => {\n                this.setState((oldState) => {\n                    return {initialCode: content, fileName: fileName,\n                        requiredVersion: this.extractVersion(content)};\n                });\n            });\n            return;\n        }\n    }\n\n    render() {\n        let topBar: any;\n        let errorBar: any = '';\n        let fileForm: any;\n\n        if (this.state.requiredVersion > +PIPELINE_ID) {\n            errorBar = (\n                <Alert variant=\"danger\" style={{margin: '0 3px 3px'}}>\n                    <b>Warning: </b>\n                    The current code requires at least version {this.state.requiredVersion} of\n                    SOSML. It may not work correctly in your version of SOSML\n                    (version {+PIPELINE_ID}).\n                    <div className=\"miniSpacer\" />\n                </Alert>\n            );\n        }\n\n        if (this.state.error) {\n            errorBar = (\n                <Alert variant=\"danger\" style={{margin: '0 3px 3px'}}>\n                    <b>Error: </b>\n                    The specified file was not found.\n                    <div className=\"miniSpacer\" />\n                    <Button className=\"button btn-dng-alt\" onClick={(evt: any) => {\n                        this.setState({error: ''});\n                    }}>Dismiss</Button>\n                </Alert>\n            );\n        }\n\n        if (this.state.shareReadMode) {\n            topBar = (\n                <Alert variant=\"info\" style={{margin: '0 3px 3px'}}>\n                    <b>Warning: </b>\n                    You are viewing a read-only file.\n                    <div className=\"miniSpacer\" />\n                    <Button className=\"button btn-suc-alt\" onClick={this.handleRedirectToEdit}>Create\n                    an editable copy</Button>\n                </Alert>\n            );\n        } else {\n            let style: any = {};\n            let settings = getInterfaceSettings();\n            let dt: string | undefined = settings.autoSelectTheme ? settings.darkTheme : undefined;\n\n            if (this.state.savedFeedback === FEEDBACK_SUCCESS) {\n                style.backgroundColor = getColor(settings.theme, dt, 'success');\n            } else if (this.state.savedFeedback === FEEDBACK_FAIL) {\n                style.backgroundColor = getColor(settings.theme, dt, 'error');\n            }\n            style.maxWidth = this.state.width - 220;\n\n            fileForm = (\n                <Form inline={true} className=\"inlineBlock\" onSubmit={this.handleFormSubmit}>\n                    <input className=\"form-control\" type=\"text\"\n                        value={this.state.fileName} onChange={this.handleFileNameChange}\n                        style={style} placeholder=\"File name\"/>\n                    <Button size=\"sm\" className=\"button btn-pri-alt\" onClick={this.handleSave}>\n                        <span className=\"glyphicon glyphicon-file\" /> Store\n                    </Button>\n                </Form>\n            );\n        }\n        return (\n            <div className=\"flexy flexcomponent\">\n                {errorBar}\n                {topBar}\n                <Playground readOnly={this.state.shareReadMode} onCodeChange={this.handleCodeChange}\n                    onResize={this.onResize} initialCode={this.state.initialCode}\n                    fileControls={fileForm}  />\n            </div>\n        );\n    }\n\n    handleFormSubmit(e: any) {\n        e.preventDefault();\n        this.handleSave();\n    }\n\n    handleRedirectToEdit() {\n        this.props.history.push('/editor', {shareHash: this.state.shareHash});\n    }\n\n    handleFileNameChange(evt: any) {\n        let name = evt.target.value;\n        this.setState(prevState => {\n            return {fileName: name};\n        });\n    }\n\n    restartFeedbackClear(feedback: number) {\n        if (this.state.savedFeedbackTimer !== null) {\n            clearTimeout(this.state.savedFeedbackTimer);\n        }\n        let timer = setTimeout(() => {\n            this.setState({savedFeedback: FEEDBACK_NONE, savedFeedbackTimer: null});\n        }, 1300);\n        this.setState({savedFeedback: feedback, savedFeedbackTimer: timer});\n    }\n\n    handleSave() {\n        let fileName = this.state.fileName.trim();\n        if (fileName !== '') {\n            Database.getInstance().then((db: Database) => {\n                return db.saveFile(fileName, this.state.code);\n            }).then(() => {\n                this.restartFeedbackClear(FEEDBACK_SUCCESS);\n            }).catch(() => {\n                this.restartFeedbackClear(FEEDBACK_FAIL);\n            });\n        } else {\n            this.restartFeedbackClear(FEEDBACK_FAIL);\n        }\n    }\n\n    handleCodeChange(newCode: string) {\n        if (this.state.shareReadMode) {\n            return;\n        }\n        this.setState(prevState => {\n            return {code: newCode, requiredVersion: this.extractVersion(newCode)};\n        });\n\n        this.props.history.replace('/editor?' + getTabId() + '&' + this.state.fileName);\n\n        Database.getInstance().then((db: Database) => {\n            return db.saveFile(getTabId() + '/' + this.state.fileName,\n                               this.state.code, true);\n        });\n\n        fileInCache = this.state.fileName;\n        setLastCachedFile(getTabId() + '/' + fileInCache);\n    }\n\n    onResize() {\n        if (this.state.shareHash === undefined) {\n            this.setState(prevState => {\n                return {initialCode: prevState.code};\n            });\n        }\n        let width = (window.innerWidth > 0) ? window.innerWidth : window.screen.width;\n        let height = (window.innerHeight > 0) ? window.innerHeight : window.screen.height;\n        if (height <= width) {\n            this.setState({width: width / 2});\n        } else {\n            this.setState({width: width});\n        }\n    }\n}\n\nexport default Editor;\n","import * as React from 'react';\n\nimport { OverlayTrigger, Tooltip } from 'react-bootstrap';\n\nimport { getInterfaceSettings } from '../storage';\nimport { getColor } from '../theme';\n\ninterface Props {\n    children: any[]; // Buttons, etc to appea on the top left\n    fileName?: string;\n    iconName: string; // glyphicon name used as an icon for this file (default: file)\n    onClick?: any;\n    bottomBorder?: boolean; // show/hide the bottom border line\n};\n\nclass FileListItem extends React.Component<Props, any> {\n    public static defaultProps = {\n        children: [],\n        fileName: undefined,\n        iconName: 'file',\n        onClick: undefined,\n        bottomBorder: true,\n    };\n\n    render() {\n        let settings = getInterfaceSettings();\n        let dt: string | undefined = settings.autoSelectTheme ? settings.darkTheme : undefined;\n\n        let style4: any = {};\n        style4.padding = '2.5px';\n        let style2: any = {};\n        style2.borderTop = '1px solid ' + getColor(settings.theme, dt, 'border');\n        style2.borderRight = '1px solid ' + getColor(settings.theme, dt, 'border');\n        if (this.props.bottomBorder) {\n            style2.borderBottom = '1px solid ' + getColor(settings.theme, dt, 'border');\n        }\n        style2.whiteSpace = 'nowrap';\n        style2.textAlign = 'right';\n        style2.verticalAlign = 'top';\n        style2.fontFamily = 'monospace';\n        style2.cursor = 'pointer';\n        let style: any = {};\n        style.borderTop = '1px solid ' + getColor(settings.theme, dt, 'border');\n        style.borderLeft = '1px solid ' + getColor(settings.theme, dt, 'border');\n        if (this.props.bottomBorder) {\n            style.borderBottom = '1px solid ' + getColor(settings.theme, dt, 'border');\n        }\n        style.whiteSpace = 'nowrap';\n        style.overflow = 'hidden';\n        style.textOverflow = 'ellipsis';\n        style.maxWidth = '8em';\n        style.verticalAlign = 'bottom';\n        style.fontFamily = 'monospace';\n        style.cursor = 'pointer';\n\n        if (this.props.fileName === undefined) {\n            return (\n                <tr className=\"no-hover\">\n                    <td style={style4}/>\n                    <td style={style4}/>\n                </tr>\n            );\n        }\n\n        let printName = this.props.fileName as string;\n        let tooltip = (\n            <Tooltip id={'tooltip@file' + printName}>\n                {printName}\n            </Tooltip>\n        );\n\n        let space = (\n            <div className=\"miniSpacer\" />\n        );\n\n        let glicon = this.props.iconName;\n\n        return (\n            <tr>\n                <td style={style} onClick={this.props.onClick}>\n                    <OverlayTrigger overlay={tooltip}>\n                        <div className={'glyphicon glyphicon-' + glicon} />\n                    </OverlayTrigger>\n                    {space}\n                    {printName}\n                </td>\n                <td style={style2} onClick={this.props.onClick}>\n                    {this.props.children}\n                </td>\n            </tr>\n        );\n    }\n}\n\nexport default FileListItem;\n","import * as React from 'react';\n\nimport { Button } from 'react-bootstrap';\n\ninterface Props {\n    children: any; // Buttons, etc to appea on the top left\n    iconName: string; // glyphicon name used as an icon for this file (default: file)\n    onClick?: any;\n    btnType: string; // type of the button (dng [default] {red}, pri {blue}, suc {green})\n    disabled: boolean;\n};\n\nclass FileListButton extends React.Component<Props, any> {\n    public static defaultProps = {\n        children: [],\n        onClick: undefined,\n        btnType: 'dng',\n        iconName: 'trash',\n        disabled: false,\n    };\n\n    render() {\n        let style3: any = {};\n        style3.marginTop = '-8.8px';\n        style3.marginRight = '-9px';\n        style3.marginLeft = '8px';\n        style3.cursor = 'pointer';\n\n        return (\n            <Button size=\"sm\" className={'button btn-' + this.props.btnType + '-alt'}\n                onClick={this.props.onClick} style={style3} disabled={this.props.disabled}>\n                <span className={'glyphicon glyphicon-' + this.props.iconName} /> {this.props.children}\n            </Button>\n        );\n    }\n}\n\nexport default FileListButton;\n","import * as React from 'react';\n\nimport { Fade } from 'react-bootstrap';\n\nimport { getInterfaceSettings } from '../storage';\nimport { getColor } from '../theme';\n\nimport FileListItem from './FileListItem';\nimport FileListButton from './FileListButton';\n\ninterface Props {\n    children: any[]; // rendered files in the folder\n    headerButtons: any[]; // additional buttons after the open/close button\n    folderName?: string;\n    onClick?: any; // handler to open / close the folder\n    isOpened: boolean; // children are only visible if the folder is opened\n    keyHint: number | string;\n    openCloseButtonText: string; // Text to be shown after the \"Hide\"/\"Show\"\n    description?: any; // optional description for the folder\n};\n\nclass FileListFolder extends React.Component<Props, any> {\n    public static defaultProps = {\n        children: [],\n        headerButtons: [],\n        fileName: undefined,\n        onClick: undefined,\n        isOpened: false,\n    };\n\n    render() {\n        let folderState = this.props.isOpened;\n        let settings = getInterfaceSettings();\n        let dt: string | undefined = settings.autoSelectTheme ? settings.darkTheme : undefined;\n\n        let style5: any = {};\n        style5.borderRight = '1px solid ' + getColor(settings.theme, dt, 'border');\n        style5.borderLeft = '1px solid ' + getColor(settings.theme, dt, 'border');\n        if (!folderState) {\n            style5.borderBottom = '1px solid ' + getColor(settings.theme, dt, 'border');\n        }\n        let style4: any = {};\n        style4.borderRight = '1px solid ' + getColor(settings.theme, dt, 'border');\n        style4.borderLeft = '1px solid ' + getColor(settings.theme, dt, 'border');\n        style4.borderBottom = '1px solid ' + getColor(settings.theme, dt, 'border');\n        style4.borderTop = 'none';\n\n        let result: any[] = [];\n        result.push(\n            <FileListItem bottomBorder={!folderState || (this.props.description !== undefined)}\n                iconName={folderState ? 'folder-open' : 'folder-close'}\n                onClick={this.props.onClick}\n                fileName={this.props.folderName === undefined ? '' : this.props.folderName}\n                key={this.props.keyHint + '@header1'}>\n                <FileListButton btnType=\"suc\" key={this.props.keyHint + '@th1'}\n                    onClick={this.props.onClick}\n                    iconName={folderState ? 'folder-close' : 'folder-open'}>\n                        {(folderState ? 'Hide ' : 'Show ') + this.props.openCloseButtonText}\n                </FileListButton>\n                {this.props.headerButtons}\n            </FileListItem>\n        );\n        if (this.props.description !== undefined) {\n            result.push(\n                <tr key={this.props.keyHint + 't@01'} className=\"no-hover\">\n                    <td colSpan={2} style={style5}>\n                        {this.props.description}\n                    </td>\n                </tr>\n            );\n        }\n        result.push(\n            <Fade key={this.props.keyHint + '@fade1'} in={folderState} unmountOnExit={true} timeout={10}>\n                <tr key={this.props.keyHint + '@t1'} className=\"no-hover\">\n                    <td colSpan={2} style={style4} key={this.props.keyHint + '@td0'}>\n                        <div key={this.props.keyHint + '@d1'}>\n                        {this.props.children}\n                        </div>\n                    </td>\n                </tr>\n            </Fade>\n        );\n        return result;\n    }\n}\n\nexport default FileListFolder;\n","import * as React from 'react';\n\nimport { Container, Table } from 'react-bootstrap';\nimport { API } from '../api';\nimport { SAMPLE_FILES_ENABLED, SHARING_ENABLED } from '../config';\nimport ShareModal from './ShareModal';\nimport { displayName, getInterfaceSettings, File, FileType, Database } from '../storage';\nimport FileListItem from './FileListItem';\nimport FileListFolder from './FileListFolder';\nimport FileListButton from './FileListButton';\n\nconst FileSaver = require('file-saver');\n\nconst EXAMPLES_LOADING = 0;\nconst EXAMPLES_LOADED = 1;\nconst EXAMPLES_FAILED = 2;\n\nconst MINIMODE_LB = 450;\n\ninterface State {\n    files: File[];\n    shares: File[];\n    examples: File[];\n    examplesStatus: number;\n    shareLink: string;\n    folder: any;\n    miniMode: boolean;\n}\n\nclass Files extends React.Component<any, State> {\n    constructor(props: any) {\n        super(props);\n\n        this.state = {\n            files: [],\n            shares: [],\n            examples: [],\n            examplesStatus: EXAMPLES_LOADING,\n            shareLink: '',\n            folder: {},\n            miniMode: false\n        };\n\n        this.modalCloseCallback = this.modalCloseCallback.bind(this);\n        this.handleBrowserResize = this.handleBrowserResize.bind(this);\n    }\n\n    componentDidMount() {\n        this.refreshFiles();\n        let width = (window.innerWidth > 0) ? window.innerWidth : window.screen.width;\n        this.setState({miniMode: (width < MINIMODE_LB)});\n        window.addEventListener('resize', this.handleBrowserResize, {passive: true});\n    }\n\n    componentWillUnmount() {\n        window.removeEventListener('resize', this.handleBrowserResize);\n    }\n\n    render() {\n        let modal: JSX.Element | undefined;\n        if (this.state.shareLink !== '') {\n            modal = (\n                <ShareModal error={false}\n                    link={this.state.shareLink} closeCallback={this.modalCloseCallback}\n                    enocontract={false} formContractCallback={this.modalCloseCallback}/>\n            );\n        }\n\n\n        if (this.state.files.length === 0) {\n            return (\n                <Container className=\"flexy\">\n                    <h2>Files</h2>\n                    <hr/>\n                    <h4>Local Files</h4>\n                    <p>\n                        Files saved from the editor will appear here.\n                    </p>\n                    {this.renderShares()}\n                    {this.renderExamples()}\n                    {modal}\n                    <br/> <br/>\n                </Container>\n            );\n        }\n\n        let collator = new Intl.Collator(undefined, {numeric: true, sensitivity: 'base'});\n        let files = this.deepCopy(this.state.files);\n        files.sort((f1: File, f2: File) => {\n            return collator.compare(displayName(f1), displayName(f2));\n        });\n\n        return (\n            <Container className=\"flexy\">\n                    <h2>Files</h2>\n                    <hr/>\n                    <h4>Local Files</h4>\n                    <p>\n                    You can find your saved files here.\n                        Click on a file to load it into the editor.\n                    </p>\n                    {this.renderFileList(files)}\n                    {this.renderShares()}\n                    {this.renderExamples()}\n                    {modal}\n                    <br/> <br/>\n            </Container>\n        );\n    }\n\n    modalCloseCallback() {\n        this.setState({\n            shareLink: ''\n        });\n    }\n\n    private handleBrowserResize() {\n        let nwidth = (window.innerWidth > 0) ? window.innerWidth : window.screen.width;\n        this.setState({miniMode: (nwidth < MINIMODE_LB)});\n    }\n\n    private renderShares() {\n        if (!SHARING_ENABLED) {\n            return '';\n        }\n\n        let sharesView: any[] = [];\n        sharesView.push(\n            <br key=\"s@1\"/>\n        );\n        sharesView.push(\n            <h4 key=\"s@2\">Shared Files</h4>\n        );\n        sharesView.push(\n            <p key=\"s@3\">Below you can find the share links you created\n            (denoted by <span className=\"glyphicon glyphicon-upload\"/>), as well\n            as external share links you opened (denoted by <span className=\"glyphicon glyphicon-download\" />).\n                Click on a file to view it in the editor.\n            </p>\n        );\n\n        let collator = new Intl.Collator(undefined, {numeric: true, sensitivity: 'base'});\n        let shares = this.deepCopy(this.state.shares);\n\n        if (shares.length === 0) {\n            return '';\n        }\n\n        shares.sort((f1: File, f2: File) => {\n            return collator.compare(displayName(f1), displayName(f2));\n        });\n\n        sharesView.push(\n            <div key=\"s@4\">\n                {this.renderFileList(shares)}\n            </div>\n        );\n        return sharesView;\n    }\n\n    private renderExamples() {\n        if (!SAMPLE_FILES_ENABLED) {\n            return '';\n        }\n\n        let examplesView: any[] = [];\n        examplesView.push(\n            <br key=\"1\"/>\n        );\n        examplesView.push(\n            <h4 key=\"2\">Sample Files</h4>\n        );\n        if (this.state.examplesStatus === EXAMPLES_LOADED) {\n            let examples = this.renderFileList(this.state.examples);\n\n            if (this.state.examples.length === 0) {\n                examplesView.push(\n                    <p key=\"3\">There is no such thing as a sample file.</p>\n                );\n            } else {\n                examplesView.push(\n                    <Table key=\"3\" hover={true}>\n                        <tbody>\n                            {examples}\n                        </tbody>\n                    </Table>\n                );\n            }\n        } else if (this.state.examplesStatus === EXAMPLES_FAILED) {\n            examplesView.push(\n                <p key=\"3\">Sample files unavailable.</p>\n            );\n        } else {\n            examplesView.push(\n                <p key=\"3\">Loading sample files…</p>\n            );\n        }\n\n        return examplesView;\n    }\n\n    private renderFileList(files: File[], prefix: string = ''): any {\n        let style: any = {};\n        style.textAlign = 'center';\n        let filesView: any[] = [];\n\n        let currentFolder: File[] = [];\n        let currentFolderName: string = '';\n\n        for (let i = 0; i < files.length; ++i) {\n            // If filename starts with '<string>/', render it as part of a folder\n            let currentName = displayName(files[i]).substr(prefix.length).split('/');\n            if (currentName.length > 1 && currentName[0] !== '') {\n                let newFolder = currentName[0];\n                if (currentFolderName === newFolder) {\n                    currentFolder.push(files[i]);\n                } else {\n                    if (currentFolderName !== '') {\n                        if (currentFolder.length > 1) {\n                            filesView.push(this.renderFolder(currentFolderName,\n                                                             currentFolder, i - 1, prefix));\n                        } else {\n                            filesView.push(this.renderFile(currentFolder[0], i - 1, prefix));\n                        }\n                        filesView.push(this.renderFile(undefined, files.length + i - 1));\n                    }\n                    currentFolder = [files[i]];\n                    currentFolderName = newFolder;\n                }\n                continue;\n            } else if (currentFolder.length > 0) {\n                if (currentFolder.length > 1) {\n                    filesView.push(this.renderFolder(currentFolderName,\n                                                     currentFolder, i - 1, prefix));\n                } else {\n                    filesView.push(this.renderFile(currentFolder[0], i - 1, prefix));\n                }\n                filesView.push(this.renderFile(undefined, files.length + i - 1));\n                currentFolder = [];\n                currentFolderName = '';\n            }\n\n            filesView.push(this.renderFile(files[i], i, prefix));\n            if (i < files.length - 1) {\n                filesView.push(this.renderFile(undefined, files.length + i));\n            }\n        }\n        if (currentFolder.length > 0) {\n            if (currentFolder.length > 1) {\n                if (currentFolder.length === files.length && prefix !== '') {\n                    // Folder only contains subfolder\n                    return undefined;\n                }\n                filesView.push(this.renderFolder(currentFolderName,\n                                                 currentFolder, files.length - 1, prefix));\n            } else {\n                filesView.push(this.renderFile(currentFolder[0], files.length - 1, prefix));\n            }\n        }\n\n        return (\n            <Table hover={true}>\n                <tbody>\n                    {filesView}\n                </tbody>\n            </Table>\n        );\n    }\n\n    private renderFolder(name: string, files: File[], key: number, prefix: string = ''): any {\n        let renderedFiles = this.renderFileList(files, prefix + name + '/');\n        if (renderedFiles === undefined) {\n            // Folder contains only a single subfolder\n            let newPrefix = displayName(files[0]).substr(prefix.length).split('/')[1];\n            return this.renderFolder(name + '/' + newPrefix, files, key, prefix);\n        }\n\n        let folderState: boolean = this.state.folder[prefix + name + files[0].type];\n\n        let headerButtons: any[] = [];\n        if (files.length >= 1 && files[0].type !== FileType.SERVER) {\n            let space = (\n                <div className=\"miniSpacer\" key={key + '@fhead1'}/>\n            );\n            let deleteBtn = (\n                <FileListButton iconName=\"trash\" key={key + '@fhead2'} onClick={this.deleteHandlerForAll(files)}>\n                    {this.state.miniMode ? '' : (files.length >= 1 && files[0].type\n                        === FileType.SHARE ? \"Forget All\" : \"Delete All\")}\n                </FileListButton>\n            );\n            headerButtons.push(space);\n            headerButtons.push(deleteBtn);\n        }\n\n        return (\n            <FileListFolder isOpened={folderState} folderName={name}\n                onClick={this.toggleFolder(prefix + name + files[0].type)}\n                headerButtons={headerButtons}\n                keyHint={key} key={key} openCloseButtonText={files.length + ' Files'}>\n                {renderedFiles}\n            </FileListFolder>\n        );\n    }\n\n    private renderFile(file: File | undefined, key: number, prefix: string = '') {\n        if (file === undefined) {\n            return (\n                <FileListItem key={key} />\n            );\n        }\n\n        let printName = displayName(file).substr(prefix.length);\n        let space = (\n            <div className=\"miniSpacer\" />\n        );\n        let deleteBtn = (\n            <FileListButton onClick={this.deleteHandlerFor(file.name)}>\n                {this.state.miniMode ? \"\" : \"Delete\"}\n            </FileListButton>\n        );\n        let forgetBtn = (\n            <FileListButton onClick={this.deleteHandlerFor(file.name, true)}>\n                {this.state.miniMode ? \"\" : \"Forget\"}\n            </FileListButton>\n        );\n        let linkBtn = (\n            <FileListButton iconName=\"link\" btnType=\"pri\" onClick={this.linkHandlerFor(file)}>\n                {this.state.miniMode ? \"\" : \"Link\"}\n            </FileListButton>\n        );\n\n        let glicon = 'file';\n        if (file.type === FileType.SHARE) {\n            glicon = 'download';\n\n            if (file.info !== undefined && file.info.origin !== undefined\n                && file.info.origin === FileType.LOCAL) {\n                glicon = 'upload';\n            }\n        }\n\n        return (\n            <FileListItem key={key} onClick={this.openHandlerFor(file)} iconName={glicon}\n                fileName={printName}>\n                <FileListButton btnType=\"suc\" onClick={this.openHandlerFor(file)}\n                    iconName={(file.type === FileType.SHARE ? 'search' : 'pencil')}>\n                        {this.state.miniMode ? \"\" : (file.type === FileType.SHARE ? \"View\" : \"Edit\")}\n                </FileListButton>\n                {file.type === FileType.SHARE ? space : ''}\n                {file.type === FileType.SHARE ? linkBtn : ''}\n                <div className=\"miniSpacer\" />\n                <FileListButton btnType=\"pri\" iconName=\"download-alt\"\n                    onClick={this.downloadHandlerFor(file)}>\n                    {this.state.miniMode ? \"\" : \"Save\"}\n                </FileListButton>\n                {file.type !== FileType.SERVER ? space : ''}\n                {file.type === FileType.LOCAL ? deleteBtn : ''}\n                {file.type === FileType.SHARE ? forgetBtn : ''}\n            </FileListItem>\n        );\n    }\n\n    private refreshFiles() {\n        if (SAMPLE_FILES_ENABLED) {\n            Database.getInstance().then((db: Database) => {\n                return db.getFiles(getInterfaceSettings().showHiddenFiles, true);\n            }).then((data: File[]) => {\n                this.setState({files: data.filter((f: File) => f.type !== FileType.SHARE)});\n                this.setState({shares: data.filter((f: File) => f.type === FileType.SHARE)});\n                return API.getCodeExamplesList();\n            }).then((list: string[]) => {\n                let collator = new Intl.Collator(undefined, {numeric: true, sensitivity: 'base'});\n                list.sort(collator.compare);\n\n                this.setState({examples: list.map((file) => {\n                    return {\n                        'name': file,\n                        'info': '',\n                        'type': FileType.SERVER\n                    };\n                }), examplesStatus: EXAMPLES_LOADED});\n            }).catch((e) => {\n                this.setState({examplesStatus: EXAMPLES_FAILED});\n            });\n        } else {\n            Database.getInstance().then((db: Database) => {\n                return db.getFiles(getInterfaceSettings().showHiddenFiles, true);\n            }).then((data: File[]) => {\n                this.setState({files: data.filter((f: File) => f.type !== FileType.SHARE)});\n                this.setState({shares: data.filter((f: File) => f.type === FileType.SHARE)});\n            });\n        }\n    }\n\n    private deepCopy(json: any): any {\n        return JSON.parse(JSON.stringify(json));\n    }\n\n    private toggleFolder(folderName: string): (evt: any) => void {\n        return (evt: any) => {\n            this.setState((oldState) => {\n                let deepCopy: any = this.deepCopy(oldState);\n                deepCopy.folder[folderName] = !deepCopy.folder[folderName];\n                return deepCopy;\n            });\n            evt.stopPropagation();\n        };\n    }\n\n    private linkHandlerFor(file: File): (evt: any) => void {\n        return (evt: any) => {\n            this.setState({\n                shareLink: window.location.origin + '/share/' + file.name\n            });\n            evt.stopPropagation();\n        };\n    }\n\n    private openHandlerFor(file: File): (evt: any) => void {\n        if (file.type === FileType.SHARE) {\n            return (evt: any) => {\n                this.props.history.push('/share/' + file.name);\n                evt.stopPropagation();\n            };\n        }\n        return (evt: any) => {\n            this.props.history.push('/editor', {fileName: file.name,\n                                    example: file.type === FileType.SERVER});\n            evt.stopPropagation();\n        };\n    }\n\n    private downloadHandlerFor(file: File): (evt: any) => void {\n        return (evt: any) => {\n            let promise: any;\n            if (file.type !== FileType.SERVER) {\n                promise = Database.getInstance().then((db: Database) => {\n                    return db.getFile(file.name, false, file.type === FileType.SHARE);\n                });\n            } else {\n                promise = API.getCodeExample(file.name);\n            }\n\n            promise.then((content: string) => {\n                let blob = new Blob([content], {type: 'text/plain;charset=utf-8'});\n                file.name += '.sml';\n                FileSaver.saveAs(blob, file.name);\n            });\n            evt.stopPropagation();\n        };\n    }\n\n    private deleteHandlerFor(fileName: string, isShare: boolean = false): (evt: any) => void {\n        return (evt: any) => {\n            Database.getInstance().then((db: Database) => {\n                return db.deleteFile(fileName, false, isShare);\n            }).then((ok: boolean) => {\n                if (ok) {\n                    this.refreshFiles();\n                }\n            });\n            evt.stopPropagation();\n        };\n    }\n\n    private deleteHandlerForAll(files: File[]): (evt: any) => void {\n        return (evt: any) => {\n            files.forEach((file: File) => {\n                Database.getInstance().then((db: Database) => {\n                    return db.deleteFile(file.name, false, file.type === FileType.SHARE);\n                });\n            });\n            this.refreshFiles();\n            evt.stopPropagation();\n        };\n    }\n}\n\nexport default Files;\n","import { InterpreterSettings, ExternalWish /*, WishType */ } from '../storage';\n\n// import WISH_HOWTO from './0_howto.wish.json';\n// import WISH_SHOML from './1_shoml.wish.json';\n// import WISH_CHUUML from './2_chuuml.wish.json';\n\nexport interface InterpretationField {\n    interpreterSettings?: InterpreterSettings;\n    beforeCode?: string[]; // code to be executed before any user-entered code\n    userDefaultCode?: string[]; // default code displayed\n    afterCode?: string[]; // code used to check the user's input for correctness\n}\n\nexport interface WishPart {\n    description: string[];\n    code: InterpretationField;\n}\n\nexport interface Wish {\n    name: string; // Name of the wish\n    prerequisites: string[]; // names of the wishes that should be completed before this wish\n    parts: WishPart[];\n}\n\nexport interface WishSeries {\n    id: string;\n    name: string;\n    shortName: string;\n    description: string[];\n    wishes: Wish[];\n}\n\nexport let DEFAULT_WISHES: [WishSeries, ExternalWish][] = [\n//    [WISH_HOWTO, {fileName: '0_howto', wishType: WishType.LOCAL_DEFAULT}],\n//    [WISH_SHOML, {fileName: '1_shoml', wishType: WishType.LOCAL_DEFAULT}],\n//    [WISH_CHUUML, {fileName: '2_chuuml', wishType: WishType.LOCAL_DEFAULT}],\n];\n","import * as React from 'react';\nimport { InterfaceSettings, getInterfaceSettings, WishType } from '../storage';\n\nconst Modal = require('react-bootstrap').Modal;\n\nexport interface WishNotification {\n    wishName: string;\n    isNewWish: boolean;\n    wishType: WishType;\n    error?: any;\n}\n\ninterface Props {\n    closeCallback: (needsReload: boolean) => void;\n    notification: WishNotification;\n}\n\nexport class WishNotificationModal extends React.Component<Props, any> {\n    needsReload: boolean;\n\n    constructor(props: Props) {\n        super(props);\n\n        this.closeWishNoticicationModal = this.closeWishNoticicationModal.bind(this);\n    }\n\n    componentDidMount() {\n        if (this.props.notification.isNewWish) {\n            // unhide the wish interface\n            let ise: InterfaceSettings = getInterfaceSettings();\n            this.needsReload = ise.wishingHidden;\n            ise.wishingHidden = false;\n            localStorage.setItem('interfaceSettings', JSON.stringify(ise));\n        }\n    }\n\n    render() {\n        if (!this.props.notification.error) {\n            let style: any = {};\n            style.margin = '10px 0 0 0';\n\n            return (\n                <Modal show={true} onHide={this.closeWishNoticicationModal}>\n                    <Modal.Header closeButton={false}>\n                        <Modal.Title>Wish Import Successful</Modal.Title>\n                    </Modal.Header>\n                    <Modal.Body>\n                        <p className=\"text-justify\" style={style}>\n                        {this.props.notification.isNewWish ?\n                            'The wish \"' + this.props.notification.wishName\n                            + '\" was imported successfully.'\n                        : 'The wish \"' + this.props.notification.wishName\n                            + '\" is already imported.'\n                        }\n                        </p>\n                    </Modal.Body>\n                    <Modal.Footer>\n                        <button className=\"btn btn-def-alt\" type=\"button\"\n                        onClick={this.closeWishNoticicationModal}>Close</button>\n                    </Modal.Footer>\n                </Modal>\n            );\n        } else {\n            console.log(this.props.notification.error);\n            return (\n                <Modal show={true} onHide={this.closeWishNoticicationModal}>\n                    <Modal.Header closeButton={false}>\n                        <Modal.Title>Wish Import Failed</Modal.Title>\n                    </Modal.Header>\n                    <Modal.Body>\n                        While trying to import the wish, an error occured.\n                    </Modal.Body>\n                    <Modal.Footer>\n                        <button className=\"btn btn-def-alt\" type=\"button\"\n                        onClick={this.closeWishNoticicationModal}>Close</button>\n                    </Modal.Footer>\n                </Modal>\n            );\n        }\n    }\n\n    closeWishNoticicationModal() {\n        this.props.closeCallback(this.needsReload);\n    }\n}\n\nexport default WishNotificationModal;\n","import * as React from 'react';\n\nimport Playground from './Playground';\nimport { Button, Container, Table } from 'react-bootstrap';\nimport { API } from '../api';\nimport { SAMPLE_WISHES_ENABLED /*, WISHARING_ENABLED */ } from '../config';\nimport { Database, ExternalWish, WishType, getWishStatus, setWishStatus, getWishDownloaded,\n         setWishDownloaded } from '../storage';\nimport { WishPart, Wish, WishSeries, DEFAULT_WISHES } from '../wishes';\n\nimport FileListItem from './FileListItem';\nimport FileListFolder from './FileListFolder';\nimport FileListButton from './FileListButton';\n\nimport { WishNotification, WishNotificationModal } from './WishNotificationModal';\nconst Modal = require('react-bootstrap').Modal;\n// const FileSaver = require('file-saver');\n\nconst WISHES_LOADING = 0;\nconst WISHES_LOADED = 1;\nconst WISHES_FAILED = 2;\n\nconst MINIMODE_LB = 768;\n\nconst TEST_START_STRING = '--- Checking your solution ---';\nconst TEST_COMPLETE_STRING = '--- All checks passed. Part complete! ---';\n\ninterface State {\n    wishes: [WishSeries, ExternalWish][]; // wish series shipped with SOSML-frontend\n    localWishes: [WishSeries, ExternalWish][]; // wishes saved in the browser\n\n    externalWishes: ExternalWish[]; // names of wish files available on the server\n    externalWishesStatus: number;\n    miniMode: boolean; // shrink everything on small screens\n    folder: any;\n\n    initialCode: string | undefined;\n    code: string | undefined;\n    wishSeries: WishSeries | undefined; // currently opened wish series\n    wish: Wish | undefined; // currently opened Wish\n    wishPart: number | undefined; // currently opened wish part\n    wishPartSolved: boolean | undefined; // true if the user solved the current part\n    wishPartNotification: boolean | undefined; // show a notification for\n\n    wishNotification: WishNotification | undefined; // notification that a wishare link was successful\n}\n\nclass Wishes extends React.Component<any, State> {\n    constructor(props: any) {\n        super(props);\n\n        this.state = {\n            wishes: DEFAULT_WISHES,\n            localWishes: [],\n            externalWishes: [],\n            externalWishesStatus: WISHES_LOADING,\n            miniMode: false,\n            folder: {},\n\n            initialCode: undefined,\n            code: undefined,\n            wishSeries: undefined,\n            wish: undefined,\n            wishPart: undefined,\n            wishPartSolved: undefined,\n            wishPartNotification: undefined,\n\n            wishNotification: undefined,\n        };\n\n        this.notificationCloseCallback = this.notificationCloseCallback.bind(this);\n        this.markCurrentTaskSolved = this.markCurrentTaskSolved.bind(this);\n        this.checkWishComplete = this.checkWishComplete.bind(this);\n        this.onWishCodeChange = this.onWishCodeChange.bind(this);\n        this.handleBrowserResize = this.handleBrowserResize.bind(this);\n        this.handleResetWish = this.handleResetWish.bind(this);\n    }\n\n    componentDidMount() {\n        let width = (window.innerWidth > 0) ? window.innerWidth : window.screen.width;\n        this.setState({miniMode: (width < MINIMODE_LB)});\n        this.refreshExternalWishes();\n        window.addEventListener('resize', this.handleBrowserResize, {passive: true});\n\n        if (this.props.history && this.props.history.location.state) {\n            let state: any = this.props.history.location.state;\n\n            if (state.wish && state.wishPart) {\n                this.setState({wish: state.wish, wishPart: state.wishPart});\n            }\n        }\n\n        if (this.props.match && this.props.match.params && this.props.match.params.hash) {\n            // got redirected from a /wishare/:hash link\n            let shareName = this.props.match.params.hash;\n\n            Database.getInstance().then((db: Database) => {\n                return db.getWish(shareName);\n            }).then((content: [WishSeries, WishType, any]) => {\n                this.setState((oldState) => {\n                    return {\n                        wishNotification: {\n                            wishName: shareName,\n                            wishType: content[1],\n                            isNewWish: false\n                        }\n                    }\n                });\n            }).catch((error: any) => {\n                API.loadSharedWish(shareName).then((content: WishSeries) => {\n                    this.setState((oldState) => {\n                        return {\n                            wishNotification: {\n                                wishName: shareName,\n                                wishType: WishType.SHARE,\n                                isNewWish: true\n                            }\n                        }\n                    });\n\n                    // Cache the shared file as it does not yet exist\n                    Database.getInstance().then((db: Database) => {\n                        return db.saveWish(shareName, content, WishType.SHARE);\n                    });\n                }).catch((error: any) => {\n                    this.setState({\n                        wishNotification: {\n                            wishName: shareName,\n                            wishType: WishType.SHARE,\n                            isNewWish: false,\n                            error: error\n                        }\n                    });\n                });\n            });\n        }\n    }\n\n    componentWillUnmount() {\n        window.removeEventListener('resize', this.handleBrowserResize);\n    }\n\n    render() {\n        let collator = new Intl.Collator(undefined, {numeric: true, sensitivity: 'base'});\n        let wishes = this.deepCopy(this.state.wishes);\n        wishes.sort((q1: WishSeries, q2: WishSeries) => {\n            return collator.compare(q1.id, q2.id);\n        });\n        let localWishes = this.deepCopy(this.state.localWishes);\n        localWishes.sort((q1: WishSeries, q2: WishSeries) => {\n            return collator.compare(q1.id, q2.id);\n        });\n\n        let notification: JSX.Element | undefined;\n        if (this.state.wishNotification !== undefined) {\n            // there is some notification to be shown\n            notification = (\n                <WishNotificationModal closeCallback={this.notificationCloseCallback}\n                    notification={this.state.wishNotification} />\n            );\n        }\n\n        if (this.state.wishSeries === undefined\n            || this.state.wish === undefined || this.state.wishPart === undefined) {\n            // User is not currently working on a wish\n            return (\n                <Container className=\"flexy\">\n                        <h2>Wishes</h2>\n                        <hr/>\n                        {this.renderWishList(wishes)}\n                        <h4>Local Wishes</h4>\n                        <p>\n                        {localWishes.length === 0\n                            ? \"Wishes stored locally in your browser will appear here.\"\n                            : \"You can find the wishes that you downloaded from the server here.\"}\n                        </p>\n                        {this.renderWishList(localWishes)}\n                        {this.renderExternalWishes()}\n                        <br/> <br/>\n                        {notification}\n                </Container>\n            );\n        } else {\n            // Render the current wish (part)\n            return (\n                <Container key={this.state.wish.name + '@' + this.state.wishPart} className=\"flexy\">\n                        {this.state.wishPartNotification ?\n                            this.renderWishPartCompleted(this.state.wishSeries,\n                                                         this.state.wish,\n                                                         this.state.wishPart) : ''}\n                        <h2><span style={{fontSize: 'smaller'}}>{this.state.wishSeries.name}\n                        :</span> {this.state.wish.name}</h2>\n                        <hr/>\n                        {this.renderWishProgress(this.state.wishSeries, this.state.wish,\n                                                 this.state.wishPart)}\n                        <br/>\n                        {this.renderCurrentWish(this.state.wishSeries, this.state.wish,\n                                                this.state.wishPart)}\n                        <br/> <br/>\n                </Container>\n            );\n        }\n    }\n\n    notificationCloseCallback(needsReload: boolean) {\n        this.setState((oldState) => {\n            return {\n                wishNotification: undefined\n            }\n        });\n        this.props.history.push('/wishes/');\n        if (needsReload) {\n            window.location.reload();\n        }\n    }\n\n    isWishCompleted(wishSeries: WishSeries, wish: Wish) {\n        return getWishStatus(wishSeries.id, wish.name) >= wish.parts.length;\n    }\n\n    private renderWishPartCompleted(wishSeries: WishSeries, wish: Wish, part: number): any {\n        // Shows a modal informing the user that they completed a (part of a) wish for the\n        // first time.\n        // Also informs about the current progress in the current wish and has a button to\n        // the next part / wish\n\n        let headerText = 'Your Wish Has Not Yet Been Granted';\n        let nxtbtn: any = (\n            <button className=\"btn btn-suc-alt\" type=\"button\"\n            onClick={this.openHandlerFor(wishSeries, wish, part + 1)}\n            >I Wish to Proceed</button>\n        );\n        let nxtbody: any = (\n            <Modal.Body>\n                Congratulations! You successufully completed\n                Part {part + 1} of this Wish.<br/>\n                But there is more: {wish.parts.length - part - 1} more\n                part{wish.parts.length - part === 1 ? '' : 's'} await you!\n            </Modal.Body>\n        );\n\n        if (wish.parts.length === part + 1) {\n            headerText = 'A Part of Your Wish Has Been Fulfilled';\n            nxtbtn = (\n                <button className=\"btn btn-suc-alt\" type=\"button\"\n                onClick={(evt) => {this.setState({wishSeries: undefined, wish: undefined,\n                    wishPart: undefined})}}>Return to the Wishes Overview</button>\n            );\n            nxtbody = (\n                <Modal.Body>\n                    Congratulations! You successfully completed all tasks of this Wish.<br/>\n                    Check out the Wishes Overview to find new Wishes to work on!\n                </Modal.Body>\n            );\n        }\n\n        return (\n            <Modal show={true} onHide={() => { this.setState({wishPartNotification: false}); } }>\n                <Modal.Header closeButton={false}>\n                    <Modal.Title>{headerText}</Modal.Title>\n                </Modal.Header>\n                {nxtbody}\n                <Modal.Footer>\n                    <button className=\"btn btn-def-alt\" type=\"button\"\n                    onClick={() => {this.setState({wishPartNotification: false});}}>Dismiss</button>\n                    {nxtbtn}\n                </Modal.Footer>\n            </Modal>\n        );\n    }\n\n    private renderWishProgress(wishSeries: WishSeries, wish: Wish, part: number): any {\n        let qnbtn: any[] = [];\n        let partsCompleted = getWishStatus(wishSeries.id, wish.name);\n\n        let space = (key: number) => { return (\n                <div key={'wpr@spacer@' + key} className=\"miniSpacer\" />\n            );\n        };\n        qnbtn.push(\n            <span key={'lbl'} style={{fontFamily: 'monospace'}}>\n                Select a Part:\n            </span>\n        );\n        for (let i = 0; i < wish.parts.length; i++) {\n            qnbtn.push(space(i));\n            let btnType = 'button btn-suc-alt';\n            let icon = 'glyphicon-ok-sign'\n            if (i > partsCompleted) {\n                btnType = 'button btn-dng-alt';\n                icon = 'glyphicon-lock'\n            } else if (i === partsCompleted) {\n                btnType = 'button btn-pri-alt';\n                icon = 'glyphicon-exclamation-sign';\n            }\n\n            qnbtn.push(\n                <Button size=\"sm\" className={btnType}\n                    onClick={this.openHandlerFor(wishSeries, wish, i)}\n                    key={'quicknav@b@' + i}\n                    disabled={i > partsCompleted || part === i}>\n                        <div className={'glyphicon ' + icon} />\n                    </Button>\n            );\n        }\n\n        return(\n            <Table>\n            <tbody>\n            <tr>\n                <td style={{border: 'none', padding: 'unset'}}>\n                    <Button size=\"sm\" className=\"button btn-suc-alt\"\n                    onClick={(evt) => {this.setState({wishSeries: undefined, wish: undefined,\n                    wishPart: undefined})}}>\n                        Return to the Wishes Overview\n                    </Button>\n                </td>\n                <td style={{border: 'none', padding: 'unset', textAlign: 'right'}}>\n                    {qnbtn}\n                </td>\n            </tr>\n            </tbody>\n            </Table>\n        );\n    }\n\n    private markCurrentTaskSolved( ): void {\n        if (this.state.wishSeries === undefined\n            || this.state.wish === undefined\n            || this.state.wishPart === undefined) {\n            return;\n        }\n\n        let wishSeriesId = (this.state.wishSeries as WishSeries).id;\n        let wishId = (this.state.wish as Wish).name;\n        let wishPart = (this.state.wishPart as number);\n\n        let wasSolved: boolean = this.state.wishPartSolved === true; // guard against undefined\n        this.setState({\n            wishPartNotification: !wasSolved,\n            wishPartSolved: true\n        });\n\n        if (!wasSolved) {\n            setWishStatus(wishSeriesId, wishId,\n                          Math.max(getWishStatus(wishSeriesId, wishId), wishPart + 1));\n        }\n    }\n\n    private checkWishComplete(output: string, complete: boolean): void {\n        if (!complete) {\n            return;\n        }\n\n        if (output.endsWith('\\n')) {\n            output = output.substr(0, output.length - 1);\n        }\n        let lines: string[] = output.split('\\n');\n\n        // Find the last line that contains the string TEST_START_STRING\n        // (This is were the tests start)\n\n        let teststart = lines.length - 1;\n\n        for (; teststart >= 0; teststart--) {\n            if (lines[teststart].includes(TEST_START_STRING)) {\n                break;\n            }\n        }\n\n        if (teststart < 0) {\n            return;\n        }\n\n        // Check that no errors were encountered after that point\n        for (; teststart < lines.length; ++teststart) {\n            if (lines[teststart].startsWith('\\\\3')) {\n                // Found an error / failed test\n                return;\n            }\n        }\n\n        this.markCurrentTaskSolved( );\n    }\n\n    private renderCurrentWish(wishSeries: WishSeries, wish: Wish, part: number): any {\n        if(part >= wish.parts.length) { return []; }\n\n        let curPart: WishPart = wish.parts[part];\n\n        let res: any[] = [];\n\n        // Description of the current part (containing the task/explanation/etc.)\n        res.push(\n            <div key={wish.name + '@des'}>\n                {this.parseDescriptionString(curPart.description.join(''), wish.name)[0]}\n            </div>\n        );\n        res.push(\n            <br key={wish.name + '@br'}/>\n        );\n\n\n        // Code field\n        res.push(\n            <div className=\"flexy flexcomponent\" style={{minHeight: '500px'}}\n                key={wish.name + '@code@' + this.state.initialCode}>\n                <Playground readOnly={this.state.wishPartNotification === true}\n                onCodeChange={this.onWishCodeChange}\n                initialCode={this.state.initialCode as string}\n                outputCallback={this.checkWishComplete}\n                onReset={this.handleResetWish}\n                interpreterSettings={curPart.code.interpreterSettings}\n                beforeCode={curPart.code.beforeCode === undefined ? undefined :\n                    curPart.code.beforeCode.join('')}\n                afterCode={'\\n local val _ = printLn \"' + TEST_START_STRING + '\" in end; local\\n'\n                    + (curPart.code.afterCode === undefined ? '' : curPart.code.afterCode.join(''))\n                    + '\\n val _ = printLn \"' + TEST_COMPLETE_STRING + '\"; in end;' } />\n            </div>\n        );\n\n        return res;\n    }\n\n    handleResetWish() {\n        if (this.state.wishSeries === undefined\n            || this.state.wish === undefined || this.state.wishPart === undefined) {\n            // There is no code, this method should  not have been called at all...\n            return;\n        }\n\n        let initCode: string = '';\n        if(this.state.wish.parts[this.state.wishPart].code.userDefaultCode !== undefined) {\n            initCode = (this.state.wish.parts[this.state.wishPart].code.userDefaultCode as string[]).join('');\n        }\n\n        this.setState({initialCode: initCode, code: initCode});\n    }\n\n    onWishCodeChange(newCode: string) {\n        if (this.state.wishSeries === undefined\n            || this.state.wish === undefined || this.state.wishPart === undefined) {\n            // There is no code, this method should  not have been called at all...\n            return;\n        }\n\n        this.setState({code: newCode});\n\n        Database.getInstance().then((db: Database) => {\n            return db.saveFile(this.getFileName(this.state.wishSeries as WishSeries,\n                               this.state.wish as Wish,\n                               this.state.wishPart as number), this.state.code as string, true);\n        });\n    }\n\n    private parseDescriptionString(description: string, key: string, endDelim: string = ''): any {\n        if(description === undefined) { return '<undefined>'; }\n\n        let descr: any[] = [];\n\n        let pos = 0;\n        let curpart = \"\";\n        while (pos < description.length) {\n            switch(description[pos]) {\n                case '\\n':\n                    descr.push(<span key={'td@' + key + '@' + pos}>{curpart}</span>);\n                    descr.push(<br key={'tdb@' + key + '@' + pos }/>);\n                    curpart = \"\";\n                    break;\n                case '\\t':\n                    descr.push(<span key={'td@' + key + '@' + pos}>{curpart}</span>);\n                    descr.push(<span key={'tbs@' + key + '@' + pos }>&nbsp;&nbsp;&nbsp;&nbsp;</span>);\n                    curpart = \"\";\n                    break;\n                default:\n                    break;\n            }\n            if (pos + 1 < description.length) {\n                if (description[pos] + description[pos + 1] === endDelim) {\n                    break;\n                }\n                let found = false;\n                switch (description[pos] + description[pos + 1]) {\n                    case '**':\n                    case '__':\n                    case '``':\n                        found = true;\n                        break;\n                    default:\n                        break;\n                }\n                if (found) {\n                    let inner = this.parseDescriptionString(description.substr(pos + 2), key,\n                                description[pos] + description[pos + 1]);\n                    descr.push(<span key={'td@' + key + '@' + pos}>{curpart}</span>);\n                    curpart = \"\";\n                    switch(description[pos] + description[pos + 1]) {\n                    case '**':\n                        descr.push(<b key={'tdbold@' + key + '@' + pos }>{inner[0]}</b>);\n                        break;\n                    case '__':\n                        descr.push(<i key={'tdit@' + key + '@' + pos }>{inner[0]}</i>);\n                        break;\n                    case '``':\n                        descr.push(<code key={'tdcode@' + key + '@' + pos }>{inner[0]}</code>);\n                        break;\n                    default:\n                       break;\n                    }\n                    pos += inner[1] + 4;\n                    continue;\n                }\n            }\n\n            curpart += description[pos];\n            pos++;\n        }\n\n        descr.push(<span key={'td@' + key + '@' + pos}>{curpart}</span>);\n        return [descr, pos];\n    }\n\n    private renderExternalWishes() : any {\n        if (!SAMPLE_WISHES_ENABLED) {\n            return '';\n        }\n\n        let examplesView: any[] = [];\n        examplesView.push(\n            <br key=\"ex@1\"/>\n        );\n        examplesView.push(\n            <h4 key=\"ex@2\">Downloadable Wishes</h4>\n        );\n\n        if (this.state.externalWishesStatus === WISHES_LOADED) {\n            let externalWishes = this.renderExternalWishList(this.state.externalWishes);\n            examplesView.push(externalWishes);\n        } else if (this.state.externalWishesStatus === WISHES_FAILED) {\n            examplesView.push(\n                <p key=\"3\">External wishes unavailable.</p>\n            );\n        } else {\n            examplesView.push(\n                <p key=\"3\">Loading external wishes…</p>\n            );\n        }\n\n        return examplesView;\n    }\n\n    private renderFolder(name: string, shortName: string, description: string[], inner: any,\n                         key: string, wishInfo: ExternalWish): any {\n        let folderState: boolean = this.state.folder[name + key];\n\n        if (description === undefined) {\n            description = [];\n        }\n\n        let desc = (\n            <div key={\"sd@\" + key}>\n                {this.parseDescriptionString(description.join(''), key)[0]}\n            </div>\n        );\n\n        // TODO: show wishInfo\n\n        return (\n            <FileListFolder isOpened={folderState}\n            folderName={this.state.miniMode ? shortName : name}\n            onClick={this.toggleFolder(name + key)}\n            keyHint={key} key={key} openCloseButtonText={'Progress'}\n            description={description.length > 0 ? desc : undefined}>\n                {inner}\n            </FileListFolder>\n        );\n    }\n\n    private renderWish(wishSeries: WishSeries, wish: Wish, key: string): any {\n        let partsCompleted = getWishStatus(wishSeries.id, wish.name);\n\n        let unlocked = true;\n        // a wish is unlocked if all prerequisites are completed\n        for (let i = 0; i < wish.prerequisites.length; ++i) {\n            let pq = wish.prerequisites[i];\n\n            for (let j = 0; j < wishSeries.wishes.length; ++j) {\n                if (wishSeries.wishes[j].name === pq) {\n                    if (!this.isWishCompleted(wishSeries, wishSeries.wishes[j])) {\n                        unlocked = false;\n                    }\n                    break;\n                }\n            }\n            if (!unlocked) { break; }\n        }\n\n        let parts: any[] = [];\n        for (let i = 0; i < wish.parts.length; i++) {\n            if (i > 0) {\n                parts.push(\n                    <div key={'space@' + i} className=\"miniSpacer\" />\n                );\n            }\n            let btnType = 'suc';\n            let icon = 'ok-sign'\n            if (!unlocked || i > partsCompleted) {\n                btnType = 'dng';\n                icon = 'lock'\n            } else if (i === partsCompleted) {\n                btnType = 'pri';\n                icon = 'exclamation-sign';\n            }\n            parts.push(\n                <FileListButton btnType={btnType} onClick={this.openHandlerFor(wishSeries, wish, i)}\n                    key={key + '@b@' + i}\n                    disabled={!unlocked || i > partsCompleted} iconName={icon} />\n            );\n        }\n\n        if (partsCompleted >= wish.parts.length) {\n            partsCompleted = wish.parts.length - 1;\n        }\n\n        return (\n            <Table key={'tbl1@wish@tbl@' + key + '@' + wish.name} hover={true}>\n                <tbody>\n                    <FileListItem key={'tbl1@wish@itm@' + key + '@' + wish.name}\n                        iconName={'exclamation-sign'} fileName={wish.name}\n                        onClick={unlocked ? this.openHandlerFor(wishSeries, wish, partsCompleted)\n                        : undefined}>\n                        {parts}\n                    </FileListItem>\n                    <FileListItem key={key} />\n                </tbody>\n            </Table>\n        );\n    }\n\n    private renderExternalWishList(externalWishList: ExternalWish[]): any {\n        if (externalWishList.length === 0) {\n            return (\n                <p key=\"ex@3\">No external wishes available.</p>\n            );\n        }\n\n        let filesView: any[] = [];\n\n        // For now, no folder support for external wishes\n        for (let i = 0; i < externalWishList.length; ++i ) {\n            let downloaded: boolean = getWishDownloaded(externalWishList[i].fileName);\n\n            let downloadBtn = [(\n                <FileListButton btnType=\"pri\" iconName={downloaded ? 'ok-sign' : 'download'}\n                    disabled={downloaded} onClick={downloaded ? undefined\n                        : this.downloadExternalWish(externalWishList[i])}>\n                    {downloaded ? 'Accepted' : 'Accept'}\n                </FileListButton>\n            )];\n            filesView.push(\n                <FileListItem key={'exwish@' + i}\n                onClick={downloaded ? undefined : this.downloadExternalWish(externalWishList[i])}\n                fileName={externalWishList[i].fileName} iconName={'exclamation-sign'}>\n                    {downloadBtn}\n                </FileListItem>\n            );\n            filesView.push(\n                <FileListItem key={'exwish@a' + i} />\n            );\n        }\n\n        return (\n            <Table hover={true}>\n                <tbody>\n                    {filesView}\n                </tbody>\n            </Table>\n        );\n    }\n\n    private downloadExternalWish(externalWish: ExternalWish): (evt: any) => void {\n        return (evt: any) => {\n            // try to download wish over api\n            API.getPublicWish(externalWish.fileName).then((content: WishSeries) => {\n                Database.getInstance().then((db: Database) => {\n                    // store wish in db\n                    return db.saveWish(externalWish.fileName, content, WishType.SERVER);\n                }).then(() => {\n                    this.refreshStoredWishes();\n                    setWishDownloaded(externalWish.fileName, true);\n                    this.setState((oldState) => {\n                        return {\n                            wishNotification: {\n                                wishName: externalWish.fileName,\n                                wishType: WishType.SERVER,\n                                isNewWish: true\n                            }\n                        }\n                    });\n                }).catch((error: any) => {\n                    this.setState((oldState) => {\n                        return {\n                            wishNotification: {\n                                wishName: externalWish.fileName,\n                                wishType: WishType.SERVER,\n                                isNewWish: false,\n                                error: error\n                            }\n                        }\n                    });\n                    setWishDownloaded(externalWish.fileName, false);\n                });\n            }).catch((error: any) => {\n                this.setState((oldState) => {\n                    return {\n                        wishNotification: {\n                            wishName: externalWish.fileName,\n                            wishType: WishType.SERVER,\n                            isNewWish: false,\n                            error: error\n                        }\n                    }\n                });\n                setWishDownloaded(externalWish.fileName, false);\n            });\n            evt.stopPropagation();\n        };\n    }\n\n    private renderWishList(wishSeries: [WishSeries, ExternalWish][]): any {\n        return wishSeries.map((q: [WishSeries, ExternalWish]) => {\n            return this.renderWishSeries(q[0], q[1]);\n        });\n    }\n\n    private renderWishSeries(wishSeries: WishSeries, wishInfo: ExternalWish): any {\n        let wishes: any[] = wishSeries.wishes !== undefined ? wishSeries.wishes.map((q: Wish) => {\n            return this.renderWish(wishSeries, q, wishSeries.id);\n        }) : [];\n        let style4: any = {};\n        style4.padding = '2.5px';\n        return (\n            <Table key={'tbl1@' + wishSeries.id} hover={true}>\n                <tbody>\n                {this.renderFolder(wishSeries.name, wishSeries.shortName,\n                                   wishSeries.description, wishes, wishSeries.id, wishInfo)}\n                <tr key={'tbl1@pad@' + wishSeries.id} className=\"no-hover\">\n                    <td style={style4}/>\n                    <td style={style4}/>\n                </tr>\n                </tbody>\n            </Table>\n        );\n    }\n\n    private handleBrowserResize() {\n        let nwidth = (window.innerWidth > 0) ? window.innerWidth : window.screen.width;\n        this.setState({miniMode: (nwidth < MINIMODE_LB)});\n    }\n\n    private deepCopy(json: any): any {\n        return JSON.parse(JSON.stringify(json));\n    }\n\n    private toggleFolder(folderName: string): (evt: any) => void {\n        return (evt: any) => {\n            this.setState((oldState) => {\n                let deepCopy: any = this.deepCopy(oldState);\n                deepCopy.folder[folderName] = !deepCopy.folder[folderName];\n                return deepCopy;\n            });\n            evt.stopPropagation();\n        };\n    }\n\n    private getFileName(wishSeries: WishSeries,\n                        wish: Wish, wishPart: number): string {\n        return 'WSH/' + wishSeries.id + '/' + wish.name + '/' + wishPart;\n    }\n\n    private openHandlerFor(wishSeries: WishSeries,\n                           wish: Wish, wishPart: number): (evt: any) => void {\n        return (evt: any) => {\n            this.setState((oldState) => ({\n                wishSeries: wishSeries,\n                wish: wish,\n                wishPart: wishPart,\n                wishPartNotification: false,\n                wishPartSolved: getWishStatus(wishSeries.id, wish.name) > wishPart,\n                initialCode: undefined\n            }));\n\n            Database.getInstance().then((db: Database) => {\n                return db.getFile(this.getFileName(wishSeries, wish, wishPart), true);\n            }).then((content: string) => {\n                this.setState((oldState) => {\n                    return {initialCode: content};\n                });\n            }).catch(err => { });\n            if (this.state.initialCode === undefined) {\n                // User has no code of previous attempts\n                this.setState((oldState) => ({initialCode:\n                              wish.parts[wishPart].code.userDefaultCode === undefined ? ''\n                    : (wish.parts[wishPart].code.userDefaultCode as string[]).join('')}));\n            }\n            evt.stopPropagation();\n        };\n    }\n\n    private refreshStoredWishes() {\n        // update downloaded files\n        Database.getInstance().then((db: Database) => {\n            return db.getWishes();\n        }).then((data: [WishSeries, ExternalWish][]) => {\n            this.setState({localWishes: data});\n        });\n    }\n\n    private refreshExternalWishes() {\n        if (SAMPLE_WISHES_ENABLED) {\n            API.getPublicWishList().then((list: string[]) => {\n                let collator = new Intl.Collator(undefined, {numeric: true, sensitivity: 'base'});\n                list.sort(collator.compare);\n\n                this.setState({externalWishes: list.map((file) => {\n                    return {\n                        'fileName': file,\n                        'wishType': WishType.SERVER\n                    };\n                }), externalWishesStatus: WISHES_LOADED});\n            }).catch((e) => {\n                this.setState({externalWishesStatus: WISHES_FAILED});\n            });\n        }\n        this.refreshStoredWishes();\n    }\n}\n\nexport default Wishes;\n","import * as React from 'react';\nimport { Alert, Container } from 'react-bootstrap';\n\nimport { wishingHidden } from '../storage';\nimport { SHARING_ENABLED } from '../config';\n\nclass Landing extends React.Component<any, any> {\n    constructor(props: any) {\n        super(props);\n\n        this.handleRedirectToEdit = this.handleRedirectToEdit.bind(this);\n        this.handleRedirectToWishes = this.handleRedirectToWishes.bind(this);\n    }\n\n    handleRedirectToEdit() {\n        this.props.history.replace('/editor', {});\n    }\n\n    handleRedirectToWishes() {\n        this.props.history.replace('/wishes', {});\n    }\n\n    render() {\n        let style: any = {};\n        style.marginBottom = '20px';\n        style.marginLeft = '20px';\n        style.float = 'right';\n\n        let sharingH: JSX.Element | undefined;\n        let sharing: JSX.Element | undefined;\n        let wishB: JSX.Element | undefined;\n\n        if (SHARING_ENABLED) {\n            sharingH = (\n                <h3>Code Sharing</h3>\n            );\n            sharing = (\n                <div className=\"selectable\" style={{ textAlign: 'justify' }}>\n                    You can share the code that is currently shown in SOSML by using\n                    the <p className=\"buttonSimul\"><span\n                        className=\"glyphicon glyphicon-link\" /> Share</p> button. Your code\n                    will be uploaded to the servers\n                    of Saarland University and you are provided with a link to download your file.\n                    Files are always snapshots, neither you nor anyone with the link is able to\n                    modify the file. If you want to share an updated version, you have to share the\n                    file again (getting a new link for it).\n\n                    <br /><br />\n                    <Alert variant=\"info\" className=\"selectable\"><strong>Warning: </strong>\n                        Only upload files and content to which you own the copyright.\n                        By uploading a file to the servers of Saarland University, you grant Saarland\n                        University and the <a href=\"https://github.com/SOSML\"> SOSML Developers </a>\n                        a non-exclusive, worldwide, royalty-free, sub-licensable, and transferable\n                        license to use, publish, and create derivative works of your uploaded file.\n                        Further, we cannot guarantee the availability of your uploaded files.\n                    </Alert>\n                </div>\n            );\n        }\n        if (!wishingHidden()) {\n            wishB = (\n                <button className=\"btn btn-pri-alt\" onClick={this.handleRedirectToWishes}\n                    style={style} type=\"button\">\n                    <span className=\"glyphicon glyphicon-exclamation-sign\" />&nbsp;I wish to learn SML.\n                </button>\n            );\n        }\n\n        return (\n            <Container className=\"flexy selectable\" style={{ textAlign: 'justify' }}>\n                <h2>SOOCaml: The Online Interpreter for OCaml (based on <a href=\"https://github.com/SOSML\">SOSML</a>)</h2>\n                <hr />\n                <p>\n                    OCaml is a functional programming language with static type checking\n                    and type inference. The language is used to teach a computer science\n                    introductory course at Saarland University.\n                </p>\n\n                <h3>How to Use SOOCaml</h3>\n                <div className=\"selectable\">\n                    The editor shows two columns. The left column allows to write OCaml code\n                    whereas the right column shows the output of SOOCaml. Code is evaluated after\n                    typing a semicolon (;). SOOCaml runs locally in your web browser, so no\n                    files are being uploaded for evaluation. On successful evaluation, your code\n                    and the corresponding output will be become green or blue.\n                    If there is some mistake or an unhandled exception, your code and the output\n                    will become red instead. (You may configure SOOCaml to use different\n                    colors on the <a href=\"/settings\">\n                        <span className=\"glyphicon glyphicon-cog\" />&nbsp;Settings</a> page.)\n\n                    <br /><br />\n\n                    <Alert variant=\"info\" className=\"selectable\"><strong>Warning (not fully converted): </strong>\n                        Long computations might be terminated by your web browser\n                        due to limitations for how long a script is allowed to run.\n                        This time limit may be changed on the <a href=\"/settings\">\n                            <span className=\"glyphicon glyphicon-cog\" />&nbsp;Settings</a> page.\n                    </Alert>\n                </div>\n\n                <h3>Save Your Work!</h3>\n                <div className=\"selectable\">\n                    If you want to keep OCaml programs in SOOcaml, you have to store them\n                    using the <p className=\"buttonSimul\"><span className=\"glyphicon glyphicon-file\" />&nbsp;Store\n                    </p> button above your code.\n                    When you change your code, you have to store the file again.\n                    To view or change your stored files, just\n                    head to the <a href=\"/files\"><span className=\"glyphicon glyphicon-duplicate\" />&nbsp;Files</a> page.\n\n                    <br /><br />\n\n                    <Alert variant=\"info\" className=\"selectable\"><strong>Warning: </strong>\n                        The files are stored locally inside your web browser. If you delete the\n                        website data of SOOCaml, all your files will be deleted.\n                        To export yor work from your web browser, head to\n                        the <a href=\"/files\"><span className=\"glyphicon glyphicon-duplicate\" />&nbsp;Files</a> page and hit\n                        the <p className=\"buttonSimul\"><span className=\"glyphicon glyphicon-download-alt\" />&nbsp;Save\n                        </p> button next to the file you want to save.\n                    </Alert>\n                </div>\n\n                {sharingH}\n                {sharing}\n\n                <button className=\"btn btn-suc-alt\" onClick={this.handleRedirectToEdit}\n                    style={style} type=\"button\">\n                    <span className=\"glyphicon glyphicon-pencil\" />&nbsp;Take me to the editor.\n                </button>\n                {wishB}\n                <br />\n                <br />\n            </Container>\n        );\n    }\n}\n\nexport default Landing;\n","import * as React from 'react';\nimport { Card } from 'react-bootstrap';\n\nimport { getTheme, getColor } from '../theme';\nimport { getInterfaceSettings } from '../storage';\nimport Icon from './Icon';\n\ninterface Props {\n    themeName: string;\n    activeLight: boolean;\n    activeDark: boolean;\n    changeTheme: (type: 'light' | 'dark', name: string) => void;\n    combine: boolean; // Combine light/dark theme buttons\n}\n\nclass ThemeCard extends React.Component<Props, any> {\n    render() {\n        let theme = getTheme(this.props.themeName, undefined);\n        if (theme === undefined) {\n            return '';\n        }\n        let settings = getInterfaceSettings();\n        let dt: string | undefined = settings.autoSelectTheme ? settings.darkTheme : undefined;\n        let borderColor = getColor(settings.theme, dt, 'border');\n        let bgColor = getColor(settings.theme, dt, 'background');\n        let fgInvColor = getColor(settings.theme, dt, 'navbar_focus_fg');\n\n        let lightButton = (\n            <div className={this.props.activeLight ? 'btn btn-def-inv' : 'btn btn-def-alt'}\n                style={{padding: \"0px 5px 2px 5px\"}}\n                onClick={(a: any) => this.props.changeTheme('light', this.props.themeName)}>\n                <Icon icon='sun' size=\"16pt\"\n                    stroke={this.props.activeLight ? fgInvColor : borderColor}\n                    fill={this.props.activeLight ? fgInvColor : bgColor} />\n            </div>\n        );\n        let mixedButton = (\n            <div className={this.props.activeLight ? 'btn btn-def-inv' : 'btn btn-def-alt'}\n                style={{padding: \"0px 5px 2px 5px\"}}\n                onClick={(a: any) => this.props.changeTheme('light', this.props.themeName)}>\n                <Icon icon='sunmoon' size=\"16pt\"\n                    stroke={this.props.activeLight ? fgInvColor : borderColor}\n                    fill={this.props.activeLight ? fgInvColor : bgColor} />\n            </div>\n        );\n        let darkButton = (\n            <div className={this.props.activeDark ? 'btn btn-def-inv' : 'btn btn-def-alt'}\n            style={{padding: \"0px 5px 2px 5px\"}}\n            onClick={(a: any) => this.props.changeTheme('dark', this.props.themeName)}>\n                <Icon icon='moon' size=\"16pt\"\n                stroke={this.props.activeDark ? fgInvColor : borderColor}\n                fill={this.props.activeDark ? fgInvColor : bgColor} />\n            </div>\n        );\n\n        return (\n            <Card>\n                <div>\n                <div style={{\n                    fontSize: \"16px\",\n                    display: \"inline-block\",\n                    paddingTop: \"4px\",\n                    paddingLeft: \"5px\",\n                    fontFamily: \"monospace\"\n                }}>{this.props.themeName}</div>\n                <div className=\"inlineBlock\" style={{\n                    marginTop: \"-1px\", marginRight: \"-1px\",\n                    position: \"relative\",\n                    display: \"flex\",\n                    float: \"right\"}}>\n                    {this.props.combine ? mixedButton : lightButton}\n                    {!this.props.combine ? (<div className=\"miniSpacer\" />) : ''}\n                    {!this.props.combine ? darkButton : ''}\n                </div>\n                </div>\n                <Card.Body style={{paddingLeft: '0', paddingBottom: '0', paddingRight: '0'}}>\n                    <div style={{\n                        borderTop: '1px solid ' + getColor(settings.theme, dt, 'alert_fg'),\n                        color: theme.foreground,\n                        backgroundColor: theme.background,\n                        paddingBottom: '1px'\n                    }}>\n                        <div style={{\n                            padding: '5px 5px 0',\n                            color: theme.navbar_fg,\n                            backgroundColor: theme.navbar_bg\n                        }}>\n                            <Icon icon=\"sosml\" stroke={theme.icon_bg}\n                            fill={theme.icon_fg} size=\"24px\" />\n                            <span style={{verticalAlign: \"middle\", fontSize: \"12.5pt\", fontFamily: \"monospace\"}}><b> SOSML\n                            </b></span>\n                        </div>\n                        <div style={{\n                            padding: '5px',\n                            margin: '5px',\n                            color: theme.alert_fg,\n                            backgroundColor: theme.alert_bg,\n                            border: '1px solid ' + theme.alert_border\n                        }}>\n                            <div style={{\n                                float: 'right',\n                                fontSize: \"9pt\",\n                                color: theme.btn_dng_fg,\n                                backgroundColor: theme.btn_dng_bg,\n                                border: '1px solid ' + theme.btn_dng_border,\n                                padding: '1px 2px',\n                                marginTop: '-6px',\n                                marginRight: '-6px',\n                                fontFamily: 'monospace',\n                            }}>\n                                Btn\n                            </div>\n                            <div style={{\n                                float: 'right',\n                                fontSize: \"9pt\",\n                                color: theme.btn_pri_fg,\n                                backgroundColor: theme.btn_pri_bg,\n                                border: '1px solid ' + theme.btn_pri_border,\n                                padding: '1px 2px',\n                                marginTop: '-6px',\n                                marginRight: '6px',\n                                fontFamily: 'monospace',\n                            }}>\n                                Btn\n                            </div>\n                            <div style={{\n                                float: 'right',\n                                fontSize: \"9pt\",\n                                color: theme.btn_suc_fg,\n                                backgroundColor: theme.btn_suc_bg,\n                                border: '1px solid ' + theme.btn_suc_border,\n                                padding: '1px 2px',\n                                marginTop: '-6px',\n                                marginRight: '6px',\n                                fontFamily: 'monospace',\n                            }}>\n                                Btn\n                            </div>\n\n                            Alert\n                        </div>\n                        <div style={{\n                            margin: '5px',\n                            border: '1px solid ' + theme.border,\n                            fontFamily: 'monospace'\n                        }}>\n                            <div style={{backgroundColor: theme.success,\n                                paddingLeft: '5px'\n                            }}><span style={{color: theme.cm_builtin}}>print\n                            </span> <span style={{color: theme.cm_string}}>\"{this.props.themeName}\"</span>;</div>\n                            <div style={{backgroundColor: theme.success_alt,\n                                paddingLeft: '5px'\n                            }}><span style={{color: theme.cm_comment}}>(* Comment *)</span>;</div>\n                            <div style={{backgroundColor: theme.error,\n                                paddingLeft: '5px'\n                            }}><span style={{color: theme.cm_keyword}}><b>val</b>\n                            </span> <span style={{color: theme.cm_variable}}>x\n                            </span> <span style={{color: theme.cm_keyword}}>*\n                            </span> <span style={{color: theme.cm_number}}>10</span>;</div>\n                        </div>\n                    </div>\n                </Card.Body>\n            </Card>\n        );\n    }\n}\n\nexport default ThemeCard;\n","import * as React from 'react';\nimport { CardDeck } from 'react-bootstrap';\n\nimport { REF_NAME, COMMIT_SHA, PIPELINE_ID, BUILD_DATE } from './Version';\nimport { getColor, getTheme } from '../theme';\nimport { InterpreterSettings, InterfaceSettings, getInterpreterSettings,\n    getInterfaceSettings } from '../storage';\nimport ThemeCard from './ThemeCard';\nimport Icon from './Icon';\n\ninterface State {\n    inter: InterpreterSettings;\n    front: InterfaceSettings;\n}\n\nclass Settings extends React.Component<any, State> {\n    constructor(props: any) {\n        super(props);\n        this.state = {\n            inter: getInterpreterSettings(),\n            front: getInterfaceSettings()\n        };\n\n        this.timeoutChangeHandler = this.timeoutChangeHandler.bind(this);\n        this.timeDisplayChangeHandler = this.timeDisplayChangeHandler.bind(this);\n        this.resetColorsToDefault = this.resetColorsToDefault.bind(this);\n        this.themeChangeHandler = this.themeChangeHandler.bind(this);\n        this.changeTheme = this.changeTheme.bind(this);\n    }\n\n    render() {\n        return (\n            <div className=\"container flexy\">\n            <h2>Settings</h2>\n                <hr/>\n                <p>\n                My name is \"{REF_NAME}-{COMMIT_SHA} run {PIPELINE_ID}/{BUILD_DATE}\" aka. FRONTEND.\n                    <br/>\n                You can enable some additional features and extensions here.\n                Things may break so be warned, though.\n                </p>\n                <br/>\n                {this.renderSettings(this.state.front.advancedMode)}\n                <br/> <br/>\n            </div>\n        );\n    }\n\n    resetColorsToDefault() {\n        this.setState((oldState) => {\n            let deepCopy: any = this.deepCopy(oldState);\n            deepCopy.front.errorColor = getColor(deepCopy.front.theme, undefined, 'error');\n            deepCopy.front.successColor1 = getColor(deepCopy.front.theme, undefined, 'success');\n            deepCopy.front.successColor2 = getColor(deepCopy.front.theme, undefined, 'success_alt');\n            return deepCopy;\n        }, () => {\n            this.saveState();\n        });\n    }\n\n    private renderSettings(advanced: boolean): any[] {\n        let style: any = {};\n        style.textAlign = 'right';\n        style.width = '4.5em';\n        style.border = 'none';\n\n        let result: any[] = [];\n        result.push(\n            <h4 key={0}>Interpreter Settings</h4>\n        );\n        if (advanced) {\n            /*\n            result.push(\n                <div className=\"checkbox\" key=\"d2\">\n                <label>\n                <input type=\"checkbox\" key={2} checked={this.state.inter.allowStructuresAnywhere}\n                    onChange={this.changeHandler('inter', 'allowStructuresAnywhere')}/>\n                    Allow structures to be defined in local declaration expressions.\n                </label>\n                </div>\n            );\n            result.push(\n                <div className=\"checkbox\" key=\"d3\">\n                <label>\n                <input type=\"checkbox\" key={3} checked={this.state.inter.allowSignaturesAnywhere}\n                    onChange={this.changeHandler('inter', 'allowSignaturesAnywhere')}/>\n                    Allow signatures to be defined in all non top-level declarations.\n                </label>\n                </div>\n            );\n            result.push(\n                <div className=\"checkbox\" key=\"d4\">\n                <label>\n                <input type=\"checkbox\" key={4} checked={this.state.inter.allowFunctorsAnywhere}\n                    onChange={this.changeHandler('inter', 'allowFunctorsAnywhere')}/>\n                    Allow functors to be defined in all non top-level declarations.\n                </label>\n                </div>\n            );\n            */\n            result.push(\n                <div className=\"checkbox\" key=\"d5\">\n                <label>\n                <input type=\"checkbox\" key={5} checked={this.state.inter.allowVector}\n                    onChange={this.changeHandler('inter', 'allowVector')}/>\n                    Allow vector patterns and expressions.\n                </label>\n                </div>\n            );\n            result.push(\n                <div className=\"checkbox\" key=\"d6\">\n                <label>\n                <input type=\"checkbox\" key={6} checked={this.state.inter.allowSuccessorML}\n                    onChange={this.changeHandler('inter', 'allowSuccessorML')}/>\n                    Enable support for 'SuccessorML' (experimental)\n                </label>\n                </div>\n            );\n            result.push(\n                <div className=\"checkbox\" key=\"d6a\">\n                <label>\n                <input type=\"checkbox\" key={601} checked={this.state.inter.allowUnicode}\n                    onChange={this.changeHandler('inter', 'allowUnicode')}/>\n                    Enable support for Unicode (experimental)\n                </label>\n                </div>\n            );\n            result.push(\n                <div className=\"checkbox\" key=\"d6b\">\n                <label>\n                <input type=\"checkbox\" key={602} checked={this.state.inter.allowUnicodeTypeVariables}\n                    onChange={this.changeHandler('inter', 'allowUnicodeTypeVariables')}/>\n                    Enable support for writing type variables as α, β, γ, etc. (experimental)\n                </label>\n                </div>\n            );\n            result.push(\n                <div className=\"checkbox\" key=\"d6c\">\n                <label>\n                <input type=\"checkbox\" key={603} checked={this.state.inter.showTypeVariablesAsUnicode}\n                    onChange={this.changeHandler('inter', 'showTypeVariablesAsUnicode')}/>\n                    Display type variables as α, β, γ, etc. (experimental)\n                </label>\n                </div>\n            );\n            result.push(\n                <div className=\"checkbox\" key=\"d65\">\n                <label>\n                <input type=\"checkbox\" key={65} checked={this.state.inter.realEquality}\n                    onChange={this.changeHandler('inter', 'realEquality')}/>\n                    Turn real into a type with equality.\n                </label>\n                </div>\n            );\n            result.push(\n                <div className=\"checkbox\" key=\"d7\">\n                <label>\n                <input type=\"checkbox\" key={7} checked={this.state.inter.strictMode}\n                    onChange={this.changeHandler('inter', 'strictMode')}/>\n                    Enforce single-typed results\n                </label>\n                </div>\n            );\n        }\n        result.push(\n                <div className=\"checkbox\" key=\"d8\">\n                <label>\n            <input type=\"checkbox\" key={8} checked={this.state.inter.disableElaboration}\n                onChange={this.changeHandler('inter', 'disableElaboration')}/>\n                <b>Disable</b> elaboration.\n                </label>\n            </div>\n        );\n        result.push(\n                <div className=\"checkbox\" key=\"d9\">\n                <label>\n            <input type=\"checkbox\" key={9} checked={this.state.inter.disableEvaluation}\n                onChange={this.changeHandler('inter', 'disableEvaluation')}/>\n                <b>Disable</b> evaluation.\n                </label>\n            </div>\n        );\n        result.push(\n            <p key={10}>\n                Abort evaluation after <input type=\"number\" min=\"0\" step=\"100\"\n                value={this.state.front.timeout} style={style}\n                onChange={this.timeoutChangeHandler} placeholder=\"9029\"/> ms.\n                <br/><br/>\n            </p>\n        );\n        result.push(\n            <h4 key=\"n11\">Theme Settings</h4>\n        );\n        result = result.concat(this.renderThemes());\n        result.push(\n            <h4 key={11}>Editor Settings</h4>\n        );\n        result.push(\n            <div className=\"checkbox\" key=\"d16\">\n                <label>\n                <input type=\"checkbox\" key={16} checked={this.state.front.advancedMode}\n                    onChange={this.changeHandler('front', 'advancedMode')}/>\n                Show <em>more</em> things to break.\n                </label>\n            </div>\n        );\n        result.push(\n                <div className=\"checkbox\" key=\"d13\">\n                <label>\n            <input type=\"checkbox\" key={13} checked={this.state.front.outputHighlight}\n                onChange={this.changeHandler('front', 'outputHighlight')}/>\n                Enable colored output\n                </label>\n            </div>\n        );\n        result.push(\n                <div className=\"checkbox\" key=\"d14\">\n                <label>\n            <input type=\"checkbox\" key={14} checked={this.state.front.autoIndent}\n                onChange={this.changeHandler('front', 'autoIndent')}/>\n                Enable auto-indent\n                </label>\n            </div>\n        );\n        if (advanced) {\n            result.push(\n                <div className=\"checkbox\" key=\"d142\">\n                    <label>\n                        <input type=\"checkbox\" key={142} checked={this.state.front.useMobile}\n                            onChange={this.changeHandler('front', 'useMobile')}/>\n                        Switch to vertical editor mode on narrow screens and windows.\n                    </label>\n                </div>\n            );\n            result.push(\n                <div className=\"checkbox\" key=\"d140\">\n                <label>\n                <input type=\"checkbox\" key={140} checked={this.state.front.showHiddenFiles}\n                    onChange={this.changeHandler('front', 'showHiddenFiles')}/>\n                    Display hidden files.\n                </label>\n                </div>\n            );\n            result.push(\n                <div className=\"checkbox\" key=\"d141\">\n                <label>\n                <input type=\"checkbox\" key={141} checked={this.state.front.globalLastCache}\n                    onChange={this.changeHandler('front', 'globalLastCache')}/>\n                    Show last edited code when opening the editor.\n                </label>\n                </div>\n            );\n        }\n        result.push(\n                <div className=\"checkbox\" key=\"d15\">\n                <label>\n            <input type=\"checkbox\" key={15} checked={this.state.front.fullscreen}\n                onChange={this.changeHandler('front', 'fullscreen')}/>\n                Switch editor into fullscreen mode (Use ESC to return to the normal mode.)\n                </label>\n            </div>\n        );\n        result.push(\n                <div className=\"checkbox\" key=\"d12\">\n                <label>\n            <input type=\"checkbox\" key={12} checked={this.state.inter.showUsedTimeWhenAbove >= 0}\n                onChange={this.timeDisplayFlipHandler()}/>\n                Show execution time\n                </label>\n            </div>\n        );\n        if (this.state.inter.showUsedTimeWhenAbove >= 0) {\n            result.push(\n                <p key={100}>\n                    Show execution time only if larger than <input type=\"number\" min=\"0\" step=\"100\"\n                    value={this.state.inter.showUsedTimeWhenAbove} style={style}\n                    onChange={this.timeDisplayChangeHandler} placeholder=\"9029\"/> ms.\n                </p>\n            );\n        }\n        return result;\n    }\n\n    private renderThemes() {\n        let style: any = {};\n        style.textAlign = 'right';\n        style.width = '4.5em';\n        style.border = 'none';\n\n        let result: any[] = [];\n        let themeCards: any[] = [];\n        let dt: string | undefined = this.state.front.autoSelectTheme ?\n            this.state.front.darkTheme : undefined;\n        let borderColor = getColor(this.state.front.theme, dt, 'foreground');\n        let bgColor = getColor(this.state.front.theme, dt, 'background');\n\n        let themeList = ['sayaka', 'madoka', 'homura', 'kyoko'];\n        if (this.state.front.advancedMode) {\n            themeList = ['sayaka', 'madoka', 'mami', 'homura', 'kyoko', 'nagisa',\n                'sana', 'yachiyo'];\n        }\n\n        for (let tm of themeList) {\n            themeCards.push(\n                <ThemeCard key={tm} themeName={tm}\n                    activeLight={this.state.front.theme === tm}\n                    activeDark={this.state.front.darkTheme === tm}\n                    changeTheme={this.changeTheme}\n                    combine={!this.state.front.autoSelectTheme}/>\n            );\n        }\n\n        if (this.state.front.autoSelectTheme) {\n            result.push(\n                <div key={12} className=\"selectable\">\n                    Using light theme <input maxLength={4}\n                    placeholder={this.state.front.theme}\n                    style={style} onChange={(e: any) => this.themeChangeHandler(e, 'light')} /> and\n                    dark theme <input placeholder={this.state.front.darkTheme} maxLength={4}\n                    style={style} onChange={(e: any) => this.themeChangeHandler(e, 'dark')} />.<br/>\n                    Set a new light theme via the <p className=\"buttonSimul\" style={{\n                    padding: '0px 3px 0px 3px'}}><Icon icon=\"sun\" size=\"13pt\" stroke={borderColor}\n                    fill={bgColor}/>\n                    </p> buttons and a new dark theme via the <p className=\"buttonSimul\"\n                    style={{padding: '0px 3px 0px 3px'}}><Icon icon=\"moon\" size=\"13pt\"\n                    stroke={borderColor} fill={bgColor}/></p> buttons\n                    below.\n                    <br/><br/>\n                </div>\n            );\n        } else {\n            result.push(\n                <div key={12} className=\"selectable\">\n                    Using theme <input maxLength={4}\n                    placeholder={this.state.front.theme}\n                    style={style} onChange={(e: any) => this.themeChangeHandler(e, 'light')}/>.<br/>\n                    Set a new theme via the <p className=\"buttonSimul\" style={{\n                    padding: '0px 3px 0px 3px'}}><Icon icon=\"sunmoon\" size=\"13pt\"\n                    stroke={borderColor} fill={bgColor}/>\n                    </p> buttons below.\n                    <br/><br/>\n                </div>\n            );\n        }\n        result.push(\n            <CardDeck key={17}>\n                {themeCards}\n            </CardDeck>\n        )\n\n        result.push(\n                <div className=\"checkbox\" key=\"d170\">\n                <label>\n            <input type=\"checkbox\" key={170} checked={this.state.front.autoSelectTheme}\n                onChange={this.changeHandler('front', 'autoSelectTheme', true)}/>\n                Try to detect a system-wide dark mode and correspondingly adjust the theme used.\n                </label>\n            </div>\n        );\n        if (!this.state.front.autoSelectTheme) {\n            result.push(\n                <div key={121} className=\"selectable\">\n                    Background color for erroneous code: <input type=\"color\" value={this.state.front.errorColor}\n                        onChange={this.colorChangeHandler('errorColor')}/><br/>\n                    Background color for evaluated code: <input type=\"color\" value={this.state.front.successColor1}\n                        onChange={this.colorChangeHandler('successColor1')}/><br/>\n                    Alternative background color for evaluated code: <input type=\"color\"\n                    value={this.state.front.successColor2}\n                        onChange={this.colorChangeHandler('successColor2')}/><br /><br />\n                    <button className=\"btn btn-dng-alt\" onClick={this.resetColorsToDefault} type=\"button\">\n                        <span className=\"glyphicon glyphicon-repeat\" /> Reset colors to theme default\n                    </button>\n                </div>\n            );\n        }\n\n        result.push(\n            <p key=\"b1\">\n            {' '}<br/ >\n            </p>\n        );\n\n        return result;\n    }\n\n    private changeHandler(scope: string, property: string, needsReload: boolean = false) {\n        return () => {\n            this.setState((oldState) => {\n                let deepCopy: any = this.deepCopy(oldState);\n                deepCopy[scope][property] = !this.state[scope][property];\n                return deepCopy;\n            }, () => {\n                this.saveState();\n            });\n            if (needsReload) {\n                window.location.reload();\n            }\n        };\n    }\n\n    private colorChangeHandler(propName: string) {\n        return (evt: React.ChangeEvent<HTMLInputElement>) => {\n            let value = evt.target.value;\n            this.setState((oldState) => {\n                let deepCopy: any = this.deepCopy(oldState);\n                deepCopy.front[propName] = value;\n                return deepCopy;\n            }, () => {\n                this.saveState();\n            });\n        };\n    }\n\n    private timeoutChangeHandler(evt: React.ChangeEvent<HTMLInputElement>) {\n        let value = parseInt(evt.target.value, 10);\n        if (value < 0) {\n            return;\n        }\n        this.setState((oldState) => {\n            let deepCopy: any = this.deepCopy(oldState);\n            deepCopy.front.timeout = Math.min(value, 10000000000);\n            return deepCopy;\n        }, () => {\n            this.saveState();\n        });\n    }\n\n    private timeDisplayChangeHandler(evt: React.ChangeEvent<HTMLInputElement>) {\n        let value = parseInt(evt.target.value, 10);\n        if (value < 0) {\n            return;\n        }\n        this.setState((oldState) => {\n            let deepCopy: any = this.deepCopy(oldState);\n            deepCopy.inter.showUsedTimeWhenAbove = Math.min(value, 10000000000);\n            return deepCopy;\n        }, () => {\n            this.saveState();\n        });\n    }\n\n    private timeDisplayFlipHandler() {\n        return () => {\n            this.setState((oldState) => {\n                let deepCopy: any = this.deepCopy(oldState);\n                if (this.state.inter.showUsedTimeWhenAbove === 0) {\n                    deepCopy.inter.showUsedTimeWhenAbove = -500;\n                } else {\n                    deepCopy.inter.showUsedTimeWhenAbove = -this.state.inter.showUsedTimeWhenAbove;\n                }\n                return deepCopy;\n            }, () => {\n                this.saveState();\n            });\n        };\n    }\n\n    private changeTheme(type: 'light' | 'dark', name: string) {\n        let currentTheme = (type === 'light' ? this.state.front.theme : this.state.front.darkTheme);\n\n        if (!getTheme(name, undefined) || name === currentTheme) {\n            return;\n        }\n        this.setState((oldState) => {\n            let deepCopy: any = this.deepCopy(oldState);\n            if (type === 'light') {\n                deepCopy.front.theme = name;\n            } else {\n                deepCopy.front.darkTheme = name;\n            }\n            return deepCopy;\n        }, () => {\n            this.saveState();\n        });\n\n        let themeIsDark = this.state.front.autoSelectTheme && window.matchMedia\n            && window.matchMedia('(prefers-color-scheme: dark)').matches;\n\n        if (type === (themeIsDark ? 'dark' : 'light')) {\n            window.location.reload();\n        }\n    }\n\n    private themeChangeHandler(evt: React.ChangeEvent<HTMLInputElement>, type: 'light' | 'dark') {\n        let value = evt.target.value;\n\n        if (!getTheme(value, undefined)\n           || (type === 'light' && this.state.front.theme === value)\n           || (type === 'dark' && this.state.front.darkTheme === value)) {\n            return;\n        }\n        evt.target.value = '';\n        this.changeTheme(type, value);\n    }\n\n    private deepCopy(json: any): any {\n        return JSON.parse(JSON.stringify(json));\n    }\n\n    private saveState() {\n        localStorage.setItem('interpreterSettings', JSON.stringify(this.state.inter));\n        let inter = this.deepCopy(this.state.front);\n        if (inter.timeout === null || isNaN(inter.timeout)) {\n            inter.timeout = 5000;\n        }\n        localStorage.setItem('interfaceSettings', JSON.stringify(inter));\n    }\n\n}\n\nexport default Settings;\n","export const REF_NAME = '';\nexport const COMMIT_SHA = 'cee9889';\nexport const PIPELINE_ID = '';\nexport const BUILD_DATE = 'Di 3. Jan 18:33:22 UTC 2023';\n","import * as React from 'react';\n\nclass FileIntermediate extends React.Component<any, any> {\n    componentDidMount() {\n        if (this.props.match) {\n            this.props.history.replace('/editor', {\n                fileName: this.props.match.params.name,\n                example: window.location.pathname.indexOf('/example') === 0\n            });\n        }\n    }\n\n    render() {\n        return <div />;\n    }\n}\n\nexport default FileIntermediate;\n","import * as React from 'react';\n// import './MiniWindow.css';\nimport MenuBar from './MenuBar';\nimport Editor from './Editor';\nimport Files from './Files';\nimport Wishes from './Wishes';\nimport Landing from './Landing';\nimport Settings from './Settings';\nimport FileIntermediate from './FileIntermediate';\nimport { getInterfaceSettings, wishingHidden } from '../storage';\nimport { renderTheme, getTheme } from '../theme';\n// import ShareIntermediate from './ShareIntermediate';\nimport {\n    BrowserRouter as Router,\n    Route\n} from 'react-router-dom';\nimport './RootPage.css';\n\nclass RootPage extends React.Component<any, any> {\n    render() {\n        let settings = getInterfaceSettings();\n        let theme = renderTheme(getTheme(settings.theme, settings.autoSelectTheme ?\n            settings.darkTheme : undefined));\n        let width = (window.innerWidth > 0) ? window.innerWidth : window.screen.width;\n\n        let footer: any;\n        if (width < 600) {\n            footer = (\n                <div className=\"footer\">\n                    © 2022 <a href=\"https://github.com/SOSML\">The SOSML developers</a> | <a\n                        href=\"https://www.uni-saarland.de/footer/dialog/impressum.html\">Imprint</a>\n                </div>\n            );\n        } else {\n            footer = (\n                <div className=\"footer\">\n                    © 2022 <a href=\"https://github.com/SOSML\">The SOSML Developers</a> | <a\n                        href=\"https://github.com/SOSML/SOSML\">Sources on GitHub</a> | <a\n                            href=\"https://github.com/SOSML/SOSML/issues\">File a Bug</a> | <a\n                                href=\"https://www.uni-saarland.de/impressum\">Imprint</a>\n                </div>\n            );\n        }\n\n        let wishes: any;\n        if (!wishingHidden()) {\n            wishes = (\n                <Route path=\"/wishes\" component={Wishes} />\n            );\n        } else {\n            wishes = (\n                <Route path=\"/wishes\" component={Landing} />\n            );\n        }\n\n        return (\n            // <Router basename={ROUTE_BASENAME}>\n            // TODO: handle using webpack\n            <Router basename={\"/SOOCaml-frontend\"}>\n                <div className=\"rootPage\">\n                    <style>{theme}</style>\n                    <MenuBar />\n                    <Route exact={true} path=\"/\" component={Landing} />\n                    <Route path=\"/editor\" component={Editor} />\n                    <Route path=\"/files\" component={Files} />\n                    <Route path=\"/help\" component={Landing} />\n                    <Route path=\"/settings\" component={Settings} />\n                    {wishes}\n                    <Route path=\"/file/:name\" component={FileIntermediate} />\n                    <Route path=\"/examplefile/:name\" component={FileIntermediate} />\n                    <Route path=\"/share/:hash\" component={Editor} />\n                    <Route path=\"/wishare/:hash\" component={Wishes} />\n                    {footer}\n                </div>\n            </Router >\n        );\n    }\n}\n\nexport default RootPage;\n","// tslint:disable:no-console\n// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the 'N+1' visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL!,\n      window.location.toString()\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (!isLocalhost) {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      } else {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker) {\n          installingWorker.onstatechange = () => {\n            if (installingWorker.state === 'installed') {\n              if (navigator.serviceWorker.controller) {\n                // At this point, the old content will have been purged and\n                // the fresh content will have been added to the cache.\n                // It's the perfect time to display a 'New content is\n                // available; please refresh.' message in your web app.\n                console.log('New content is available; please refresh.');\n              } else {\n                // At this point, everything has been precached.\n                // It's the perfect time to display a\n                // 'Content is cached for offline use.' message.\n                console.log('Content is cached for offline use.');\n              }\n            }\n          };\n        }\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type')!.indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport './index.css';\nimport RootPage from './components/RootPage';\nimport registerServiceWorker from './registerServiceWorker';\n\nReactDOM.render(\n    <RootPage />,\n    document.getElementById('root') as HTMLElement\n);\n\nregisterServiceWorker();\n","export const SHARING_ENABLED = true;\nexport const SAMPLE_FILES_ENABLED = true;\nexport const WISHARING_ENABLED = true;\nexport const SAMPLE_WISHES_ENABLED = true;\nexport const WISHING_ENABLED = true;\nexport const WISHING_HIDDEN = false;\nexport const DEFAULT_THEME = 'sayaka';\n","import { DEFAULT_THEME, WISHING_ENABLED, WISHING_HIDDEN } from './config';\nimport { WishSeries } from './wishes';\nimport { getColor } from './theme';\n\nexport interface InterpreterSettings {\n    allowUnicodeInStrings: boolean; // unused\n    allowUnicode: boolean;\n    allowUnicodeTypeVariables: boolean;\n    showTypeVariablesAsUnicode: boolean;\n    allowVector: boolean;\n    allowSuccessorML: boolean;\n    disableElaboration: boolean;\n    disableEvaluation: boolean;\n    allowLongFunctionNames: boolean;\n    allowStructuresAnywhere: boolean;\n    allowSignaturesAnywhere: boolean;\n    allowFunctorsAnywhere: boolean;\n    strictMode: boolean;\n    realEquality: boolean;\n    showUsedTimeWhenAbove: number; // show time it took to compute a state\n}\n\nexport interface InterfaceSettings {\n    fullscreen: boolean;\n    timeout: number;\n    errorColor: string;\n    successColor1: string;\n    successColor2: string;\n    outputHighlight: boolean;\n    autoIndent: boolean;\n    userContributesEnergy: boolean;\n    theme: string;\n    darkTheme: string;\n    maxTabCount: number;\n    globalLastCache: boolean;\n    showHiddenFiles: boolean;\n    advancedMode: boolean;\n    autoSelectTheme: boolean;\n    useMobile: boolean;\n    hideBeforeCodeResult: boolean;\n    wishingHidden: boolean; // wishing interface is hidden until the user opens a wishare link\n}\n\nexport enum FileType {\n    LOCAL = 1,\n    SERVER,\n    SHARE\n}\n\nexport enum WishType {\n    LOCAL = 1,\n    SERVER,\n    SHARE,\n    LOCAL_DEFAULT\n}\n\nexport interface File {\n    name: string;\n    info: any;\n    type: FileType;\n}\n\nexport interface ExternalWish {\n    fileName: string;\n    info?: any;\n    wishType: WishType;\n}\n\nexport function displayName(share: File): string {\n    if (share.type !== FileType.SHARE) {\n        return share.name;\n    }\n    if (!Object.prototype.hasOwnProperty.call(share.info, 'date')\n       || share.info.date === undefined) {\n        return '????-??-??/' + share.name;\n    }\n    if (!(share.info.date instanceof Date)) {\n        return (share.info.date + '').substr(0, 10) + '/' + share.name;\n    }\n    return share.info.date.toISOString().substr(0, 10) + '/' + share.name;\n}\n\nexport function getWishDownloaded(wishName: string): boolean {\n    let str: string | null = localStorage.getItem('wishDownloaded');\n    if (typeof str === 'string') {\n        let data: any = JSON.parse(str);\n        if (data.hasOwnProperty(wishName)) {\n            return data[wishName];\n        }\n    }\n    return false;\n}\n\nexport function setWishDownloaded(wishName: string, status: boolean): void {\n    let str: string | null = localStorage.getItem('wishDownloaded');\n\n    let data: any = {};\n    if (typeof str === 'string') {\n        data = JSON.parse(str);\n    }\n    data[wishName] = status;\n    localStorage.setItem('wishDownloaded', JSON.stringify(data));\n}\n\n\n// Returns the number of solved parts of the specified wish\nexport function getWishStatus(wishSeriesId: string, wishId: string): number {\n    let str: string | null = localStorage.getItem('wishProgress');\n    let wishname = wishSeriesId + '@' + wishId;\n    if (typeof str === 'string') {\n        let data: any = JSON.parse(str);\n        if (data.hasOwnProperty(wishname)) {\n            return data[wishname];\n        }\n    }\n    return 0;\n}\n\nexport function setWishStatus(wishSeriesId: string, wishId: string, completedParts: number): void {\n    let str: string | null = localStorage.getItem('wishProgress');\n    let wishname = wishSeriesId + '@' + wishId;\n\n    let data: any = {};\n    if (typeof str === 'string') {\n        data = JSON.parse(str);\n    }\n    data[wishname] = completedParts;\n    localStorage.setItem('wishProgress', JSON.stringify(data));\n}\n\nexport const HIDDEN_FILE_PREFIX = '.GRF_SD/';\n\nfunction fillObjectWithString(obj: any, str: string | null) {\n    if (typeof str === 'string') {\n        let data: any = JSON.parse(str);\n        for (let name in data) {\n            if (data.hasOwnProperty(name)) {\n                obj[name] = data[name];\n            }\n        }\n    }\n}\n\nexport function getInterpreterSettings(): InterpreterSettings {\n    let str: string | null = localStorage.getItem('interpreterSettings');\n    let ret: InterpreterSettings = {\n        allowUnicodeInStrings: true,\n        allowUnicode: false,\n        allowUnicodeTypeVariables: false,\n        showTypeVariablesAsUnicode: false,\n        allowSuccessorML : false,\n        disableElaboration: false,\n        disableEvaluation: false,\n        allowVector: true,\n        allowLongFunctionNames: false,\n        allowStructuresAnywhere: false,\n        allowSignaturesAnywhere: false,\n        allowFunctorsAnywhere: false,\n        strictMode: true,\n        realEquality: false,\n        showUsedTimeWhenAbove: -500, // disabled by default; disabled when value is negative\n    };\n    fillObjectWithString(ret, str);\n    return ret;\n}\n\nexport function setInterpreterSettings(settings: InterpreterSettings) {\n    // TODO\n}\n\nexport function getInterfaceSettings(): InterfaceSettings {\n    let str: string | null = localStorage.getItem('interfaceSettings');\n    let ret: InterfaceSettings = {\n        fullscreen: false,\n        timeout: 5000,\n        errorColor: getColor(DEFAULT_THEME, undefined, 'error'),\n        successColor1: getColor(DEFAULT_THEME, undefined, 'success'),\n        successColor2: getColor(DEFAULT_THEME, undefined, 'success_alt'),\n        outputHighlight: true,\n        autoIndent: true,\n        userContributesEnergy: false,\n        theme: DEFAULT_THEME,\n        darkTheme: 'homura',\n        maxTabCount: 75,\n        globalLastCache: true,\n        showHiddenFiles: false,\n        advancedMode: false,\n        autoSelectTheme: true,\n        useMobile: true,\n        hideBeforeCodeResult: true,\n        wishingHidden: WISHING_HIDDEN\n    };\n    fillObjectWithString(ret, str);\n    return ret;\n}\n\nexport function wishingHidden(): boolean {\n    if (!WISHING_ENABLED) { return true; }\n\n    if (WISHING_HIDDEN) {\n        return getInterfaceSettings().wishingHidden;\n    }\n\n    return false;\n}\n\nexport function setInterfaceSettings(settings: InterfaceSettings) {\n    // TODO\n    // NOTE: Need to adjust set 'tabCount' if 'maxTabCount' changed\n}\n\nexport function getLastCachedFile(): string | undefined {\n    if (!getInterfaceSettings().globalLastCache) {\n        return undefined;\n    }\n\n    let lcf: string | null = localStorage.getItem('lastCachedFile');\n    if (lcf === null) {\n        return undefined;\n    } else {\n        return lcf as string;\n    }\n}\n\nexport function setLastCachedFile(name: string) {\n    localStorage.setItem('lastCachedFile', name);\n}\n\nfunction getNewTabId(): number {\n    let maxTabCount = getInterfaceSettings().maxTabCount;\n\n    let tabid: string | null = localStorage.getItem('tabCount');\n\n    if (tabid === null) {\n        localStorage.setItem('tabCount', '0');\n        return 0;\n    }\n\n    let result: number = ((+tabid) + 1) % maxTabCount;\n    localStorage.setItem('tabCount', '' + result);\n\n    return result;\n}\n\nlet tabId = -1;\n\nexport function getTabId(): number {\n    if (tabId === -1) {\n        tabId = getNewTabId();\n    }\n    return tabId;\n}\n\nexport function setTabId(newId: number) {\n    tabId = newId;\n}\n\nexport class Database {\n    private static instance: Database;\n    private database: IDBDatabase;\n    private dbRequest: any;\n\n    static getInstance(): Promise<Database> {\n        if (Database.instance == null) {\n            Database.instance = new Database();\n        }\n        return Database.instance.getReady();\n    }\n\n    getReady(): Promise<Database> {\n        return new Promise((resolve: (val: any) => void, reject: (err: any) => void) => {\n            if (this.database != null) { // != instead of !== intended\n                resolve(this);\n            } else if (this.dbRequest == null) { // == instead of === intended\n                this.init();\n            }\n            this.dbRequest.onsuccess = (event: any) => {\n                this.database = event.target.result;\n                resolve(this);\n            };\n            this.dbRequest.onerror = (error: any) => {\n                reject('Database could not be loaded');\n            };\n        });\n    }\n\n    getWishes(): Promise<[WishSeries, ExternalWish][]> {\n        return new Promise( (resolve: (val: any) => void, reject: (err: any) => void) => {\n            let cursorReq = this.database.transaction(['wishes']).objectStore('wishes').openCursor();\n            cursorReq.onerror = (event: any) => {\n                reject('Error during read');\n            };\n            let wishes: [WishSeries, ExternalWish][] = [];\n            cursorReq.onsuccess = (event: any) => {\n                let cursor = event.target.result;\n                if (cursor) {\n                    if (cursor.value !== undefined) {\n                        wishes.push([cursor.value.value,\n                        {\n                            fileName: cursor.key,\n                            info: cursor.value,\n                            wishType: cursor.value.type,\n                        }]);\n                    }\n                    cursor.continue();\n                } else {\n                    resolve(wishes);\n                }\n            };\n        });\n    }\n\n\n    getFiles(allowHidden: boolean = false, readShares: boolean = false): Promise<File[]> {\n        return new Promise( (resolve: (val: any) => void, reject: (err: any) => void) => {\n            let cursorReq = this.database.transaction(['files']).objectStore('files').openCursor();\n            cursorReq.onerror = (event: any) => {\n                reject('Error during read');\n            };\n            let files: File[] = [];\n            cursorReq.onsuccess = (event: any) => {\n                let cursor = event.target.result;\n                if (cursor) {\n                    if (cursor.value !== undefined &&\n                        (!cursor.value.hidden || allowHidden)) {\n                        files.push({\n                            name: cursor.key,\n                            info: cursor.value,\n                            type: FileType.LOCAL\n                        });\n                    }\n                    cursor.continue();\n                } else {\n                    if (!readShares) {\n                        resolve(files);\n                    } else {\n                        let cursorReqS =\n                            this.database.transaction(['shares'])\n                            .objectStore('shares').openCursor();\n                        cursorReqS.onerror = (event: any) => {\n                            reject('Error during read');\n                        };\n                        cursorReqS.onsuccess = (event: any) => {\n                            let cursorS = event.target.result;\n                            if (cursorS) {\n                                if (cursorS.value !== undefined) {\n                                    files.push({\n                                        name: cursorS.key,\n                                        info: cursorS.value,\n                                        type: FileType.SHARE\n                                    });\n                                }\n                                cursorS.continue();\n                            } else {\n                                resolve(files);\n                            }\n                        };\n                    }\n                }\n            };\n        });\n    }\n\n    saveFile(name: string, content: string, isHidden: boolean = false): Promise<boolean> {\n        let fileName = (isHidden ? HIDDEN_FILE_PREFIX : '') + name;\n        return new Promise( (resolve: (val: any) => void, reject: (err: any) => void) => {\n            let request = this.database.transaction(['files'], 'readwrite').objectStore('files').put({\n                name: fileName, value: content, date: new Date().toISOString(), hidden: isHidden\n            });\n            request.onerror = (event) => {\n                reject(false);\n            };\n            request.onsuccess = (event) => {\n                resolve(true);\n            };\n        });\n    }\n\n    saveShare(fileName: string, content: string, local: boolean = true): Promise<boolean> {\n        let fileOrigin = local ? FileType.LOCAL : FileType.SERVER;\n\n        return new Promise( (resolve: (val: any) => void, reject: (err: any) => void) => {\n            let request = this.database.transaction(['shares'], 'readwrite').objectStore('shares').put({\n                name: fileName, value: content, date: new Date().toISOString(), origin: fileOrigin\n            });\n            request.onerror = (event) => {\n                reject(false);\n            };\n            request.onsuccess = (event) => {\n                resolve(true);\n            };\n        });\n    }\n\n    saveWish(wishName: string, content: WishSeries, wishType: WishType): Promise<boolean> {\n        return new Promise( (resolve: (val: any) => void, reject: (err: any) => void) => {\n            let request = this.database.transaction(['wishes'], 'readwrite').objectStore('wishes').put({\n                name: wishName, value: content, date: new Date().toISOString(), type: wishType\n            });\n            request.onerror = (event) => {\n                reject(false);\n            };\n            request.onsuccess = (event) => {\n                resolve(true);\n            };\n        });\n    }\n\n    getFile(fileName: string, isHidden: boolean = false, isShare: boolean = false): Promise<string> {\n        let name = (isHidden ? HIDDEN_FILE_PREFIX : '') + fileName;\n        let location = isShare ? 'shares' : 'files';\n        return new Promise( (resolve: (val: any) => void, reject: (err: any) => void) => {\n            let request = this.database.transaction([location]).objectStore(location).get(name);\n            request.onerror = (event) => {\n                reject('Error during read');\n            };\n            request.onsuccess = (event: any) => {\n                try {\n                    if (event.target.result === undefined) {\n                        reject('Reading ' + name + ' failed: File does not exist.');\n                    } else {\n                        resolve(event.target.result.value);\n                    }\n                } catch (e) {\n                    reject('Reading ' + name + ' failed with error ' +  e.name + ': ' + e.message);\n                }\n            };\n        });\n    }\n\n    getShare(name: string): Promise<[string, FileType, any]> {\n        return new Promise( (resolve: (val: any) => void, reject: (err: any) => void) => {\n            let request = this.database.transaction(['shares']).objectStore('shares').get(name);\n            request.onerror = (event) => {\n                reject('Error during read');\n            };\n            request.onsuccess = (event: any) => {\n                try {\n                    resolve([event.target.result.value, event.target.result.origin, event.target.result]);\n                } catch (e) {\n                    reject('Reading ' + name + ' failed with error ' +  e.name + ': ' + e.message);\n                }\n            };\n        });\n    }\n\n    getWish(name: string): Promise<[WishSeries, WishType, any]> {\n        return new Promise( (resolve: (val: any) => void, reject: (err: any) => void) => {\n            let request = this.database.transaction(['wishes']).objectStore('wishes').get(name);\n            request.onerror = (event) => {\n                reject('Error during read');\n            };\n            request.onsuccess = (event: any) => {\n                try {\n                    resolve([event.target.result.value, event.target.result.origin, event.target.result]);\n                } catch (e) {\n                    reject('Reading wish ' + name + ' failed with error ' +  e.name + ': ' + e.message);\n                }\n            };\n        });\n    }\n\n    deleteDBObject(fileName: string, location: string): Promise<boolean> {\n        return new Promise( (resolve: (val: any) => void, reject: (err: any) => void) => {\n            let request = this.database.transaction([location], 'readwrite').objectStore(location).delete(fileName);\n            request.onerror = (event) => {\n                reject(false);\n            };\n            request.onsuccess = (event) => {\n                resolve(true);\n            };\n        });\n    }\n\n    deleteFile(fileName: string, isHidden: boolean = false, isShare: boolean = false): Promise<boolean> {\n        let name = (isHidden ? HIDDEN_FILE_PREFIX : '') + fileName;\n        let location = isShare ? 'shares' : 'files';\n        return this.deleteDBObject(name, location);\n    }\n\n    deleteWish(wishName: string): Promise<boolean> {\n        return this.deleteDBObject(wishName, 'wishes');\n    }\n\n\n    private init(): void {\n        this.dbRequest = window.indexedDB.open('FilesDB', 5);\n        this.dbRequest.onupgradeneeded = (event: any) => {\n            let db = event.target.result;\n            try {\n                db.createObjectStore('files', { keyPath: 'name'});\n            } catch (e) { }\n            try {\n                db.createObjectStore('shares', { keyPath: 'name'});\n            } catch (e) { }\n            try {\n                db.createObjectStore('wishes', { keyPath: 'name'});\n            } catch (e) { }\n        };\n        this.dbRequest.onsuccess = (event: any) => {\n            this.database = event.target.result;\n        };\n    }\n}\n"],"sourceRoot":""}